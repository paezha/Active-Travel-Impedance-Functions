|                                          |
|------------------------------------------|
| tle: "Active-transport walking behavior" |
| tput:                                    |
| pdf_document: default                    |
| html_document: default                   |
| te: '2022-05-19'                         |

# Active-transport walking and cycling behaviour in Canada

## Introduction

## Data and Method

Data on walking and cycling trips to different destinations was derived from Canada's General Social Survey (GSS) from 1986 to 2015. GSS is a social trends survey in order to monitor changes in the living conditions and well-being of Canadians and to provide information on specific social policy issues. one of the important information of GSS is about Time-use surveys. This survey collects information on all human activities and can therefore inform a broad range of policies. Statistics Canada has been conducting time-use surveys since 1986 at approximately five- to seven- year intervals, most recently in 2015.The GSS on time use employs a retrospective 24-hour time diary to collect information on respondents' participation in, and time spent on, a wide variety of day-to-day activities. In addition, information is collected on the location where these activities occurred (e.g., at home, at work, etc.).in addition, This dataset contains travel time data of Many of the Census Metropolitan Areas (CMAs) and non-CMA areas all over Canada. CMAs are including St. John's, Halifax, Saint John, Montreal, Quebec City, Toronto, Ottawa, Hamilton, Winnipeg, Regina, Saskatoon, Calgary, Edmonton, and Vancouver. and the non-CMA areas of each of the ten provinces were also grouped to form ten more strata.

walking and cycling data are categorized based on the three different destinations such as home, school and work, and others' homes. every episode includes, the start and end time of each event, duration, weight, and concurrent contextual information, such as the location of the activities (e.g., home, work, schools,...).

complete method

# Result

First load all of the libraries

```{r load-packages, include=FALSE, cache=FALSE}
#load all packages:
library(fitdistrplus)
library(tidyverse)
library(dplyr)
library(ggplot2)
library(readxl) 
library(splitstackshape)
library(tibble)
library(readr)
library(tabulate)
library(janitor)
library(kableExtra)
library(flextable)
```

Here, we are loading all the primary files of the GSS dataset to create our database for analysis.

```{r, include=FALSE, cache=FALSE}
#Read main file:
gss_e_2015 <- read.csv("D:/GSS Data/gss-e.csv")
gss_e_2005 <- read.csv("D:/First Article/Data/Time use_2005/gss-12M0019-E-2005-c-19-e_F1.csv")
gss_e_2010 <- read.csv("D:/First Article/Data/Time use_2010/gss-12M0018-E-2010-c-24-tus-ef_F1.csv")
gss_e_1998 <- read.csv("D:/First Article/Data/Time use_1998/gss-12M0012-E-1998-c-12e_F1.csv")
gss_e_1992 <- read.csv("D:/First Article/Data/Time use_1992/gss-12M0007-E-1992-c-7-ep_F1.csv")
gss_e_1986 <- read.csv("D:/First Article/Data/Time use_1986/gss-12M0002-E-1986-c-2-ep_F1.csv")
```

Creating dataset for walking 2015 in order to filter walking trips

```{r creating dataset for walking 2015, include=FALSE, cache=FALSE}

# **walking 2015**
# Creating data of origins and destinations of walking trip 2015
inds = which(gss_e_2015$LOCATION == 315)
rows <- lapply(inds, function(x) (x-1):(x+1))
walking_2015 <- gss_e_2015 [unlist(rows),] %>% 
  dplyr::select(PUMFID:LOCATION) %>% 
  mutate(origin = lag(LOCATION, order_by = PUMFID)) %>% 
  mutate(destination = lead(LOCATION, order_by = PUMFID)) %>% 
  group_by(PUMFID) %>% 
  filter(LOCATION == 315) %>% 
  ungroup()

# change destination and origins to text column
walking_2015 <- walking_2015 %>%  filter(destination == 300 | destination == 301 | destination == 303 | destination == 302 | destination == 305 |destination == 306 | destination == 307 | destination == 308 |destination == 309 | destination == 310| destination == 311 ) %>% filter(origin == 300 | origin == 301 | origin == 303 | origin == 302 | origin == 305 | origin == 306 | origin == 307 | origin == 308 | origin == 309 | origin == 310 | origin == 311) %>% 
  mutate(dest =
                     case_when(destination == 300 ~ "home", 
                               destination == 301 ~ "work or school",
                               destination == 303 ~ "other's home",
                               destination == 302 ~ "business",
                               destination == 305 ~ "outdoors",
                               destination == 306 ~ "Grocery store, other stores or mall",
                               destination == 307 ~ "Library, museum or theatre",
                               destination == 308 ~ "Sports centre, field or arena",
                               destination == 309 ~ "Restaurant, bar or club",
                               destination == 310 ~ "Place of worship",
                               destination == 311 ~ "Medical, dental or other health clinic")) %>% 
  mutate(orig =
                     case_when(origin == 300 ~ "home", 
                               origin == 301 ~ "work or school",
                               origin == 303 ~ "other's home",
                               origin == 302 ~ "business",
                               origin == 305 ~ "outdoors",
                               origin == 306 ~ "Grocery store, other stores or mall",
                               origin == 307 ~ "Library, museum or theatre",
                               origin == 308 ~ "Sports centre, field or arena",
                               origin == 309 ~ "Restaurant, bar or club",
                               origin == 310 ~ "Place of worship",
                               origin == 311 ~ "Medical, dental or other health clinic"))

walking_2015 <- walking_2015 %>%  dplyr::select(PUMFID, WGHT_EPI, DDAY, STARTIME:orig) 
walking_2015$YEAR <-  2015
walking_2015$MODE <-  "walking"
```





```{r creating dataset for cycling 2015, include=FALSE, cache=FALSE}

# cycling _2015
# Creating data of origins and destinations of cycling trip 2015
inds = which(gss_e_2015$LOCATION == 318)
rows <- lapply(inds, function(x) (x-1):(x+1))
cycling_2015 <- gss_e_2015[unlist(rows),] %>% 
  dplyr::select(PUMFID:LOCATION) %>% 
  mutate(origin = lag(LOCATION, order_by = PUMFID)) %>% 
  mutate(destination = lead(LOCATION, order_by = PUMFID)) %>% 
  group_by(PUMFID) %>% 
  filter(LOCATION == 318)

# change destination and origins to text column
cycling_2015 <- cycling_2015 %>%  filter(destination == 300 | destination == 301 | destination == 303 | destination == 302 | destination == 305 |destination == 306 | destination == 307 | destination == 308| destination == 309 | destination == 310 |destination == 311 ) %>% filter(origin == 300 | origin == 301 | origin == 303 | origin == 302 | origin == 305 | origin == 306 | origin == 307 | origin == 308 | origin == 309 | origin == 310 |origin == 311) %>% 
  mutate(dest =
                     case_when(destination == 300 ~ "home", 
                               destination == 301 ~ "work or school",
                               destination == 303 ~ "other's home",
                               destination == 302 ~ "business",
                               destination == 305 ~ "outdoors",
                               destination == 306 ~ "Grocery store, other stores or mall",
                               destination == 307 ~ "Library, museum or theatre",
                               destination == 308 ~ "Sports centre, field or arena",
                               destination == 309 ~ "Restaurant, bar or club",
                               destination == 310 ~ "Place of worship",
                               destination == 311 ~ "Medical, dental or other health clinic")) %>% 
  mutate(orig =
                     case_when(origin == 300 ~ "home", 
                               origin == 301 ~ "work or school",
                               origin == 303 ~ "other's home",
                               origin == 302 ~ "business",
                               origin == 305 ~ "outdoors",
                               origin == 306 ~ "Grocery store, other stores or mall",
                               origin == 307 ~ "Library, museum or theatre",
                               origin == 308 ~ "Sports centre, field or arena",
                               origin == 309 ~ "Restaurant, bar or club",
                               origin == 310 ~ "Place of worship",
                               origin == 311 ~ "Medical, dental or other health clinic"))

cycling_2015 <- cycling_2015 %>%  dplyr::select(PUMFID, WGHT_EPI, DDAY, STARTIME:orig) 
cycling_2015$YEAR <-  2015
cycling_2015$MODE <-  "cycling"
```

```{r creating dataset for walking 2010, include=FALSE, cache=FALSE}

# **walking 2010**
# Creating data of origins and destinations of walking trip 2010
inds = which(gss_e_2010$PLACE == 14)
rows <- lapply(inds, function(x) (x-1):(x+1))
walking_2010 <- gss_e_2010 [unlist(rows),] %>% 
  dplyr::select(RECID:PLACE) %>% 
  mutate(origin = lag(PLACE, order_by = RECID)) %>% 
  mutate(destination = lead(PLACE, order_by = RECID)) %>% 
  group_by(RECID) %>% 
  filter(PLACE == 14) %>% 
  ungroup()

# change destination and origins to text column
walking_2010 <- walking_2010 %>%  filter(destination == 1 | destination == 2 | destination == 3 | destination == 4 | destination == 5 |destination == 6 | destination == 7 | destination == 8 | destination == 9 | destination == 10 ) %>% filter(origin == 1 | origin == 2 | origin == 3 | origin == 4 | origin == 5 | origin == 6 | origin == 7 | origin == 8 | origin == 9 | origin == 10) %>% 
  mutate(dest =
                     case_when(destination == 1 ~ "home", 
                               destination == 2 ~ "work or school",
                               destination == 3 ~ "other's home",
                               destination == 4 ~ "Restaurant/bar",
                               destination == 5 ~ "Place of worship",
                               destination == 6 ~ "Grocery store, other stores or mall",
                               destination == 7 ~ "Grocery store, other stores or mall",
                               destination == 8 ~ "work or school",
                               destination == 9 ~ "Outdoors away from home",
                               destination == 10 ~ "Library" )) %>% 
  mutate(orig =
                     case_when(origin == 1 ~ "home", 
                               origin == 2 ~ "work or school",
                               origin == 3 ~ "other's home",
                               origin == 4 ~ "Restaurant/bar",
                               origin == 5 ~ "Place of worship",
                               origin == 6 ~ "Grocery store, other stores or mall",
                               origin == 7 ~ "Grocery store, other stores or mall",
                               origin == 8 ~ "work or school",
                               origin == 9 ~ "Outdoors away from home",
                               origin == 10 ~ "Library"))

walking_2010 <- walking_2010 %>%
  rename(PUMFID = RECID,
         LOCATION = PLACE)

walking_2010 <- walking_2010 %>%  dplyr::select(PUMFID, WGHT_EPI, DDAY, STARTIME:orig) 
walking_2010$YEAR <-  2010
walking_2010$MODE <-  "walking"
```

```{r creating dataset for cycling 2010, include=FALSE, cache=FALSE}

# cycling _2010
# Creating data of origins and destinations of cycling trip 2010
inds = which(gss_e_2010$PLACE == 17)
rows <- lapply(inds, function(x) (x-1):(x+1))
cycling_2010 <- gss_e_2010[unlist(rows),] %>% 
  dplyr::select(RECID:PLACE) %>% 
  mutate(origin = lag(PLACE, order_by = RECID)) %>% 
  mutate(destination = lead(PLACE, order_by = RECID)) %>% 
  group_by(RECID) %>% 
  filter(PLACE == 17)

# change destination and origins to text column
cycling_2010 <- cycling_2010 %>%  filter(destination == 1 | destination == 2 | destination == 3 | destination == 4 | destination == 5 |destination == 6 | destination == 7 | destination == 8 | destination == 9 | destination == 10 ) %>% filter(origin == 1 | origin == 2 | origin == 3 | origin == 4 | origin == 5 | origin == 6 | origin == 7 | origin == 8 | origin == 9 | origin == 10) %>% 
  mutate(dest =
                     case_when(destination == 1 ~ "home", 
                               destination == 2 ~ "work or school",
                               destination == 3 ~ "other's home",
                               destination == 4 ~ "Restaurant/bar",
                               destination == 5 ~ "Place of worship",
                               destination == 6 ~ "Grocery store, other stores or mall",
                               destination == 7 ~ "Grocery store, other stores or mall",
                               destination == 8 ~ "work or school",
                               destination == 9 ~ "Outdoors away from home",
                               destination == 10 ~ "Library")) %>% 
  mutate(orig =
                     case_when(origin == 1 ~ "home", 
                               origin == 2 ~ "work or school",
                               origin == 3 ~ "other's home",
                               origin == 4 ~ "Restaurant/bar",
                               origin == 5 ~ "Place of worship",
                               origin == 6 ~ "Grocery store, other stores or mall",
                               origin == 7 ~ "Grocery store, other stores or mall",
                               origin == 8 ~ "work or school",
                               origin == 9 ~ "Outdoors away from home",
                               origin == 10 ~ "Library"))

cycling_2010 <- cycling_2010 %>%
  rename(PUMFID = RECID,
         LOCATION = PLACE)

cycling_2010 <- cycling_2010 %>%  dplyr::select(PUMFID, WGHT_EPI, DDAY, STARTIME:orig) 
cycling_2010$YEAR <-  2010
cycling_2010$MODE <-  "cyclingtrip"
```

```{r creating dataset for walking 2005, include=FALSE, cache=FALSE}

# **walking 2005**
# Creating data of origins and destinations of walking trip 2005
inds = which(gss_e_2005$PLACE == 14)
rows <- lapply(inds, function(x) (x-1):(x+1))
walking_2005 <- gss_e_2005 [unlist(rows),] %>% 
  dplyr::select(RECID:PLACE) %>% 
  mutate(origin = lag(PLACE, order_by = RECID)) %>% 
  mutate(destination = lead(PLACE, order_by = RECID)) %>% 
  group_by(RECID) %>% 
  filter(PLACE == 14) %>% 
  ungroup()

# change destination and origins to text column
walking_2005 <- walking_2005 %>%  filter(destination == 1 | destination == 2 | destination == 3 | destination == 8 | destination == 4 | destination == 5 | destination == 6 | destination == 7 | destination == 9 | destination == 10 ) %>% filter(origin == 1 | origin == 2 | origin == 3 | origin == 8 | origin == 4 | origin == 5 | origin == 6 | origin == 7 | origin == 9 | origin == 10) %>% 
  mutate(dest =
                     case_when(destination == 1 ~ "home", 
                               destination == 2 ~ "work or school",
                               destination == 3 ~ "other's home",
                               destination == 8 ~ "work or school",
                               destination == 4 ~ "Restaurant, bar or club",
                               destination == 5 ~ "Place of worship",
                               destination == 6 ~ "Grocery store, other stores or mall",
                               destination == 7 ~ "Grocery store, other stores or mall",
                               destination == 9 ~ "outdoors",
                               destination == 10 ~ "Library, museum or theatre")) %>% 
  mutate(orig =
                     case_when(origin == 1 ~ "home", 
                               origin == 2 ~ "work or school",
                               origin == 3 ~ "other's home",
                               origin == 8 ~ "work or school",
                               origin == 4 ~ "Restaurant, bar or club",
                               origin == 5 ~ "Place of worship",
                               origin == 6 ~ "Grocery store, other stores or mall",
                               origin == 7 ~ "Grocery store, other stores or mall",
                               origin == 9 ~ "outdoors",
                               origin == 10 ~ "Library, museum or theatre"))

walking_2005 <- walking_2005 %>% dplyr::rename(
    PUMFID = RECID,
    STARTMIN = STARMIN,
    LOCATION = PLACE)

walking_2005 <- walking_2005 %>%  dplyr::select(PUMFID, WGHT_EPI, DDAY, STARTIME:orig) 
walking_2005$YEAR <-  2005
walking_2005$MODE <-  "walking"
```

```{r creating dataset for cycling 2005, include=FALSE, cache=FALSE}

# **CYCLING 2005**
# Creating data of origins and destinations of cycling trip 2005
inds = which(gss_e_2005$PLACE == 17)
rows <- lapply(inds, function(x) (x-1):(x+1))
cycling_2005 <- gss_e_2005 [unlist(rows),] %>% 
  dplyr::select(RECID:PLACE) %>% 
  mutate(origin = lag(PLACE, order_by = RECID)) %>% 
  mutate(destination = lead(PLACE, order_by = RECID)) %>% 
  group_by(RECID) %>% 
  filter(PLACE == 17) %>% 
  ungroup()

# change destination and origins to text column
cycling_2005 <- cycling_2005 %>%  filter(destination == 1 | destination == 2 | destination == 3 | destination == 8 | destination == 4 | destination == 5 | destination == 6 | destination == 7 | destination == 9 | destination == 10 ) %>% filter(origin == 1 | origin == 2 | origin == 3 | origin == 8 | origin == 4 | origin == 5 | origin == 6 | origin == 7 | origin == 9 | origin == 10) %>% 
  mutate(dest =
                     case_when(destination == 1 ~ "home", 
                               destination == 2 ~ "work or school",
                               destination == 3 ~ "other's home",
                               destination == 8 ~ "work or school",
                               destination == 4 ~ "Restaurant, bar or club",
                               destination == 5 ~ "Place of worship",
                               destination == 6 ~ "Grocery store, other stores or mall",
                               destination == 7 ~ "Grocery store, other stores or mall",
                               destination == 9 ~ "outdoors",
                               destination == 10 ~ "Library, museum or theatre")) %>% 
  mutate(orig =
                     case_when(origin == 1 ~ "home", 
                               origin == 2 ~ "work or school",
                               origin == 3 ~ "other's home",
                               origin == 8 ~ "work or school",
                               origin == 4 ~ "Restaurant, bar or club",
                               origin == 5 ~ "Place of worship",
                               origin == 6 ~ "Grocery store, other stores or mall",
                               origin == 7 ~ "Grocery store, other stores or mall",
                               origin == 9 ~ "outdoors",
                               origin == 10 ~ "Library, museum or theatre"))

cycling_2005 <- cycling_2005 %>% dplyr::rename(
    PUMFID = RECID,
    STARTMIN = STARMIN,
    LOCATION = PLACE) %>%  dplyr::select(PUMFID, WGHT_EPI, DDAY, STARTIME:orig) 
cycling_2005$YEAR <-  2005
cycling_2005$MODE <-  "cycling"
```

```{r creating dataset for walking 1998, include=FALSE, cache=FALSE}

# **walking 1998**
# Creating data of origins and destinations of walking trip 1998
inds = which(gss_e_1998$PLACE == 7)
rows <- lapply(inds, function(x) (x-1):(x+1))
walking_1998 <- gss_e_1998 [unlist(rows),] %>% 
  dplyr::select(RECID:PLACE) %>% 
  mutate(origin = lag(PLACE, order_by = RECID)) %>% 
  mutate(destination = lead(PLACE, order_by = RECID)) %>% 
  group_by(RECID) %>% 
  filter(PLACE == 7) %>% 
  ungroup()

# change destination and origins to text column
walking_1998 <- walking_1998 %>%  filter(destination == 1 | destination == 2 | destination == 3) %>% filter(origin == 1 | origin == 2 | origin == 3) %>% 
  mutate(dest =
                     case_when(destination == 1 ~ "home", 
                               destination == 2 ~ "work or school",
                               destination == 3 ~ "other's home")) %>% 
  mutate(orig =
                     case_when(origin == 1 ~ "home", 
                               origin == 2 ~ "work or school",
                               origin == 3 ~ "other's home"))

walking_1998 <- walking_1998 %>% dplyr::rename(
    PUMFID = RECID,
    STARTMIN = STARMIN,
    WGHT_EPI = WGHTEPI,
    LOCATION = PLACE) %>%  dplyr::select(PUMFID, WGHT_EPI, DDAY, STARTIME:orig) 
walking_1998$YEAR <-  1998
walking_1998$MODE <-  "walking"
```

```{r creating dataset for cycling 1998, include=FALSE, cache=FALSE}

# **Cycling 1998**
# Creating data of origins and destinations of cycling trip 1998
inds = which(gss_e_1998$PLACE == 9)
rows <- lapply(inds, function(x) (x-1):(x+1))
cycling_1998 <- gss_e_1998 [unlist(rows),] %>% 
  dplyr::select(RECID:PLACE) %>% 
  mutate(origin = lag(PLACE, order_by = RECID)) %>% 
  mutate(destination = lead(PLACE, order_by = RECID)) %>% 
  group_by(RECID) %>% 
  filter(PLACE == 9) %>% 
  ungroup()

# change destination and origins to text column
cycling_1998 <- cycling_1998 %>%  filter(destination == 1 | destination == 2 | destination == 3) %>% filter(origin == 1 | origin == 2 | origin == 3) %>% 
  mutate(dest =
                     case_when(destination == 1 ~ "home", 
                               destination == 2 ~ "work or school",
                               destination == 3 ~ "other's home")) %>% 
  mutate(orig =
                     case_when(origin == 1 ~ "home", 
                               origin == 2 ~ "work or school",
                               origin == 3 ~ "other's home"))

cycling_1998 <- cycling_1998 %>% dplyr::rename(
    PUMFID = RECID,
    STARTMIN = STARMIN,
    WGHT_EPI = WGHTEPI,
    LOCATION = PLACE) %>%  dplyr::select(PUMFID, WGHT_EPI, DDAY, STARTIME:orig) 
cycling_1998$YEAR <-  1998
cycling_1998$MODE <-  "cycling"
```

```{r creating dataset for walking 1992, include=FALSE, cache=FALSE}
# **walking 1992**
# Creating data of origins and destinations of walking trip 1992
inds = which(gss_e_1992$PLACE == 7)
rows <- lapply(inds, function(x) (x-1):(x+1))
walking_1992 <- gss_e_1992 [unlist(rows),] %>% 
  dplyr::select(SEQNUM, DDAY, NOEPISO, ACTCODE, STARTIME, ENDTIME, DURATION, PLACE, TIMEWGT) %>% 
  mutate(origin = lag(PLACE, order_by = SEQNUM)) %>% 
  mutate(destination = lead(PLACE, order_by = SEQNUM)) %>% 
  group_by(SEQNUM) %>% 
  filter(PLACE == 7) %>% 
  ungroup()

# change NA's Weight to 1 


# change destination and origins to text column
walking_1992 <- walking_1992 %>%  filter(destination == 1 | destination == 2 | destination == 3) %>% filter(origin == 1 | origin == 2 | origin == 3) %>% 
  mutate(dest =
                     case_when(destination == 1 ~ "home", 
                               destination == 2 ~ "work or school",
                               destination == 3 ~ "other's home")) %>% 
  mutate(orig =
                     case_when(origin == 1 ~ "home", 
                               origin == 2 ~ "work or school",
                               origin == 3 ~ "other's home"))

walking_1992 <- walking_1992 %>% dplyr::rename(
    PUMFID = SEQNUM,
    LOCATION = PLACE, WGHT_EPI = TIMEWGT) %>%  dplyr::select(PUMFID, DDAY, STARTIME:orig) 
walking_1992$YEAR <-  1992
walking_1992$MODE <-  "walking"
walking_1992$STARTMIN <-  1
walking_1992$ENDMIN <-  1
```

```{r creating dataset for cycling 1992, include=FALSE, cache=FALSE}

# **Cycling 1992**
# Creating data of origins and destinations of cycling trip 1992
inds = which(gss_e_1992$PLACE == 9)
rows <- lapply(inds, function(x) (x-1):(x+1))
cycling_1992 <- gss_e_1992 [unlist(rows),] %>% 
  dplyr::select(SEQNUM, DDAY, NOEPISO, ACTCODE, STARTIME, ENDTIME, DURATION, PLACE, TIMEWGT) %>% 
  mutate(origin = lag(PLACE, order_by = SEQNUM)) %>% 
  mutate(destination = lead(PLACE, order_by = SEQNUM)) %>% 
  group_by(SEQNUM) %>% 
  filter(PLACE == 9) %>% 
  ungroup()

# change destination and origins to text column
cycling_1992 <- cycling_1992 %>%  filter(destination == 1 | destination == 2 | destination == 3) %>% filter(origin == 1 | origin == 2 | origin == 3) %>% 
  mutate(dest =
                     case_when(destination == 1 ~ "home", 
                               destination == 2 ~ "work or school",
                               destination == 3 ~ "other's home")) %>% 
  mutate(orig =
                     case_when(origin == 1 ~ "home", 
                               origin == 2 ~ "work or school",
                               origin == 3 ~ "other's home"))

cycling_1992 <- cycling_1992 %>% dplyr::rename(
    PUMFID = SEQNUM,
    LOCATION = PLACE,WGHT_EPI = TIMEWGT) %>%  dplyr::select(PUMFID, DDAY, STARTIME:orig) 
cycling_1992$YEAR <-  1992
cycling_1992$MODE <-  "cycling"
cycling_1992$STARTMIN <-  1
cycling_1992$ENDMIN <-  1

```

```{r creating dataset for walking 1986, include=FALSE, cache=FALSE}

# **walking 1986**
# Creating data of origins and destinations of walking trip 1986
inds = which(gss_e_1986$PLACE == 7)
rows <- lapply(inds, function(x) (x-1):(x+1))
walking_1986 <- gss_e_1986 [unlist(rows),] %>% 
  dplyr::select(SEQNUM, DDAY, NO_EPISO, ACT_CODE, STRTTIME, ENDTIME, DURATION, PLACE, FWGT_MS) %>% 
  mutate(origin = lag(PLACE, order_by = SEQNUM)) %>% 
  mutate(destination = lead(PLACE, order_by = SEQNUM)) %>% 
  group_by(SEQNUM) %>% 
  filter(PLACE == 7) %>% 
  ungroup()
summary(walking_1986$PLACE)

# change destination and origins to text column
walking_1986 <- walking_1986 %>%  filter(destination == 1 | destination == 2 | destination == 3) %>% filter(origin == 1 | origin == 2 | origin == 3) %>% 
  mutate(dest =
                     case_when(destination == 1 ~ "home", 
                               destination == 2 ~ "work or school",
                               destination == 3 ~ "other's home")) %>% 
  mutate(orig =
                     case_when(origin == 1 ~ "home", 
                               origin == 2 ~ "work or school",
                               origin == 3 ~ "other's home"))

walking_1986 <- walking_1986 %>% dplyr::rename(
    PUMFID = SEQNUM,
    LOCATION = PLACE, WGHT_EPI = FWGT_MS, STARTIME = STRTTIME) %>%  dplyr::select(PUMFID, DDAY, STARTIME:orig) 
walking_1986$YEAR <-  1986
walking_1986$MODE <-  "walking"
walking_1986$STARTMIN <-  1
walking_1986$ENDMIN <-  1
```

##calculating impedance function for walking trip during 1992- 2015:

### Calculating impedance function for walking in 2015

using a skew vs. kurtois graph to descriptive statistics of data

```{r creating Cullen and Frey graph for walkig 2015}
# creating a skew vs. kurtois graph for walking 2015

descdist(walking_2015$DURATION %>% unlist() %>% as.numeric(), discrete=FALSE, boot=500)
```

As shown in the Cullen and Frey graph, we see that gamma, weibull and exponential will likely be the best fit according to the graph above. Then we compare these models to find the best model.

```{r}
# Based on the skew vs. kurtois graph the best distribution

#Calculating gamma distribution 
gamma_w_2015_ <- fitdistrplus::fitdist(data=walking_2015$DURATION%>% unlist() %>% as.numeric(), "gamma", method="mle", optim.method="Nelder-Mead", weights = round(walking_2015$WGHT_EPI))

fit_dgamma <- data.frame(f = dgamma(walking_2015$DURATION, shape = gamma_w_2015_$estimate[1], rate = gamma_w_2015_$estimate[2]), x = walking_2015$DURATION, type = "Gamma")

summary(gamma_w_2015_)

plot(x= fit_dgamma$x, y=fit_dgamma$f)

#Calculating weibull distribution


#weibull_w_2015_ <- fitdistrplus::fitdist(data=walking_2015$DURATION%>% unlist() %>% as.numeric(), "weibull", method="mle", optim.method="Nelder-Mead", weights = round(walking_2015$WGHT_EPI))

#fit_dweibull <- data.frame(f = dweibull(walking_2015$DURATION, shape = weibull_w_2015_$estimate[1], scale = weibull_w_2015_$estimate[2]), x = walking_2015$DURATION, type = "weibull")

#summary(weibull_w_2015_)

#plot(x= fit_dweibull$x, y=fit_dweibull$f)

#Calculating exponential distribution
exp_w_2015_ <- fitdistrplus::fitdist(data=walking_2015$DURATION%>% unlist() %>% as.numeric(), "exp", method="mle", optim.method="Nelder-Mead", weights = round(walking_2015$WGHT_EPI))

summary(exp_w_2015_)

# Get the estimated rate parameter from the fitted distribution
rate_estimate <- exp_w_2015_$estimate[1]

# Create a data frame for the fitted exponential distribution
fit_dexp <- data.frame(f = dexp(walking_2015$DURATION, rate = rate_estimate), 
                       x = walking_2015$DURATION, type = "exp")

# Plot the fitted exponential distribution
plot(x = fit_dexp$x, y = fit_dexp$f)

```

Now let's compare these models AIC and BIC to see which fits the walk data best:

```{r}
#comparing these models AIC and BIC to see which fits the walk data best:
broom::glance(MASS::fitdistr(walking_2015$DURATION%>% unlist() %>% as.numeric(),"gamma"))
#broom::glance(MASS::fitdistr(walking_2015$DURATION%>% unlist() %>% as.numeric(),"weibull"))
broom::glance(MASS::fitdistr(walking_2015$DURATION%>% unlist() %>% as.numeric(),"exponential"))
```

So, gamma has largest logLik and the smallest AIC and BIC. we will pick gamma function for walking trips in 2015!

```{r}
walking_2015_gamma <- gamma_w_2015_
walking_2015 <- walking_2015 %>%
 mutate(f = dgamma(DURATION, walking_2015_gamma$estimate["shape"], walking_2015_gamma$estimate["rate"])) 
summary(walking_2015$f)

```

### Calculating impedance function for walking in 2015 based on different purposes

###Destination : Walking - Home (300),2015

using a skew vs. kurtois graph to descriptive statistics of data

```{r creating Cullen and Frey graph for walkig 2015}
# creating a skew vs. kurtois graph for walking 2015

# Filter the data based on the "destination" column
 w_300_2015 <- walking_2015 %>%
  filter(destination == "300")   
descdist(w_300_2015$DURATION %>% unlist() %>% as.numeric(), discrete=FALSE, boot=500)
```

As shown in the Cullen and Frey graph, we see that gamma, weibull and exponential will likely be the best fit according to the graph above. Then we compare these models to find the best model.

```{r}
# Based on the skew vs. kurtois graph the best distribution

#Calculating gamma distribution 
gamma_w300_2015_ <- fitdistrplus::fitdist(data=w_300_2015$DURATION%>% unlist() %>% as.numeric(), "gamma", method="mle", optim.method="Nelder-Mead", weights = round(w_300_2015$WGHT_EPI))

fit_dgamma_w30015 <- data.frame(f_300 = dgamma(w_300_2015$DURATION, shape = gamma_w300_2015_$estimate[1], rate = gamma_w300_2015_$estimate[2]), x = w_300_2015$DURATION, type = "Gamma")

summary(gamma_w300_2015_)

plot(x= fit_dgamma_w30015$x, y=fit_dgamma_w30015$f)

#Calculating weibull distribution
weibull_w300_2015_ <- fitdistrplus::fitdist(data=w_300_2015$DURATION%>% unlist() %>% as.numeric(), "weibull", method="mle", optim.method="Nelder-Mead", weights = round(w_300_2015$WGHT_EPI))

summary(weibull_w300_2015_)

fit_dweibull_w30015 <- data.frame(f = dweibull(w_300_2015$DURATION, shape = weibull_w300_2015_$estimate[1], scale = weibull_w300_2015_$estimate[2]), x = w_300_2015$DURATION, type = "weibull")

plot(x= fit_dweibull_w30015$x, y=fit_dweibull_w30015$f)

#Calculating exponential distribution
exp_w300_2015_ <- fitdistrplus::fitdist(data=w_300_2015$DURATION%>% unlist() %>% as.numeric(), "exp", method="mle", optim.method="Nelder-Mead", weights = round(w_300_2015$WGHT_EPI))

summary(exp_w300_2015_)

# Get the estimated rate parameter from the fitted distribution
rate_estimate <- exp_w300_2015_$estimate[1]

# Create a data frame for the fitted exponential distribution
fit_dexp_w30015 <- data.frame(f = dexp(w_300_2015$DURATION, rate = rate_estimate), 
                       x = w_300_2015$DURATION, type = "exp")

# Plot the fitted exponential distribution
plot(x = fit_dexp_w30015$x, y = fit_dexp_w30015$f)

```

Now let's compare these models AIC and BIC to see which fits the walk data best:

```{r}
#comparing these models AIC and BIC to see which fits the walk data best:
broom::glance(MASS::fitdistr(w_300_2015$DURATION%>% unlist() %>% as.numeric(),"gamma"))
broom::glance(MASS::fitdistr(w_300_2015$DURATION%>% unlist() %>% as.numeric(),"weibull"))
broom::glance(MASS::fitdistr(w_300_2015$DURATION%>% unlist() %>% as.numeric(),"exponential"))
```

So, gamma has largest logLik and the smallest AIC and BIC. we will pick gamma function for walking trips in 2015!

```{r}
walking_30015_gamma <- gamma_w300_2015_
w_300_2015 <- w_300_2015 %>%
 mutate(f_300 = dgamma(DURATION, walking_30015_gamma$estimate["shape"], walking_30015_gamma$estimate["rate"])) 
summary(w_300_2015$f_300)
```

###Destination : Walking - work or school (301), 2015
using a skew vs. kurtois graph to descriptive statistics of data

```{r creating Cullen and Frey graph for walkig 2015}
# creating a skew vs. kurtois graph for walking 2015

# Filter the data based on the "destination" column
 w_301_2015 <- walking_2015 %>%
  filter(destination == "301")   
descdist(w_301_2015$DURATION %>% unlist() %>% as.numeric(), discrete=FALSE, boot=500)
```

As shown in the Cullen and Frey graph, we see that gamma, weibull, lognormal and exponential will likely be the best fit according to the graph above. Then we compare these models to find the best model.

```{r}
# Based on the skew vs. kurtois graph the best distribution

#Calculating gamma distribution 

gamma_w301_2015_ <- fitdistrplus::fitdist(data=w_301_2015$DURATION%>% unlist() %>% as.numeric(), "gamma", method="mle", optim.method="Nelder-Mead", weights = round(w_301_2015$WGHT_EPI))

fit_dgamma_30115 <- data.frame(f = dgamma(w_301_2015$DURATION, shape = gamma_w301_2015_$estimate[1], rate = gamma_w301_2015_$estimate[2]), x = w_301_2015$DURATION, type = "Gamma")

summary(gamma_w301_2015_)

plot(x= fit_dgamma_30115$x, y=fit_dgamma_30115$f)

#Calculating weibull distribution
weibull_w301_2015_ <- fitdistrplus::fitdist(data=w_301_2015$DURATION%>% unlist() %>% as.numeric(), "weibull", method="mle", optim.method="Nelder-Mead", weights = round(w_301_2015$WGHT_EPI))

summary(weibull_w301_2015_)

fit_dweibull_30115 <- data.frame(f = dweibull(w_301_2015$DURATION, shape = weibull_w301_2015_$estimate[1], scale = weibull_w301_2015_$estimate[2]), x = w_301_2015$DURATION, type = "weibull")

plot(x= fit_dweibull_30115$x, y=fit_dweibull_30115$f)

#Calculating exponential distribution
exp_w301_2015_ <- fitdistrplus::fitdist(data=w_301_2015$DURATION%>% unlist() %>% as.numeric(), "exp", method="mle", optim.method="Nelder-Mead", weights = round(w_301_2015$WGHT_EPI))

summary(exp_w301_2015_)

# Get the estimated rate parameter from the fitted distribution
rate_estimate <- exp_w301_2015_$estimate[1]

# Create a data frame for the fitted exponential distribution
fit_dexp_30115 <- data.frame(f = dexp(w_301_2015$DURATION, rate = rate_estimate), 
                       x = w_301_2015$DURATION, type = "exp")

# Plot the fitted exponential distribution
plot(x = fit_dexp_30115$x, y = fit_dexp_30115$f)

#Calculating lognormal distribution
lnorm_w301_2015_ <- fitdistrplus::fitdist(data=w_301_2015$DURATION%>% unlist() %>% as.numeric(), "lnorm", method="mle", optim.method="Nelder-Mead", weights = round(w_301_2015$WGHT_EPI))

summary(lnorm_w301_2015_)

fit_dlnorm_30115 <- data.frame(f = dlnorm(w_301_2015$DURATION, meanlog = lnorm_w301_2015_$estimate[1], sdlog = lnorm_w301_2015_$estimate[2]), x = w_301_2015$DURATION, type = "lnorm")

plot(x= fit_dlnorm_30115$x, y=fit_dlnorm_30115$f)


```

Now let's compare these models AIC and BIC to see which fits the walk data best:

```{r}
#comparing these models AIC and BIC to see which fits the walk data best:
broom::glance(MASS::fitdistr(w_300_2015$DURATION%>% unlist() %>% as.numeric(),"gamma"))
broom::glance(MASS::fitdistr(w_300_2015$DURATION%>% unlist() %>% as.numeric(),"weibull"))
broom::glance(MASS::fitdistr(w_300_2015$DURATION%>% unlist() %>% as.numeric(),"exponential"))
broom::glance(MASS::fitdistr(w_300_2015$DURATION%>% unlist() %>% as.numeric(),"lognormal"))
```

So, lognormal has largest logLik and the smallest AIC and BIC. we will pick lognormal function for walking trips in 2015!(301)

```{r}
walking_30115_lnorm <- lnorm_w301_2015_
w_301_2015 <- w_301_2015 %>%
 mutate(f_301 = dlnorm(DURATION, walking_30115_lnorm$estimate["meanlog"], walking_30115_lnorm$estimate["sdlog"])) 
summary(w_301_2015$f_301)
```


###Destination : Business (302)
using a skew vs. kurtois graph to descriptive statistics of data

```{r creating Cullen and Frey graph for walkig 2015_ Business destination}
# creating a skew vs. kurtois graph for walking 2015 _ Business destination

# Filter the data based on the "destination" column
 w_302_2015 <- walking_2015 %>%
  filter(destination == "302")   
summary(w_302_2015)

descdist(w_302_2015$DURATION %>% unlist() %>% as.numeric(), discrete=FALSE, boot=100)
```

As shown in the Cullen and Frey graph, we see that gamma, weibull, lognormal and exponential will likely be the best fit according to the graph above. Then we compare these models to find the best model.

```{r}
# Based on the skew vs. kurtois graph the best distribution

#Calculating pois distribution 
pois_w302_2015_ <- fitdistrplus::fitdist(data=w_302_2015$DURATION%>% unlist() %>% as.numeric(), "pois", method="mle", optim.method="Nelder-Mead", weights = round(w_302_2015$WGHT_EPI))

fit_dpois_30215 <- data.frame(f = dpois(w_302_2015$DURATION, lambda = pois_w302_2015_$estimate[1]), x = w_302_2015$DURATION, type = "pois")

summary(pois_w302_2015_)

plot(x= fit_dpois_30215$x, y=fit_dpois_30215$f)

#Calculating weibull distribution
#weibull_w301_2015_ <- fitdistrplus::fitdist(data=w_301_2015$DURATION%>% unlist() %>% as.numeric(), "weibull", method="mle", optim.method="Nelder-Mead", weights = round(w_301_2015$WGHT_EPI))

#summary(weibull_w301_2015_)

#fit_dweibull_30115 <- data.frame(f = dweibull(w_301_2015$DURATION, shape = weibull_w301_2015_$estimate[1], scale = weibull_w301_2015_$estimate[2]), x = w_301_2015$DURATION, type = "weibull")

#plot(x= fit_dweibull_30115$x, y=fit_dweibull_30115$f)

#Calculating exponential distribution
exp_w302_2015_ <- fitdistrplus::fitdist(data=w_302_2015$DURATION%>% unlist() %>% as.numeric(), "exp", method="mle", optim.method="Nelder-Mead", weights = round(w_302_2015$WGHT_EPI))

summary(exp_w302_2015_)

rate_estimate <- exp_w302_2015_$estimate[1]

fit_dexp_30215 <- data.frame(f = dexp(w_302_2015$DURATION, rate = rate_estimate), x = w_302_2015$DURATION, type = "exp")

plot(x = fit_dexp_30215$x, y = fit_dexp_30215$f)



#Calculating lognormal distribution
#lnorm_w301_2015_ <- fitdistrplus::fitdist(data=w_301_2015$DURATION%>% unlist() %>% as.numeric(), "lnorm", method="mle", optim.method="Nelder-Mead", weights = round(w_301_2015$WGHT_EPI))

#summary(lnorm_w301_2015_)

#fit_dlnorm_30115 <- data.frame(f = dlnorm(w_301_2015$DURATION, meanlog = lnorm_w301_2015_$estimate[1], sdlog = lnorm_w301_2015_$estimate[2]), x = w_301_2015$DURATION, type = "lnorm")

#plot(x= fit_dlnorm_30115$x, y=fit_dlnorm_30115$f)


```

Now let's compare these models AIC and BIC to see which fits the walk data best:

```{r}
#comparing these models AIC and BIC to see which fits the walk data best:
broom::glance(MASS::fitdistr(w_300_2015$DURATION%>% unlist() %>% as.numeric(),"exponential"))
broom::glance(MASS::fitdistr(w_300_2015$DURATION%>% unlist() %>% as.numeric(),"poisson"))
```

So, exponential has largest logLik and the smallest AIC and BIC. we will pick exponential function for walking trips in 2015!(302)

```{r}
walking_30215_exp <- exp_w302_2015_
w_302_2015 <- w_302_2015 %>%
 mutate(f_302 = dexp(DURATION, walking_30215_exp$estimate["rate"])) 
summary(w_302_2015$f_302)
```

###Destination : At someone else's home or property (303)
using a skew vs. kurtois graph to descriptive statistics of data

```{r creating Cullen and Frey graph for walkig 2015}
# creating a skew vs. kurtois graph for walking 2015

# Filter the data based on the "destination" column
 w_303_2015 <- walking_2015 %>%
  filter(destination == "303")   
descdist(w_303_2015$DURATION %>% unlist() %>% as.numeric(), discrete=FALSE, boot=500)
```

As shown in the Cullen and Frey graph, we see that gamma, weibull and exponential will likely be the best fit according to the graph above. Then we compare these models to find the best model.

```{r}
# Based on the skew vs. kurtois graph the best distribution

#Calculating gamma distribution 

gamma_w303_2015_ <- fitdistrplus::fitdist(data=w_303_2015$DURATION%>% unlist() %>% as.numeric(), "gamma", method="mle", optim.method="Nelder-Mead", weights = round(w_303_2015$WGHT_EPI))

fit_dgamma_30315 <- data.frame(f = dgamma(w_303_2015$DURATION, shape = gamma_w303_2015_$estimate[1], rate = gamma_w303_2015_$estimate[2]), x = w_303_2015$DURATION, type = "Gamma")

summary(gamma_w303_2015_)

plot(x= fit_dgamma_30315$x, y=fit_dgamma_30315$f)

#Calculating weibull distribution
weibull_w303_2015_ <- fitdistrplus::fitdist(data=w_303_2015$DURATION%>% unlist() %>% as.numeric(), "weibull", method="mle", optim.method="Nelder-Mead", weights = round(w_303_2015$WGHT_EPI))

summary(weibull_w303_2015_)

fit_dweibull_30315 <- data.frame(f = dweibull(w_303_2015$DURATION, shape = weibull_w303_2015_$estimate[1], scale = weibull_w303_2015_$estimate[2]), x = w_303_2015$DURATION, type = "weibull")

plot(x= fit_dweibull_30315$x, y=fit_dweibull_30315$f)

#Calculating exponential distribution
exp_w303_2015_ <- fitdistrplus::fitdist(data=w_303_2015$DURATION%>% unlist() %>% as.numeric(), "exp", method="mle", optim.method="Nelder-Mead", weights = round(w_303_2015$WGHT_EPI))

summary(exp_w303_2015_)

fit_dexp_30315 <- data.frame(f = dexp(w_303_2015$DURATION, rate = exp_w303_2015_$estimate[1]), 
                       x = w_303_2015$DURATION, type = "exp")

plot(x = fit_dexp_30315$x, y = fit_dexp_30315$f)

```

Now let's compare these models AIC and BIC to see which fits the walk data best:

```{r}
#comparing these models AIC and BIC to see which fits the walk data best:
broom::glance(MASS::fitdistr(w_303_2015$DURATION%>% unlist() %>% as.numeric(),"gamma"))
broom::glance(MASS::fitdistr(w_303_2015$DURATION%>% unlist() %>% as.numeric(),"weibull"))
broom::glance(MASS::fitdistr(w_303_2015$DURATION%>% unlist() %>% as.numeric(),"exponential"))
```

So, gamma has largest logLik and the smallest AIC and BIC. we will pick gamma function for walking trips in 2015!(303)

```{r}
walking_30315_gamma <- gamma_w303_2015_
w_303_2015 <- w_303_2015 %>%
 mutate(f_303 = dgamma(DURATION, walking_30315_gamma$estimate["shape"], walking_30315_gamma$estimate["rate"])) 
summary(w_303_2015$f_303)
```



###Destination : Outdoors (305)
using a skew vs. kurtois graph to descriptive statistics of data

```{r creating Cullen and Frey graph for walkig 2015}
# creating a skew vs. kurtois graph for walking 2015

# Filter the data based on the "destination" column
 w_305_2015 <- walking_2015 %>%
  filter(destination == "305")   
descdist(w_305_2015$DURATION %>% unlist() %>% as.numeric(), discrete=FALSE, boot=500)
```

As shown in the Cullen and Frey graph, we see that gamma, poisson and exponential will likely be the best fit according to the graph above. Then we compare these models to find the best model.

```{r}
# Based on the skew vs. kurtois graph the best distribution

#Calculating gamma distribution 

gamma_w305_2015_ <- fitdistrplus::fitdist(data=w_305_2015$DURATION%>% unlist() %>% as.numeric(), "gamma", method="mle", optim.method="Nelder-Mead", weights = round(w_305_2015$WGHT_EPI))

fit_dgamma_30515 <- data.frame(f = dgamma(w_305_2015$DURATION, shape = gamma_w305_2015_$estimate[1], rate = gamma_w305_2015_$estimate[2]), x = w_305_2015$DURATION, type = "Gamma")

summary(gamma_w305_2015_)

plot(x= fit_dgamma_30515$x, y=fit_dgamma_30515$f)


#Calculating exponential distribution
exp_w305_2015_ <- fitdistrplus::fitdist(data=w_305_2015$DURATION%>% unlist() %>% as.numeric(), "exp", method="mle", optim.method="Nelder-Mead", weights = round(w_305_2015$WGHT_EPI))

summary(exp_w305_2015_)

fit_dexp_30515 <- data.frame(f = dexp(w_305_2015$DURATION, rate = exp_w305_2015_$estimate[1]), 
                       x = w_305_2015$DURATION, type = "exp")

plot(x = fit_dexp_30515$x, y = fit_dexp_30515$f)

#Calculating pois distribution 
pois_w305_2015_ <- fitdistrplus::fitdist(data=w_305_2015$DURATION%>% unlist() %>% as.numeric(), "pois", method="mle", optim.method="Nelder-Mead", weights = round(w_305_2015$WGHT_EPI))

fit_dpois_30515 <- data.frame(f = dpois(w_305_2015$DURATION, lambda = pois_w305_2015_$estimate[1]), x = w_305_2015$DURATION, type = "pois")

summary(pois_w305_2015_)

plot(x= fit_dpois_30515$x, y=fit_dpois_30515$f)


```

Now let's compare these models AIC and BIC to see which fits the walk data best:

```{r}
#comparing these models AIC and BIC to see which fits the walk data best:
broom::glance(MASS::fitdistr(w_305_2015$DURATION%>% unlist() %>% as.numeric(),"gamma"))
broom::glance(MASS::fitdistr(w_305_2015$DURATION%>% unlist() %>% as.numeric(),"poisson"))
broom::glance(MASS::fitdistr(w_305_2015$DURATION%>% unlist() %>% as.numeric(),"exponential"))
```

So, gamma has largest logLik and the smallest AIC and BIC. we will pick gamma function for walking trips in 2015!(305)

```{r}
walking_30515_gamma <- gamma_w305_2015_
w_305_2015 <- w_305_2015 %>%
 mutate(f_305 = dgamma(DURATION, walking_30515_gamma$estimate["shape"], walking_30515_gamma$estimate["rate"])) 
summary(w_305_2015$f_305)
```



###Destination : Grocery store, other stores or mall (306)
using a skew vs. kurtois graph to descriptive statistics of data

```{r creating Cullen and Frey graph for walkig 2015}
# creating a skew vs. kurtois graph for walking 2015

# Filter the data based on the "destination" column
 w_306_2015 <- walking_2015 %>%
  filter(destination == "306")   
descdist(w_306_2015$DURATION %>% unlist() %>% as.numeric(), discrete=FALSE, boot=500)
```

As shown in the Cullen and Frey graph, we see that gamma, weibull and exponential will likely be the best fit according to the graph above. Then we compare these models to find the best model.

```{r}
# Based on the skew vs. kurtois graph the best distribution

#Calculating gamma distribution 

gamma_w306_2015_ <- fitdistrplus::fitdist(data=w_306_2015$DURATION%>% unlist() %>% as.numeric(), "gamma", method="mle", optim.method="Nelder-Mead", weights = round(w_306_2015$WGHT_EPI))

fit_dgamma_30615 <- data.frame(f = dgamma(w_306_2015$DURATION, shape = gamma_w306_2015_$estimate[1], rate = gamma_w306_2015_$estimate[2]), x = w_306_2015$DURATION, type = "Gamma")

summary(gamma_w306_2015_)

plot(x= fit_dgamma_30615$x, y=fit_dgamma_30615$f)


#Calculating exponential distribution
exp_w306_2015_ <- fitdistrplus::fitdist(data=w_306_2015$DURATION%>% unlist() %>% as.numeric(), "exp", method="mle", optim.method="Nelder-Mead", weights = round(w_306_2015$WGHT_EPI))

summary(exp_w306_2015_)

fit_dexp_30615 <- data.frame(f = dexp(w_306_2015$DURATION, rate = exp_w306_2015_$estimate[1]), 
                       x = w_306_2015$DURATION, type = "exp")

plot(x = fit_dexp_30615$x, y = fit_dexp_30615$f)

#Calculating weibull distribution
weibull_w306_2015_ <- fitdistrplus::fitdist(data=w_306_2015$DURATION%>% unlist() %>% as.numeric(), "weibull", method="mle", optim.method="Nelder-Mead", weights = round(w_306_2015$WGHT_EPI))

summary(weibull_w306_2015_)

fit_dweibull_30615 <- data.frame(f = dweibull(w_306_2015$DURATION, shape = weibull_w306_2015_$estimate[1], scale = weibull_w306_2015_$estimate[2]), x = w_306_2015$DURATION, type = "weibull")

plot(x= fit_dweibull_30615$x, y=fit_dweibull_30615$f)


```

Now let's compare these models AIC and BIC to see which fits the walk data best:

```{r}
#comparing these models AIC and BIC to see which fits the walk data best:
broom::glance(MASS::fitdistr(w_306_2015$DURATION%>% unlist() %>% as.numeric(),"gamma"))
broom::glance(MASS::fitdistr(w_306_2015$DURATION%>% unlist() %>% as.numeric(),"weibull"))
broom::glance(MASS::fitdistr(w_306_2015$DURATION%>% unlist() %>% as.numeric(),"exponential"))
```

So, gamma has largest logLik and the smallest AIC and BIC. we will pick gamma function for walking trips in 2015!(306)

```{r}
walking_30615_gamma <- gamma_w306_2015_
w_306_2015 <- w_306_2015 %>%
 mutate(f_306 = dgamma(DURATION, walking_30615_gamma$estimate["shape"], walking_30615_gamma$estimate["rate"])) 
summary(w_306_2015$f_306)
```



###Destination : Library, museum or theatre (307)
using a skew vs. kurtois graph to descriptive statistics of data

```{r creating Cullen and Frey graph for walkig 2015}
# creating a skew vs. kurtois graph for walking 2015

# Filter the data based on the "destination" column
 w_307_2015 <- walking_2015 %>%
  filter(destination == "307")   
descdist(w_307_2015$DURATION %>% unlist() %>% as.numeric(), discrete=FALSE, boot=500)
```

As shown in the Cullen and Frey graph, we see that gamma and exponential will likely be the best fit according to the graph above. Then we compare these models to find the best model.

```{r}
# Based on the skew vs. kurtois graph the best distribution

#Calculating gamma distribution 

gamma_w307_2015_ <- fitdistrplus::fitdist(data=w_307_2015$DURATION%>% unlist() %>% as.numeric(), "gamma", method="mle", optim.method="Nelder-Mead", weights = round(w_307_2015$WGHT_EPI))

fit_dgamma_30715 <- data.frame(f = dgamma(w_307_2015$DURATION, shape = gamma_w307_2015_$estimate[1], rate = gamma_w307_2015_$estimate[2]), x = w_307_2015$DURATION, type = "Gamma")

summary(gamma_w307_2015_)

plot(x= fit_dgamma_30715$x, y=fit_dgamma_30715$f)


#Calculating exponential distribution
exp_w307_2015_ <- fitdistrplus::fitdist(data=w_307_2015$DURATION%>% unlist() %>% as.numeric(), "exp", method="mle", optim.method="Nelder-Mead", weights = round(w_307_2015$WGHT_EPI))

summary(exp_w307_2015_)

fit_dexp_30715 <- data.frame(f = dexp(w_307_2015$DURATION, rate = exp_w307_2015_$estimate[1]), 
                       x = w_307_2015$DURATION, type = "exp")

plot(x = fit_dexp_30715$x, y = fit_dexp_30715$f)

```

Now let's compare these models AIC and BIC to see which fits the walk data best:

```{r}
#comparing these models AIC and BIC to see which fits the walk data best:
broom::glance(MASS::fitdistr(w_307_2015$DURATION%>% unlist() %>% as.numeric(),"gamma"))
broom::glance(MASS::fitdistr(w_307_2015$DURATION%>% unlist() %>% as.numeric(),"exponential"))
```

So, gamma has largest logLik and the smallest AIC and BIC. we will pick gamma function for walking trips in 2015!(307)

```{r}
walking_30715_gamma <- gamma_w307_2015_
w_307_2015 <- w_307_2015 %>%
 mutate(f_307 = dgamma(DURATION, walking_30715_gamma$estimate["shape"], walking_30715_gamma$estimate["rate"])) 
summary(w_307_2015$f_307)
```


###Destination : Restaurant, bar or club (309)
using a skew vs. kurtois graph to descriptive statistics of data

```{r creating Cullen and Frey graph for walkig 2015}
# creating a skew vs. kurtois graph for walking 2015

# Filter the data based on the "destination" column
 w_309_2015 <- walking_2015 %>%
  filter(destination == "309")   

descdist(w_309_2015$DURATION %>% unlist() %>% as.numeric(), discrete=FALSE, boot=500)
```

As shown in the Cullen and Frey graph, we see that gamma and exponential will likely be the best fit according to the graph above. Then we compare these models to find the best model.

```{r}
# Based on the skew vs. kurtois graph the best distribution

#Calculating gamma distribution 

gamma_w309_2015_ <- fitdistrplus::fitdist(data=w_309_2015$DURATION%>% unlist() %>% as.numeric(), "gamma", method="mle", optim.method="Nelder-Mead", weights = round(w_309_2015$WGHT_EPI))

fit_dgamma_30915 <- data.frame(f = dgamma(w_309_2015$DURATION, shape = gamma_w309_2015_$estimate[1], rate = gamma_w309_2015_$estimate[2]), x = w_309_2015$DURATION, type = "Gamma")

summary(gamma_w309_2015_)

plot(x= fit_dgamma_30915$x, y=fit_dgamma_30915$f)


#Calculating exponential distribution
exp_w309_2015_ <- fitdistrplus::fitdist(data=w_309_2015$DURATION%>% unlist() %>% as.numeric(), "exp", method="mle", optim.method="Nelder-Mead", weights = round(w_309_2015$WGHT_EPI))

summary(exp_w309_2015_)

fit_dexp_30915 <- data.frame(f = dexp(w_309_2015$DURATION, rate = exp_w309_2015_$estimate[1]), 
                       x = w_309_2015$DURATION, type = "exp")

plot(x = fit_dexp_30915$x, y = fit_dexp_30915$f)

```

Now let's compare these models AIC and BIC to see which fits the walk data best:

```{r}
#comparing these models AIC and BIC to see which fits the walk data best:
broom::glance(MASS::fitdistr(w_309_2015$DURATION%>% unlist() %>% as.numeric(),"gamma"))
broom::glance(MASS::fitdistr(w_309_2015$DURATION%>% unlist() %>% as.numeric(),"exponential"))
```

So, gamma has largest logLik and the smallest AIC and BIC. we will pick gamma function for walking trips in 2015!(309)

```{r}
walking_30915_gamma <- gamma_w309_2015_
w_309_2015 <- w_309_2015 %>%
 mutate(f_309 = dgamma(DURATION, walking_30915_gamma$estimate["shape"], walking_30915_gamma$estimate["rate"])) 
summary(w_309_2015$f_309)
```

###Destination : Place of worship (310)
using a skew vs. kurtois graph to descriptive statistics of data

```{r creating Cullen and Frey graph for walkig 2015}
# creating a skew vs. kurtois graph for walking 2015

# Filter the data based on the "destination" column
 w_310_2015 <- walking_2015 %>%
  filter(destination == "310")   

descdist(w_310_2015$DURATION %>% unlist() %>% as.numeric(), discrete=FALSE, boot=500)
```

As shown in the Cullen and Frey graph, we see that gamma, normal and exponential will likely be the best fit according to the graph above. Then we compare these models to find the best model.

```{r}
# Based on the skew vs. kurtois graph the best distribution

#Calculating gamma distribution 

gamma_w310_2015_ <- fitdistrplus::fitdist(data=w_310_2015$DURATION%>% unlist() %>% as.numeric(), "gamma", method="mle", optim.method="Nelder-Mead", weights = round(w_310_2015$WGHT_EPI))

fit_dgamma_31015 <- data.frame(f = dgamma(w_310_2015$DURATION, shape = gamma_w310_2015_$estimate[1], rate = gamma_w310_2015_$estimate[2]), x = w_310_2015$DURATION, type = "Gamma")

summary(gamma_w310_2015_)

plot(x= fit_dgamma_31015$x, y=fit_dgamma_31015$f)


#Calculating exponential distribution
exp_w310_2015_ <- fitdistrplus::fitdist(data=w_310_2015$DURATION%>% unlist() %>% as.numeric(), "exp", method="mle", optim.method="Nelder-Mead", weights = round(w_310_2015$WGHT_EPI))

summary(exp_w310_2015_)

fit_dexp_31015 <- data.frame(f = dexp(w_310_2015$DURATION, rate = exp_w310_2015_$estimate[1]), 
                       x = w_310_2015$DURATION, type = "exp")

plot(x = fit_dexp_31015$x, y = fit_dexp_31015$f)


#Calculating normal distribution 

norm_w310_2015_ <- fitdistrplus::fitdist(data=w_310_2015$DURATION%>% unlist() %>% as.numeric(), "norm", method="mle", optim.method="Nelder-Mead", weights = round(w_310_2015$WGHT_EPI))

summary(norm_w310_2015_)
fit_dnorm_31015 <- data.frame(f = dnorm(w_310_2015$DURATION, mean = norm_w310_2015_$estimate[1], sd = norm_w310_2015_$estimate[2]), x = w_310_2015$DURATION, type = "norm")

plot(x= fit_dnorm_31015$x, y=fit_dnorm_31015$f)
```

Now let's compare these models AIC and BIC to see which fits the walk data best:

```{r}
#comparing these models AIC and BIC to see which fits the walk data best:
broom::glance(MASS::fitdistr(w_310_2015$DURATION%>% unlist() %>% as.numeric(),"gamma"))
broom::glance(MASS::fitdistr(w_310_2015$DURATION%>% unlist() %>% as.numeric(),"exponential"))
broom::glance(MASS::fitdistr(w_310_2015$DURATION%>% unlist() %>% as.numeric(),"normal"))
```

So, gamma has largest logLik and the smallest AIC and BIC. we will pick gamma function for walking trips in 2015!(310)

```{r}
walking_31015_gamma <- gamma_w310_2015_
w_310_2015 <- w_310_2015 %>%
 mutate(f_310 = dgamma(DURATION, walking_31015_gamma$estimate["shape"], walking_31015_gamma$estimate["rate"])) 
summary(w_310_2015$f_310)
```


### Calculating impedance function for walking in 2010

using a skew vs. kurtois graph to descriptive statistics of data:

```{r creating Cullen and Frey graph for walkig 2010}
# creating a skew vs. kurtois graph for walking 2010

descdist(walking_2010$DURATION %>% unlist() %>% as.numeric(), discrete=FALSE, boot=500)
```

As shown in the Cullen and Frey graph, we see that Weibull, gamma, lognormal and exponential will likely be the best fit according to the graph above. Then we compare these models to find the best model.

```{r}

# The Duration column contains eight zero values. Before proceeding to calculate the gamma, exponential, lognormal and weibull distribution, a preprocessing step was undertaken, converting these zero values to the value of five.

# change 0 value to 5
walking_2010$DURATION[walking_2010$DURATION == 0] <- 5

# Based on the skew vs. kurtois graph the best distribution

#Calculating gamma distribution

gamma_w_2010_ <- fitdistrplus::fitdist(data=walking_2010$DURATION%>% unlist() %>% as.numeric(), "gamma", method="mle", optim.method="Nelder-Mead", weights = round(walking_2010$WGHT_EPI))

fit_dgamma <- data.frame(f = dgamma(walking_2010$DURATION, shape = gamma_w_2010_$estimate[1], rate = gamma_w_2010_$estimate[2]), x = walking_2010$DURATION, type = "Gamma")

summary(gamma_w_2010_)

plot(x= fit_dgamma$x, y=fit_dgamma$f)

#Calculating weibull distribution
weibull_w_2010_ <- fitdistrplus::fitdist(data=walking_2010$DURATION%>% unlist() %>% as.numeric(), "weibull", method="mle", optim.method="Nelder-Mead", weights = round(walking_2010$WGHT_EPI))

summary(weibull_w_2010_)

fit_dweibull <- data.frame(f = dweibull(walking_2010$DURATION, shape = weibull_w_2010_$estimate[1], scale = weibull_w_2010_$estimate[2]), x = walking_2010$DURATION, type = "weibull")

plot(x= fit_dweibull$x, y=fit_dweibull$f)


#Calculating exponential distribution
exp_w_2010_ <- fitdistrplus::fitdist(data=walking_2010$DURATION%>% unlist() %>% as.numeric(), "exp", method="mle", optim.method="Nelder-Mead", weights = round(walking_2010$WGHT_EPI))

summary(exp_w_2010_)

# Get the estimated rate parameter from the fitted distribution
rate_estimate <- exp_w_2010_$estimate[1]

# Create a data frame for the fitted exponential distribution
fit_dexp <- data.frame(f = dexp(walking_2010$DURATION, rate = rate_estimate), 
                       x = walking_2010$DURATION, type = "exp")

# Plot the fitted exponential distribution
plot(x = fit_dexp$x, y = fit_dexp$f)

#Calculating lognormal distribution
lnorm_w_2010_ <- fitdistrplus::fitdist(data=walking_2010$DURATION%>% unlist() %>% as.numeric(), "lnorm", method="mle", optim.method="Nelder-Mead", weights = round(walking_2010$WGHT_EPI))

summary(lnorm_w_2010_)

fit_dlnorm <- data.frame(f = dlnorm(walking_2010$DURATION, meanlog = lnorm_w_2010_$estimate[1], sdlog = lnorm_w_2010_$estimate[2]), x = walking_2010$DURATION, type = "lnorm")

plot(x= fit_dlnorm$x, y=fit_dlnorm$f)



```

Now let's compare these models based on AIC and BIC to see which fits the walking 2010 data best:

```{r}
#comparing these models AIC and BIC to see which fits the walk data best:
broom::glance(MASS::fitdistr(walking_2010$DURATION%>% unlist() %>% as.numeric(),"gamma"))
broom::glance(MASS::fitdistr(walking_2010$DURATION%>% unlist() %>% as.numeric(),"weibull"))
broom::glance(MASS::fitdistr(walking_2010$DURATION%>% unlist() %>% as.numeric(),"exponential"))
broom::glance(MASS::fitdistr(walking_2010$DURATION%>% unlist() %>% as.numeric(),"lognormal"))
```

So, lognormal has largest logLik and the smallest AIC and BIC. we will pick lognormal function for walking trips in 2010!

```{r}
# Load and define walking_2010_lnorm if not already defined
walking_2010_lnorm <- lnorm_w_2010_

# Perform the mutation using the dlnorm function
walking_2010 <- walking_2010 %>%
  mutate(f = dlnorm(DURATION, meanlog = walking_2010_lnorm$estimate["meanlog"],
                    sdlog = walking_2010_lnorm$estimate["sdlog"]))

# Print summary of the new 'f' variable
summary(walking_2010$f)

```

### Calculating impedance function for walking in 2010 based on different purposes

###Destination : Home (1)

using a skew vs. kurtois graph to descriptive statistics of data

```{r creating Cullen and Frey graph for walkig 2010}
# creating a skew vs. kurtois graph for walking 2010

# Filter the data based on the "destination" column
 w_1_2010 <- walking_2010 %>%
  filter(destination == "1")   
descdist(w_1_2010$DURATION %>% unlist() %>% as.numeric(), discrete=FALSE, boot=500)
```

As shown in the Cullen and Frey graph, we see that gamma, weibull and exponential will likely be the best fit according to the graph above. Then we compare these models to find the best model.

```{r}
# Based on the skew vs. kurtois graph the best distribution

#Calculating gamma distribution 
gamma_w1_2010_ <- fitdistrplus::fitdist(data=w_1_2010$DURATION%>% unlist() %>% as.numeric(), "gamma", method="mle", optim.method="Nelder-Mead", weights = round(w_1_2010$WGHT_EPI))

fit_dgamma_w110 <- data.frame(f = dgamma(w_1_2010$DURATION, shape = gamma_w1_2010_$estimate[1], rate = gamma_w1_2010_$estimate[2]), x = w_1_2010$DURATION, type = "Gamma")

summary(gamma_w1_2010_)

plot(x= fit_dgamma_w110$x, y=fit_dgamma_w110$f)

#Calculating weibull distribution
weibull_w1_2010_ <- fitdistrplus::fitdist(data=w_1_2010$DURATION%>% unlist() %>% as.numeric(), "weibull", method="mle", optim.method="Nelder-Mead", weights = round(w_1_2010$WGHT_EPI))

summary(weibull_w1_2010_)

fit_dweibull_w110 <- data.frame(f = dweibull(w_1_2010$DURATION, shape = weibull_w1_2010_$estimate[1], scale = weibull_w1_2010_$estimate[2]), x = w_1_2010$DURATION, type = "weibull")

plot(x= fit_dweibull_w110$x, y=fit_dweibull_w110$f)

#Calculating exponential distribution
exp_w1_2010_ <- fitdistrplus::fitdist(data=w_1_2010$DURATION%>% unlist() %>% as.numeric(), "exp", method="mle", optim.method="Nelder-Mead", weights = round(w_1_2010$WGHT_EPI))

summary(exp_w1_2010_)

fit_dexp_w110 <- data.frame(f = dexp(w_1_2010$DURATION, rate = exp_w1_2010_$estimate[1]), 
                       x = w_1_2010$DURATION, type = "exp")

plot(x = fit_dexp_w110$x, y = fit_dexp_w110$f)

```

Now let's compare these models AIC and BIC to see which fits the walk data best:

```{r}
#comparing these models AIC and BIC to see which fits the walk data best:
broom::glance(MASS::fitdistr(w_1_2010$DURATION%>% unlist() %>% as.numeric(),"gamma"))
broom::glance(MASS::fitdistr(w_1_2010$DURATION%>% unlist() %>% as.numeric(),"weibull"))
broom::glance(MASS::fitdistr(w_1_2010$DURATION%>% unlist() %>% as.numeric(),"exponential"))
```

So, gamma has largest logLik and the smallest AIC and BIC. we will pick gamma function for walking trips in 2010!

```{r}
walking_110_gamma <- gamma_w1_2010_
w_1_2010 <- w_1_2010 %>%
 mutate(f_1 = dgamma(DURATION, walking_110_gamma$estimate["shape"], walking_110_gamma$estimate["rate"])) 
summary(w_1_2010$f_1)
```


###Destination : work or school (2 and 8)

using a skew vs. kurtois graph to descriptive statistics of data

```{r creating Cullen and Frey graph for walkig 2010}
# creating a skew vs. kurtois graph for walking 2010

# Filter the data based on the "destination" column
 w_2_2010 <- walking_2010 %>%
  filter(destination %in% c("2", "8"))   
descdist(w_2_2010$DURATION %>% unlist() %>% as.numeric(), discrete=FALSE, boot=500)
```

As shown in the Cullen and Frey graph, we see that gamma, weibull, lognormal and exponential will likely be the best fit according to the graph above. Then we compare these models to find the best model.

```{r}
# Based on the skew vs. kurtois graph the best distribution

#Calculating gamma distribution 
gamma_w2_2010_ <- fitdistrplus::fitdist(data=w_2_2010$DURATION%>% unlist() %>% as.numeric(), "gamma", method="mle", optim.method="Nelder-Mead", weights = round(w_2_2010$WGHT_EPI))

fit_dgamma_w210 <- data.frame(f = dgamma(w_2_2010$DURATION, shape = gamma_w2_2010_$estimate[1], rate = gamma_w2_2010_$estimate[2]), x = w_2_2010$DURATION, type = "Gamma")

summary(gamma_w2_2010_)

plot(x= fit_dgamma_w210$x, y=fit_dgamma_w210$f)

#Calculating weibull distribution
weibull_w2_2010_ <- fitdistrplus::fitdist(data=w_2_2010$DURATION%>% unlist() %>% as.numeric(), "weibull", method="mle", optim.method="Nelder-Mead", weights = round(w_2_2010$WGHT_EPI))

summary(weibull_w2_2010_)

fit_dweibull_w210 <- data.frame(f = dweibull(w_2_2010$DURATION, shape = weibull_w2_2010_$estimate[1], scale = weibull_w2_2010_$estimate[2]), x = w_2_2010$DURATION, type = "weibull")

plot(x= fit_dweibull_w210$x, y=fit_dweibull_w210$f)

#Calculating exponential distribution
exp_w2_2010_ <- fitdistrplus::fitdist(data=w_2_2010$DURATION%>% unlist() %>% as.numeric(), "exp", method="mle", optim.method="Nelder-Mead", weights = round(w_2_2010$WGHT_EPI))

summary(exp_w2_2010_)

fit_dexp_w210 <- data.frame(f = dexp(w_2_2010$DURATION, rate = exp_w2_2010_$estimate[1]), 
                       x = w_2_2010$DURATION, type = "exp")

plot(x = fit_dexp_w210$x, y = fit_dexp_w210$f)


#Calculating lognormal distribution
lnorm_w2_2010_ <- fitdistrplus::fitdist(data=w_2_2010$DURATION%>% unlist() %>% as.numeric(), "lnorm", method="mle", optim.method="Nelder-Mead", weights = round(w_2_2010$WGHT_EPI))

summary(lnorm_w2_2010_)

fit_dlnorm_210 <- data.frame(f = dlnorm(w_2_2010$DURATION, meanlog = lnorm_w2_2010_$estimate[1], sdlog = lnorm_w2_2010_$estimate[2]), x = w_2_2010$DURATION, type = "lnorm")

plot(x= fit_dlnorm_210$x, y=fit_dlnorm_210$f)

```

Now let's compare these models AIC and BIC to see which fits the walk data best:

```{r}
#comparing these models AIC and BIC to see which fits the walk data best:
broom::glance(MASS::fitdistr(w_2_2010$DURATION%>% unlist() %>% as.numeric(),"gamma"))
broom::glance(MASS::fitdistr(w_2_2010$DURATION%>% unlist() %>% as.numeric(),"weibull"))
broom::glance(MASS::fitdistr(w_2_2010$DURATION%>% unlist() %>% as.numeric(),"exponential"))
broom::glance(MASS::fitdistr(w_2_2010$DURATION%>% unlist() %>% as.numeric(),"lognormal"))
```

So, lognormal has largest logLik and the smallest AIC and BIC. we will pick lognormal function for walking trips in 2010!

```{r}
walking_2010_lnorm <- lnorm_w2_2010_
w_2_2010 <- w_2_2010 %>%
 mutate(f_2 = dlnorm(DURATION, walking_2010_lnorm$estimate["meanlog"], walking_2010_lnorm$estimate["sdlog"])) 
summary(w_2_2010$f_2)
```

###Destination : other's home (3)

using a skew vs. kurtois graph to descriptive statistics of data

```{r creating Cullen and Frey graph for walkig 2010}
# creating a skew vs. kurtois graph for walking 2010

# Filter the data based on the "destination" column
 w_3_2010 <- walking_2010 %>%
  filter(destination == "3")   
descdist(w_3_2010$DURATION %>% unlist() %>% as.numeric(), discrete=FALSE, boot=500)
```

As shown in the Cullen and Frey graph, we see that gamma, weibull and exponential will likely be the best fit according to the graph above. Then we compare these models to find the best model.

```{r}
# Based on the skew vs. kurtois graph the best distribution

#Calculating gamma distribution 
gamma_w3_2010_ <- fitdistrplus::fitdist(data=w_3_2010$DURATION%>% unlist() %>% as.numeric(), "gamma", method="mle", optim.method="Nelder-Mead", weights = round(w_3_2010$WGHT_EPI))

fit_dgamma_w310 <- data.frame(f = dgamma(w_3_2010$DURATION, shape = gamma_w3_2010_$estimate[1], rate = gamma_w3_2010_$estimate[2]), x = w_3_2010$DURATION, type = "Gamma")

summary(gamma_w3_2010_)

plot(x= fit_dgamma_w310$x, y=fit_dgamma_w310$f)

#Calculating weibull distribution
weibull_w3_2010_ <- fitdistrplus::fitdist(data=w_3_2010$DURATION%>% unlist() %>% as.numeric(), "weibull", method="mle", optim.method="Nelder-Mead", weights = round(w_3_2010$WGHT_EPI))

summary(weibull_w3_2010_)

fit_dweibull_w310 <- data.frame(f = dweibull(w_3_2010$DURATION, shape = weibull_w3_2010_$estimate[1], scale = weibull_w3_2010_$estimate[2]), x = w_3_2010$DURATION, type = "weibull")

plot(x= fit_dweibull_w310$x, y=fit_dweibull_w310$f)

#Calculating exponential distribution
exp_w3_2010_ <- fitdistrplus::fitdist(data=w_3_2010$DURATION%>% unlist() %>% as.numeric(), "exp", method="mle", optim.method="Nelder-Mead", weights = round(w_3_2010$WGHT_EPI))

summary(exp_w3_2010_)

fit_dexp_w310 <- data.frame(f = dexp(w_3_2010$DURATION, rate = exp_w3_2010_$estimate[1]), 
                       x = w_3_2010$DURATION, type = "exp")

plot(x = fit_dexp_w310$x, y = fit_dexp_w310$f)

```

Now let's compare these models AIC and BIC to see which fits the walk data best:

```{r}
#comparing these models AIC and BIC to see which fits the walk data best:
broom::glance(MASS::fitdistr(w_3_2010$DURATION%>% unlist() %>% as.numeric(),"gamma"))
broom::glance(MASS::fitdistr(w_3_2010$DURATION%>% unlist() %>% as.numeric(),"weibull"))
broom::glance(MASS::fitdistr(w_3_2010$DURATION%>% unlist() %>% as.numeric(),"exponential"))
```

So, exponential has largest logLik and the smallest AIC and BIC. we will pick exponential function for walking trips in 2010!

```{r}
walking_310_exp <- exp_w3_2010_
w_3_2010 <- w_3_2010 %>%
 mutate(f_3 = dexp(DURATION, walking_310_exp$estimate["rate"])) 
summary(w_3_2010$f_3)
```


###Destination : Restaurant/bar (4)

using a skew vs. kurtois graph to descriptive statistics of data

```{r creating Cullen and Frey graph for walkig 2010}
# creating a skew vs. kurtois graph for walking 2010

# Filter the data based on the "destination" column
 w_4_2010 <- walking_2010 %>%
  filter(destination == "4")   
descdist(w_4_2010$DURATION %>% unlist() %>% as.numeric(), discrete=FALSE, boot=500)
```

As shown in the Cullen and Frey graph, we see that gamma, weibull and exponential will likely be the best fit according to the graph above. Then we compare these models to find the best model.

```{r}
# Based on the skew vs. kurtois graph the best distribution

#Calculating gamma distribution 
gamma_w4_2010_ <- fitdistrplus::fitdist(data=w_4_2010$DURATION%>% unlist() %>% as.numeric(), "gamma", method="mle", optim.method="Nelder-Mead", weights = round(w_4_2010$WGHT_EPI))

fit_dgamma_w410 <- data.frame(f = dgamma(w_4_2010$DURATION, shape = gamma_w4_2010_$estimate[1], rate = gamma_w4_2010_$estimate[2]), x = w_4_2010$DURATION, type = "Gamma")

summary(gamma_w4_2010_)

plot(x= fit_dgamma_w410$x, y=fit_dgamma_w410$f)

#Calculating weibull distribution
weibull_w4_2010_ <- fitdistrplus::fitdist(data=w_4_2010$DURATION%>% unlist() %>% as.numeric(), "weibull", method="mle", optim.method="Nelder-Mead", weights = round(w_4_2010$WGHT_EPI))

summary(weibull_w4_2010_)

fit_dweibull_w410 <- data.frame(f = dweibull(w_4_2010$DURATION, shape = weibull_w4_2010_$estimate[1], scale = weibull_w4_2010_$estimate[2]), x = w_4_2010$DURATION, type = "weibull")

plot(x= fit_dweibull_w410$x, y=fit_dweibull_w410$f)

#Calculating exponential distribution
exp_w4_2010_ <- fitdistrplus::fitdist(data=w_4_2010$DURATION%>% unlist() %>% as.numeric(), "exp", method="mle", optim.method="Nelder-Mead", weights = round(w_4_2010$WGHT_EPI))

summary(exp_w4_2010_)

fit_dexp_w410 <- data.frame(f = dexp(w_4_2010$DURATION, rate = exp_w4_2010_$estimate[1]), 
                       x = w_4_2010$DURATION, type = "exp")

plot(x = fit_dexp_w410$x, y = fit_dexp_w410$f)

```

Now let's compare these models AIC and BIC to see which fits the walk data best:

```{r}
#comparing these models AIC and BIC to see which fits the walk data best:
broom::glance(MASS::fitdistr(w_4_2010$DURATION%>% unlist() %>% as.numeric(),"gamma"))
broom::glance(MASS::fitdistr(w_4_2010$DURATION%>% unlist() %>% as.numeric(),"weibull"))
broom::glance(MASS::fitdistr(w_4_2010$DURATION%>% unlist() %>% as.numeric(),"exponential"))
```

So, gamma has largest logLik and the smallest AIC and BIC. we will pick gamma function for walking trips in 2010!

```{r}
walking_410_gamma <- gamma_w4_2010_
w_4_2010 <- w_4_2010 %>%
 mutate(f_4 = dgamma(DURATION, walking_410_gamma$estimate["shape"],walking_410_gamma$estimate["rate"] )) 
summary(w_4_2010$f_4)
```

###Destination : Place of worship (5)

using a skew vs. kurtois graph to descriptive statistics of data

```{r creating Cullen and Frey graph for walkig 2010}
# creating a skew vs. kurtois graph for walking 2010

# Filter the data based on the "destination" column
 w_5_2010 <- walking_2010 %>%
  filter(destination == "5")   
descdist(w_5_2010$DURATION %>% unlist() %>% as.numeric(), discrete=FALSE, boot=500)
```

As shown in the Cullen and Frey graph, we see that gamma, weibull, normal, logistic and exponential will likely be the best fit according to the graph above. Then we compare these models to find the best model.

```{r}
# Based on the skew vs. kurtois graph the best distribution

#Calculating gamma distribution 
gamma_w5_2010_ <- fitdistrplus::fitdist(data=w_5_2010$DURATION%>% unlist() %>% as.numeric(), "gamma", method="mle", optim.method="Nelder-Mead", weights = round(w_5_2010$WGHT_EPI))

fit_dgamma_w510 <- data.frame(f = dgamma(w_5_2010$DURATION, shape = gamma_w5_2010_$estimate[1], rate = gamma_w5_2010_$estimate[2]), x = w_5_2010$DURATION, type = "Gamma")

summary(gamma_w5_2010_)

plot(x= fit_dgamma_w510$x, y=fit_dgamma_w510$f)

#Calculating weibull distribution
weibull_w5_2010_ <- fitdistrplus::fitdist(data=w_5_2010$DURATION%>% unlist() %>% as.numeric(), "weibull", method="mle", optim.method="Nelder-Mead", weights = round(w_5_2010$WGHT_EPI))

summary(weibull_w5_2010_)

fit_dweibull_w510 <- data.frame(f = dweibull(w_5_2010$DURATION, shape = weibull_w5_2010_$estimate[1], scale = weibull_w5_2010_$estimate[2]), x = w_5_2010$DURATION, type = "weibull")

plot(x= fit_dweibull_w510$x, y=fit_dweibull_w510$f)

#Calculating exponential distribution
exp_w5_2010_ <- fitdistrplus::fitdist(data=w_5_2010$DURATION%>% unlist() %>% as.numeric(), "exp", method="mle", optim.method="Nelder-Mead", weights = round(w_5_2010$WGHT_EPI))

summary(exp_w5_2010_)

fit_dexp_w510 <- data.frame(f = dexp(w_5_2010$DURATION, rate = exp_w5_2010_$estimate[1]), 
                       x = w_5_2010$DURATION, type = "exp")

plot(x = fit_dexp_w510$x, y = fit_dexp_w510$f)


#Calculating normal distribution
norm_w5_2010_ <- fitdistrplus::fitdist(data=w_5_2010$DURATION%>% unlist() %>% as.numeric(), "norm", method="mle", optim.method="Nelder-Mead", weights = round(w_5_2010$WGHT_EPI))

summary(norm_w5_2010_)

fit_dnorm_w510 <- data.frame(f = dnorm(w_5_2010$DURATION, mean = norm_w5_2010_$estimate[1], sd = norm_w5_2010_$estimate[2]), 
                       x = w_5_2010$DURATION, type = "norm")

plot(x = fit_dnorm_w510$x, y = fit_dnorm_w510$f)

#Calculating logistic distribution
logis_w5_2010_ <- fitdistrplus::fitdist(data=w_5_2010$DURATION%>% unlist() %>% as.numeric(), "logis", method="mle", optim.method="Nelder-Mead", weights = round(w_5_2010$WGHT_EPI))

summary(logis_w5_2010_)

fit_dlogis_w510 <- data.frame(f = dlogis(w_5_2010$DURATION, location = logis_w5_2010_$estimate[1], scale = logis_w5_2010_$estimate[2]), 
                       x = w_5_2010$DURATION, type = "logis")

plot(x = fit_dlogis_w510$x, y = fit_dlogis_w510$f)

```

Now let's compare these models AIC and BIC to see which fits the walk data best:

```{r}
#comparing these models AIC and BIC to see which fits the walk data best:
broom::glance(MASS::fitdistr(w_5_2010$DURATION%>% unlist() %>% as.numeric(),"gamma"))
broom::glance(MASS::fitdistr(w_5_2010$DURATION%>% unlist() %>% as.numeric(),"weibull"))
broom::glance(MASS::fitdistr(w_5_2010$DURATION%>% unlist() %>% as.numeric(),"exponential"))
broom::glance(MASS::fitdistr(w_5_2010$DURATION%>% unlist() %>% as.numeric(),"normal"))
broom::glance(MASS::fitdistr(w_5_2010$DURATION%>% unlist() %>% as.numeric(),"logistic"))
```

So, gamma has largest logLik and the smallest AIC and BIC. we will pick gamma function for walking trips in 2010!

```{r}
walking_510_gamma <- gamma_w5_2010_
w_5_2010 <- w_5_2010 %>%
 mutate(f_5 = dgamma(DURATION, walking_510_gamma$estimate["shape"],walking_510_gamma$estimate["rate"] )) 
summary(w_5_2010$f_5)
```

###Destination :Grocery store, other stores or mall (6 ad 7)

using a skew vs. kurtois graph to descriptive statistics of data

```{r creating Cullen and Frey graph for walkig 2010}
# creating a skew vs. kurtois graph for walking 2010

# Filter the data based on the "destination" column
 w_6_2010 <- walking_2010 %>%
  filter(destination %in% c("6", "7"))   
descdist(w_6_2010$DURATION %>% unlist() %>% as.numeric(), discrete=FALSE, boot=500)
```

As shown in the Cullen and Frey graph, we see that gamma, weibull and exponential will likely be the best fit according to the graph above. Then we compare these models to find the best model.

```{r}
# Based on the skew vs. kurtois graph the best distribution

#Calculating gamma distribution 
gamma_w6_2010_ <- fitdistrplus::fitdist(data=w_6_2010$DURATION%>% unlist() %>% as.numeric(), "gamma", method="mle", optim.method="Nelder-Mead", weights = round(w_6_2010$WGHT_EPI))

fit_dgamma_w610 <- data.frame(f = dgamma(w_6_2010$DURATION, shape = gamma_w6_2010_$estimate[1], rate = gamma_w6_2010_$estimate[2]), x = w_6_2010$DURATION, type = "Gamma")

summary(gamma_w6_2010_)

plot(x= fit_dgamma_w610$x, y=fit_dgamma_w610$f)

#Calculating weibull distribution
weibull_w6_2010_ <- fitdistrplus::fitdist(data=w_6_2010$DURATION%>% unlist() %>% as.numeric(), "weibull", method="mle", optim.method="Nelder-Mead", weights = round(w_6_2010$WGHT_EPI))

summary(weibull_w6_2010_)

fit_dweibull_w610 <- data.frame(f = dweibull(w_6_2010$DURATION, shape = weibull_w6_2010_$estimate[1], scale = weibull_w6_2010_$estimate[2]), x = w_6_2010$DURATION, type = "weibull")

plot(x= fit_dweibull_w610$x, y=fit_dweibull_w610$f)

#Calculating exponential distribution
exp_w6_2010_ <- fitdistrplus::fitdist(data=w_6_2010$DURATION%>% unlist() %>% as.numeric(), "exp", method="mle", optim.method="Nelder-Mead", weights = round(w_6_2010$WGHT_EPI))

summary(exp_w6_2010_)

fit_dexp_w610 <- data.frame(f = dexp(w_6_2010$DURATION, rate = exp_w6_2010_$estimate[1]), 
                       x = w_6_2010$DURATION, type = "exp")

plot(x = fit_dexp_w610$x, y = fit_dexp_w610$f)

```

Now let's compare these models AIC and BIC to see which fits the walk data best:

```{r}
#comparing these models AIC and BIC to see which fits the walk data best:
broom::glance(MASS::fitdistr(w_6_2010$DURATION%>% unlist() %>% as.numeric(),"gamma"))
broom::glance(MASS::fitdistr(w_6_2010$DURATION%>% unlist() %>% as.numeric(),"weibull"))
broom::glance(MASS::fitdistr(w_6_2010$DURATION%>% unlist() %>% as.numeric(),"exponential"))
```

So, gamma has largest logLik and the smallest AIC and BIC. we will pick gamma function for walking trips in 2010!

```{r}
walking_610_gamma <- gamma_w6_2010_
w_6_2010 <- w_6_2010 %>%
 mutate(f_6 = dgamma(DURATION, walking_610_gamma$estimate["shape"],walking_610_gamma$estimate["rate"] )) 
summary(w_6_2010$f_6)
```

###Destination :Outdoors (9)

using a skew vs. kurtois graph to descriptive statistics of data

```{r creating Cullen and Frey graph for walkig 2010}
# creating a skew vs. kurtois graph for walking 2010

# Filter the data based on the "destination" column
 w_9_2010 <- walking_2010 %>%
  filter(destination == "9")   
descdist(w_9_2010$DURATION %>% unlist() %>% as.numeric(), discrete=FALSE, boot=500)
```

As shown in the Cullen and Frey graph, we see that gamma and exponential will likely be the best fit according to the graph above. Then we compare these models to find the best model.

```{r}
# Based on the skew vs. kurtois graph the best distribution

#Calculating gamma distribution 
gamma_w9_2010_ <- fitdistrplus::fitdist(data=w_9_2010$DURATION%>% unlist() %>% as.numeric(), "gamma", method="mle", optim.method="Nelder-Mead", weights = round(w_9_2010$WGHT_EPI))

fit_dgamma_w910 <- data.frame(f = dgamma(w_9_2010$DURATION, shape = gamma_w9_2010_$estimate[1], rate = gamma_w9_2010_$estimate[2]), x = w_9_2010$DURATION, type = "Gamma")

summary(gamma_w9_2010_)

plot(x= fit_dgamma_w910$x, y=fit_dgamma_w910$f)

#Calculating exponential distribution
exp_w9_2010_ <- fitdistrplus::fitdist(data=w_9_2010$DURATION%>% unlist() %>% as.numeric(), "exp", method="mle", optim.method="Nelder-Mead", weights = round(w_9_2010$WGHT_EPI))

summary(exp_w9_2010_)

fit_dexp_w910 <- data.frame(f = dexp(w_9_2010$DURATION, rate = exp_w9_2010_$estimate[1]), 
                       x = w_9_2010$DURATION, type = "exp")

plot(x = fit_dexp_w910$x, y = fit_dexp_w910$f)

#Calculating normal distribution
norm_w9_2010_ <- fitdistrplus::fitdist(data=w_9_2010$DURATION%>% unlist() %>% as.numeric(), "norm", method="mle", optim.method="Nelder-Mead", weights = round(w_9_2010$WGHT_EPI))

summary(norm_w9_2010_)

fit_dnorm_w910 <- data.frame(f = dnorm(w_9_2010$DURATION, mean = norm_w9_2010_$estimate[1], sd = norm_w9_2010_$estimate[2]), 
                       x = w_9_2010$DURATION, type = "norm")

plot(x = fit_dnorm_w910$x, y = fit_dnorm_w910$f)

#Calculating logistic distribution
logis_w9_2010_ <- fitdistrplus::fitdist(data=w_9_2010$DURATION%>% unlist() %>% as.numeric(), "logis", method="mle", optim.method="Nelder-Mead", weights = round(w_9_2010$WGHT_EPI))

summary(logis_w9_2010_)

fit_dlogis_w910 <- data.frame(f = dlogis(w_9_2010$DURATION, location = logis_w9_2010_$estimate[1], scale = logis_w9_2010_$estimate[2]), 
                       x = w_9_2010$DURATION, type = "logis")

plot(x = fit_dlogis_w910$x, y = fit_dlogis_w910$f)


```

Now let's compare these models AIC and BIC to see which fits the walk data best:

```{r}
#comparing these models AIC and BIC to see which fits the walk data best:
broom::glance(MASS::fitdistr(w_9_2010$DURATION%>% unlist() %>% as.numeric(),"gamma"))
broom::glance(MASS::fitdistr(w_9_2010$DURATION%>% unlist() %>% as.numeric(),"exponential"))
broom::glance(MASS::fitdistr(w_9_2010$DURATION%>% unlist() %>% as.numeric(),"normal"))
broom::glance(MASS::fitdistr(w_9_2010$DURATION%>% unlist() %>% as.numeric(),"logistic"))
```

So, exponential has largest logLik and the smallest AIC and BIC. we will pick exponential function for walking trips in 2010!

```{r}
walking_910_exp <- exp_w9_2010_
w_9_2010 <- w_9_2010 %>%
 mutate(f_9 = dexp(DURATION, walking_910_exp$estimate["rate"])) 
summary(w_9_2010$f_9)
```


###Destination :Library (10)

using a skew vs. kurtois graph to descriptive statistics of data

```{r creating Cullen and Frey graph for walkig 2010}
# creating a skew vs. kurtois graph for walking 2010

# Filter the data based on the "destination" column
 w_10_2010 <- walking_2010 %>%
  filter(destination == "10")   
descdist(w_10_2010$DURATION %>% unlist() %>% as.numeric(), discrete=FALSE, boot=500)
```

As shown in the Cullen and Frey graph, we see that gamma,weibull, normal and exponential will likely be the best fit according to the graph above. Then we compare these models to find the best model.

```{r}
# Based on the skew vs. kurtois graph the best distribution

#Calculating gamma distribution 
gamma_w10_2010_ <- fitdistrplus::fitdist(data=w_10_2010$DURATION%>% unlist() %>% as.numeric(), "gamma", method="mle", optim.method="Nelder-Mead", weights = round(w_10_2010$WGHT_EPI))

fit_dgamma_w1010 <- data.frame(f = dgamma(w_10_2010$DURATION, shape = gamma_w10_2010_$estimate[1], rate = gamma_w10_2010_$estimate[2]), x = w_10_2010$DURATION, type = "Gamma")

summary(gamma_w10_2010_)

plot(x= fit_dgamma_w1010$x, y=fit_dgamma_w1010$f)

#Calculating weibull distribution
weibull_w10_2010_ <- fitdistrplus::fitdist(data=w_10_2010$DURATION%>% unlist() %>% as.numeric(), "weibull", method="mle", optim.method="Nelder-Mead", weights = round(w_10_2010$WGHT_EPI))

summary(weibull_w10_2010_)

fit_dweibull_w1010 <- data.frame(f = dweibull(w_10_2010$DURATION, shape = weibull_w10_2010_$estimate[1], scale = weibull_w10_2010_$estimate[2]), x = w_10_2010$DURATION, type = "weibull")

plot(x= fit_dweibull_w1010$x, y=fit_dweibull_w1010$f)

#Calculating exponential distribution
exp_w10_2010_ <- fitdistrplus::fitdist(data=w_10_2010$DURATION%>% unlist() %>% as.numeric(), "exp", method="mle", optim.method="Nelder-Mead", weights = round(w_10_2010$WGHT_EPI))

summary(exp_w10_2010_)

fit_dexp_w1010 <- data.frame(f = dexp(w_10_2010$DURATION, rate = exp_w10_2010_$estimate[1]), 
                       x = w_10_2010$DURATION, type = "exp")

plot(x = fit_dexp_w1010$x, y = fit_dexp_w1010$f)

#Calculating normal distribution
norm_w10_2010_ <- fitdistrplus::fitdist(data=w_10_2010$DURATION%>% unlist() %>% as.numeric(), "norm", method="mle", optim.method="Nelder-Mead", weights = round(w_10_2010$WGHT_EPI))

summary(norm_w10_2010_)

fit_dnorm_w1010 <- data.frame(f = dnorm(w_10_2010$DURATION, mean = norm_w10_2010_$estimate[1], sd = norm_w10_2010_$estimate[2]), 
                       x = w_10_2010$DURATION, type = "norm")

plot(x = fit_dnorm_w1010$x, y = fit_dnorm_w1010$f)

```

Now let's compare these models AIC and BIC to see which fits the walk data best:

```{r}
#comparing these models AIC and BIC to see which fits the walk data best:
broom::glance(MASS::fitdistr(w_10_2010$DURATION%>% unlist() %>% as.numeric(),"gamma"))
broom::glance(MASS::fitdistr(w_10_2010$DURATION%>% unlist() %>% as.numeric(),"weibull"))
broom::glance(MASS::fitdistr(w_10_2010$DURATION%>% unlist() %>% as.numeric(),"exponential"))
broom::glance(MASS::fitdistr(w_10_2010$DURATION%>% unlist() %>% as.numeric(),"normal"))
```

So, gamma has largest logLik and the smallest AIC and BIC. we will pick gamma function for walking trips in 2010!

```{r}
walking_1010_gamma <- gamma_w10_2010_
w_10_2010 <- w_10_2010 %>%
 mutate(f_10 = dgamma(DURATION, walking_1010_gamma$estimate["shape"], walking_1010_gamma$estimate["rate"])) 
summary(w_10_2010$f_10)
```




### Calculating impedance function for walking in 2005

using a skew vs. kurtois graph to descriptive statistics of data:

```{r creating Cullen and Frey graph for walkig 2005}
# creating a skew vs. kurtois graph for walking 2005

descdist(walking_2005$DURATION %>% unlist() %>% as.numeric(), discrete=FALSE, boot=500)
```

As shown in the Cullen and Frey graph, we see that Weibull, gamma, exponential and lognormal will likely be the best fit according to the graph above. Then we compare these models to find the best model.

```{r}

# The Duration column contains four zero values. Before proceeding to calculate the gamma, weibull and lognormal distribution, a preprocessing step was undertaken, converting these zero values to the value of five.

# Calculating zero values
zero_count <- sum(walking_2005$DURATION == 0)
cat("Number of 0 values in DURATION column:", zero_count)

# change 0 value to 5
walking_2005$DURATION[walking_2005$DURATION == 0] <- 5

# Based on the skew vs. kurtois graph the best distribution

#Calculating gamma distribution

gamma_w_2005_ <- fitdistrplus::fitdist(data=walking_2005$DURATION%>% unlist() %>% as.numeric(), "gamma", method="mle", optim.method="Nelder-Mead", weights = round(walking_2005$WGHT_EPI))

fit_dgamma <- data.frame(f = dgamma(walking_2005$DURATION, shape = gamma_w_2005_$estimate[1], rate = gamma_w_2005_$estimate[2]), x = walking_2005$DURATION, type = "Gamma")

summary(gamma_w_2005_)

plot(x= fit_dgamma$x, y=fit_dgamma$f)

#Calculating weibull distribution
weibull_w_2005_ <- fitdistrplus::fitdist(data=walking_2005$DURATION%>% unlist() %>% as.numeric(), "weibull", method="mle", optim.method="Nelder-Mead", weights = round(walking_2005$WGHT_EPI))

summary(weibull_w_2005_)

fit_dweibull <- data.frame(f = dweibull(walking_2005$DURATION, shape = weibull_w_2005_$estimate[1], scale = weibull_w_2005_$estimate[2]), x = walking_2005$DURATION, type = "weibull")

plot(x= fit_dweibull$x, y=fit_dweibull$f)


#Calculating lognormal distribution
lnorm_w_2005_ <- fitdistrplus::fitdist(data=walking_2005$DURATION%>% unlist() %>% as.numeric(), "lnorm", method="mle", optim.method="Nelder-Mead", weights = round(walking_2005$WGHT_EPI))

summary(lnorm_w_2005_)

fit_dlnorm <- data.frame(f = dlnorm(walking_2005$DURATION, meanlog = lnorm_w_2005_$estimate[1], sdlog = lnorm_w_2005_$estimate[2]), x = walking_2005$DURATION, type = "lnorm")

plot(x= fit_dlnorm$x, y=fit_dlnorm$f)

#Calculating exponential distribution
exp_w_2005_ <- fitdistrplus::fitdist(data=walking_2005$DURATION%>% unlist() %>% as.numeric(), "exp", method="mle", optim.method="Nelder-Mead", weights = round(walking_2005$WGHT_EPI))

summary(exp_w_2005_)

# Get the estimated rate parameter from the fitted distribution
rate_estimate <- exp_w_2005_$estimate[1]

# Create a data frame for the fitted exponential distribution
fit_dexp <- data.frame(f = dexp(walking_2005$DURATION, rate = rate_estimate), 
                       x = walking_2005$DURATION, type = "exp")

# Plot the fitted exponential distribution
plot(x = fit_dexp$x, y = fit_dexp$f)


```

Now let's compare these models based on AIC and BIC to see which fits the walk data best:

```{r}
#comparing these models AIC and BIC to see which fits the walk data best:
broom::glance(MASS::fitdistr(walking_2005$DURATION%>% unlist() %>% as.numeric(),"gamma"))
broom::glance(MASS::fitdistr(walking_2005$DURATION%>% unlist() %>% as.numeric(),"weibull"))
broom::glance(MASS::fitdistr(walking_2005$DURATION%>% unlist() %>% as.numeric(),"lognormal"))
broom::glance(MASS::fitdistr(walking_2005$DURATION%>% unlist() %>% as.numeric(),"exponential"))
```

So, lognormal has largest logLik and the smallest AIC and BIC. we will pick lognormal function for walking trips in 2005!

```{r}
walking_2005_lnorm <- lnorm_w_2005_
walking_2005 <- walking_2005 %>%
 mutate(f = dlnorm(DURATION, walking_2005_lnorm$estimate["meanlog"], walking_2005_lnorm$estimate["sdlog"])) 
summary(walking_2005$f)

```

###Destination :Home (1)

using a skew vs. kurtois graph to descriptive statistics of data

```{r creating Cullen and Frey graph for walkig 2005}
# creating a skew vs. kurtois graph for walking 2005

# Filter the data based on the "destination" column
 w_1_2005 <- walking_2005 %>%
  filter(destination == "1")   
descdist(w_1_2005$DURATION %>% unlist() %>% as.numeric(), discrete=FALSE, boot=500)
```

As shown in the Cullen and Frey graph, we see that gamma,weibull, lognormal and exponential will likely be the best fit according to the graph above. Then we compare these models to find the best model.

```{r}
# Based on the skew vs. kurtois graph the best distribution

#Calculating gamma distribution 
gamma_w1_2005_ <- fitdistrplus::fitdist(data=w_1_2005$DURATION%>% unlist() %>% as.numeric(), "gamma", method="mle", optim.method="Nelder-Mead", weights = round(w_1_2005$WGHT_EPI))

fit_dgamma_w105 <- data.frame(f = dgamma(w_1_2005$DURATION, shape = gamma_w1_2005_$estimate[1], rate = gamma_w1_2005_$estimate[2]), x = w_1_2005$DURATION, type = "Gamma")

summary(gamma_w1_2005_)

plot(x= fit_dgamma_w105$x, y=fit_dgamma_w105$f)

#Calculating weibull distribution
weibull_w1_2005_ <- fitdistrplus::fitdist(data=w_1_2005$DURATION%>% unlist() %>% as.numeric(), "weibull", method="mle", optim.method="Nelder-Mead", weights = round(w_1_2005$WGHT_EPI))

summary(weibull_w1_2005_)

fit_dweibull_w105 <- data.frame(f = dweibull(w_1_2005$DURATION, shape = weibull_w1_2005_$estimate[1], scale = weibull_w1_2005_$estimate[2]), x = w_1_2005$DURATION, type = "weibull")

plot(x= fit_dweibull_w105$x, y=fit_dweibull_w105$f)

#Calculating exponential distribution
exp_w1_2005_ <- fitdistrplus::fitdist(data=w_1_2005$DURATION%>% unlist() %>% as.numeric(), "exp", method="mle", optim.method="Nelder-Mead", weights = round(w_1_2005$WGHT_EPI))

summary(exp_w1_2005_)

fit_dexp_w105 <- data.frame(f = dexp(w_1_2005$DURATION, rate = exp_w1_2005_$estimate[1]), 
                       x = w_1_2005$DURATION, type = "exp")

plot(x = fit_dexp_w105$x, y = fit_dexp_w105$f)

#Calculating lognormal distribution
lnorm_w1_2005_ <- fitdistrplus::fitdist(data=w_1_2005$DURATION%>% unlist() %>% as.numeric(), "lnorm", method="mle", optim.method="Nelder-Mead", weights = round(w_1_2005$WGHT_EPI))

summary(lnorm_w1_2005_)

fit_dlnorm_w105 <- data.frame(f = dlnorm(w_1_2005$DURATION, meanlog = lnorm_w1_2005_$estimate[1], sdlog = lnorm_w1_2005_$estimate[2]),  x = w_1_2005$DURATION, type = "lnorm")

plot(x = fit_dlnorm_w105$x, y = fit_dlnorm_w105$f)

```

Now let's compare these models AIC and BIC to see which fits the walk data best:

```{r}
#comparing these models AIC and BIC to see which fits the walk data best:
broom::glance(MASS::fitdistr(w_1_2005$DURATION%>% unlist() %>% as.numeric(),"gamma"))
broom::glance(MASS::fitdistr(w_1_2005$DURATION%>% unlist() %>% as.numeric(),"weibull"))
broom::glance(MASS::fitdistr(w_1_2005$DURATION%>% unlist() %>% as.numeric(),"exponential"))
broom::glance(MASS::fitdistr(w_1_2005$DURATION%>% unlist() %>% as.numeric(),"lognormal"))
```

So, lognormal has largest logLik and the smallest AIC and BIC. we will pick lognormal function for walking trips in 2010!

```{r}
walking_105_lnorm <- lnorm_w1_2005_
w_1_2005 <- w_1_2005 %>%
 mutate(f_1 = dlnorm(DURATION, walking_105_lnorm$estimate["meanlog"], walking_105_lnorm$estimate["sdlog"])) 
summary(w_1_2005$f_1)
```


###Destination : Work or school (2 and 8)

using a skew vs. kurtois graph to descriptive statistics of data

```{r creating Cullen and Frey graph for walkig 2005}
# creating a skew vs. kurtois graph for walking 2005

# Filter the data based on the "destination" column
 w_2_2005 <- walking_2005 %>%
  filter(destination %in% c("2", "8"))   
descdist(w_2_2005$DURATION %>% unlist() %>% as.numeric(), discrete=FALSE, boot=500)
```

As shown in the Cullen and Frey graph, we see that gamma,weibull, lognormal and exponential will likely be the best fit according to the graph above. Then we compare these models to find the best model.

```{r}
# Based on the skew vs. kurtois graph the best distribution

#Calculating gamma distribution 
gamma_w2_2005_ <- fitdistrplus::fitdist(data=w_2_2005$DURATION%>% unlist() %>% as.numeric(), "gamma", method="mle", optim.method="Nelder-Mead", weights = round(w_2_2005$WGHT_EPI))

fit_dgamma_w205 <- data.frame(f = dgamma(w_2_2005$DURATION, shape = gamma_w2_2005_$estimate[1], rate = gamma_w2_2005_$estimate[2]), x = w_2_2005$DURATION, type = "Gamma")

summary(gamma_w2_2005_)

plot(x= fit_dgamma_w205$x, y=fit_dgamma_w205$f)

#Calculating weibull distribution
weibull_w2_2005_ <- fitdistrplus::fitdist(data=w_2_2005$DURATION%>% unlist() %>% as.numeric(), "weibull", method="mle", optim.method="Nelder-Mead", weights = round(w_2_2005$WGHT_EPI))

summary(weibull_w2_2005_)

fit_dweibull_w205 <- data.frame(f = dweibull(w_2_2005$DURATION, shape = weibull_w2_2005_$estimate[1], scale = weibull_w2_2005_$estimate[2]), x = w_2_2005$DURATION, type = "weibull")

plot(x= fit_dweibull_w205$x, y=fit_dweibull_w205$f)

#Calculating exponential distribution
exp_w2_2005_ <- fitdistrplus::fitdist(data=w_2_2005$DURATION%>% unlist() %>% as.numeric(), "exp", method="mle", optim.method="Nelder-Mead", weights = round(w_2_2005$WGHT_EPI))

summary(exp_w2_2005_)

fit_dexp_w205 <- data.frame(f = dexp(w_2_2005$DURATION, rate = exp_w2_2005_$estimate[1]), 
                       x = w_2_2005$DURATION, type = "exp")

plot(x = fit_dexp_w205$x, y = fit_dexp_w205$f)

#Calculating lognormal distribution
lnorm_w2_2005_ <- fitdistrplus::fitdist(data=w_2_2005$DURATION%>% unlist() %>% as.numeric(), "lnorm", method="mle", optim.method="Nelder-Mead", weights = round(w_2_2005$WGHT_EPI))

summary(lnorm_w2_2005_)

fit_dlnorm_w205 <- data.frame(f = dlnorm(w_2_2005$DURATION, meanlog = lnorm_w2_2005_$estimate[1], sdlog = lnorm_w2_2005_$estimate[2]),  x = w_2_2005$DURATION, type = "lnorm")

plot(x = fit_dlnorm_w205$x, y = fit_dlnorm_w205$f)

```

Now let's compare these models AIC and BIC to see which fits the walk data best:

```{r}
#comparing these models AIC and BIC to see which fits the walk data best:
broom::glance(MASS::fitdistr(w_2_2005$DURATION%>% unlist() %>% as.numeric(),"gamma"))
broom::glance(MASS::fitdistr(w_2_2005$DURATION%>% unlist() %>% as.numeric(),"weibull"))
broom::glance(MASS::fitdistr(w_2_2005$DURATION%>% unlist() %>% as.numeric(),"exponential"))
broom::glance(MASS::fitdistr(w_2_2005$DURATION%>% unlist() %>% as.numeric(),"lognormal"))
```

So, lognormal has largest logLik and the smallest AIC and BIC. we will pick lognormal function for walking trips in 2005!

```{r}
walking_205_lnorm <- lnorm_w2_2005_
w_2_2005 <- w_2_2005 %>%
 mutate(f_2 = dlnorm(DURATION, walking_205_lnorm$estimate["meanlog"], walking_205_lnorm$estimate["sdlog"])) 
summary(w_2_2005$f_2)
```


###Destination : other's home (3)

using a skew vs. kurtois graph to descriptive statistics of data

```{r creating Cullen and Frey graph for walkig 2005}
# creating a skew vs. kurtois graph for walking 2005

# Filter the data based on the "destination" column
 w_3_2005 <- walking_2005 %>%
  filter(destination == "3")   
descdist(w_3_2005$DURATION %>% unlist() %>% as.numeric(), discrete=FALSE, boot=500)
```

As shown in the Cullen and Frey graph, we see that gamma and exponential will likely be the best fit according to the graph above. Then we compare these models to find the best model.

```{r}
# Based on the skew vs. kurtois graph the best distribution

#Calculating gamma distribution 
gamma_w3_2005_ <- fitdistrplus::fitdist(data=w_3_2005$DURATION%>% unlist() %>% as.numeric(), "gamma", method="mle", optim.method="Nelder-Mead", weights = round(w_3_2005$WGHT_EPI))

fit_dgamma_w305 <- data.frame(f = dgamma(w_3_2005$DURATION, shape = gamma_w3_2005_$estimate[1], rate = gamma_w3_2005_$estimate[2]), x = w_3_2005$DURATION, type = "Gamma")

summary(gamma_w3_2005_)

plot(x= fit_dgamma_w305$x, y=fit_dgamma_w305$f)

#Calculating exponential distribution
exp_w3_2005_ <- fitdistrplus::fitdist(data=w_3_2005$DURATION%>% unlist() %>% as.numeric(), "exp", method="mle", optim.method="Nelder-Mead", weights = round(w_3_2005$WGHT_EPI))

summary(exp_w3_2005_)

fit_dexp_w305 <- data.frame(f = dexp(w_3_2005$DURATION, rate = exp_w3_2005_$estimate[1]), 
                       x = w_3_2005$DURATION, type = "exp")

plot(x = fit_dexp_w305$x, y = fit_dexp_w305$f)

```

Now let's compare these models AIC and BIC to see which fits the walk data best:

```{r}
#comparing these models AIC and BIC to see which fits the walk data best:
broom::glance(MASS::fitdistr(w_3_2005$DURATION%>% unlist() %>% as.numeric(),"gamma"))
broom::glance(MASS::fitdistr(w_3_2005$DURATION%>% unlist() %>% as.numeric(),"exponential"))
```

So, gamma has largest logLik and the smallest AIC and BIC. we will pick gamma function for walking trips in 2005!

```{r}
walking_305_gamma <- gamma_w3_2005_
w_3_2005 <- w_3_2005 %>%
 mutate(f_3 = dgamma(DURATION, walking_305_gamma$estimate["shape"], walking_305_gamma$estimate["rate"])) 
summary(w_3_2005$f_3)
```

###Destination : Restaurant/bar (4)

using a skew vs. kurtois graph to descriptive statistics of data

```{r creating Cullen and Frey graph for walkig 2005}
# creating a skew vs. kurtois graph for walking 2005

# Filter the data based on the "destination" column
 w_4_2005 <- walking_2005 %>%
  filter(destination == "4")   
descdist(w_4_2005$DURATION %>% unlist() %>% as.numeric(), discrete=FALSE, boot=500)
```

As shown in the Cullen and Frey graph, we see that gamma,weibull, lognormal and exponential will likely be the best fit according to the graph above. Then we compare these models to find the best model.

```{r}
# Based on the skew vs. kurtois graph the best distribution

#Calculating gamma distribution 
gamma_w4_2005_ <- fitdistrplus::fitdist(data=w_4_2005$DURATION%>% unlist() %>% as.numeric(), "gamma", method="mle", optim.method="Nelder-Mead", weights = round(w_4_2005$WGHT_EPI))

fit_dgamma_w405 <- data.frame(f = dgamma(w_4_2005$DURATION, shape = gamma_w4_2005_$estimate[1], rate = gamma_w4_2005_$estimate[2]), x = w_4_2005$DURATION, type = "Gamma")

summary(gamma_w4_2005_)

plot(x= fit_dgamma_w405$x, y=fit_dgamma_w405$f)

#Calculating weibull distribution
weibull_w4_2005_ <- fitdistrplus::fitdist(data=w_4_2005$DURATION%>% unlist() %>% as.numeric(), "weibull", method="mle", optim.method="Nelder-Mead", weights = round(w_4_2005$WGHT_EPI))

summary(weibull_w4_2005_)

fit_dweibull_w405 <- data.frame(f = dweibull(w_4_2005$DURATION, shape = weibull_w4_2005_$estimate[1], scale = weibull_w4_2005_$estimate[2]), x = w_4_2005$DURATION, type = "weibull")

plot(x= fit_dweibull_w405$x, y=fit_dweibull_w405$f)

#Calculating exponential distribution
exp_w4_2005_ <- fitdistrplus::fitdist(data=w_4_2005$DURATION%>% unlist() %>% as.numeric(), "exp", method="mle", optim.method="Nelder-Mead", weights = round(w_4_2005$WGHT_EPI))

summary(exp_w4_2005_)

fit_dexp_w405 <- data.frame(f = dexp(w_4_2005$DURATION, rate = exp_w4_2005_$estimate[1]), 
                       x = w_4_2005$DURATION, type = "exp")

plot(x = fit_dexp_w405$x, y = fit_dexp_w405$f)

#Calculating lognormal distribution
lnorm_w4_2005_ <- fitdistrplus::fitdist(data=w_4_2005$DURATION%>% unlist() %>% as.numeric(), "lnorm", method="mle", optim.method="Nelder-Mead", weights = round(w_4_2005$WGHT_EPI))

summary(lnorm_w4_2005_)

fit_dlnorm_w405 <- data.frame(f = dlnorm(w_4_2005$DURATION, meanlog = lnorm_w4_2005_$estimate[1], sdlog = lnorm_w4_2005_$estimate[2]),  x = w_4_2005$DURATION, type = "lnorm")

plot(x = fit_dlnorm_w405$x, y = fit_dlnorm_w405$f)

```

Now let's compare these models AIC and BIC to see which fits the walk data best:

```{r}
#comparing these models AIC and BIC to see which fits the walk data best:
broom::glance(MASS::fitdistr(w_4_2005$DURATION%>% unlist() %>% as.numeric(),"gamma"))
broom::glance(MASS::fitdistr(w_4_2005$DURATION%>% unlist() %>% as.numeric(),"weibull"))
broom::glance(MASS::fitdistr(w_4_2005$DURATION%>% unlist() %>% as.numeric(),"exponential"))
broom::glance(MASS::fitdistr(w_4_2005$DURATION%>% unlist() %>% as.numeric(),"lognormal"))
```

So, lognormal has largest logLik and the smallest AIC and BIC. we will pick lognormal function for walking trips in 2005!

```{r}
walking_405_lnorm <- lnorm_w4_2005_
w_4_2005 <- w_4_2005 %>%
 mutate(f_4 = dlnorm(DURATION, walking_405_lnorm$estimate["meanlog"], walking_405_lnorm$estimate["sdlog"])) 
summary(w_4_2005$f_4)
```

###Destination : Place of worship (5)

using a skew vs. kurtois graph to descriptive statistics of data

```{r creating Cullen and Frey graph for walkig 2005}
# creating a skew vs. kurtois graph for walking 2005

# Filter the data based on the "destination" column
 w_5_2005 <- walking_2005 %>%
  filter(destination == "5")   
descdist(w_5_2005$DURATION %>% unlist() %>% as.numeric(), discrete=FALSE, boot=500)
```

As shown in the Cullen and Frey graph, we see that gamma,weibull, lognormal and exponential will likely be the best fit according to the graph above. Then we compare these models to find the best model.

```{r}
# Based on the skew vs. kurtois graph the best distribution

#Calculating gamma distribution 
gamma_w5_2005_ <- fitdistrplus::fitdist(data=w_5_2005$DURATION%>% unlist() %>% as.numeric(), "gamma", method="mle", optim.method="Nelder-Mead", weights = round(w_5_2005$WGHT_EPI))

fit_dgamma_w505 <- data.frame(f = dgamma(w_5_2005$DURATION, shape = gamma_w5_2005_$estimate[1], rate = gamma_w5_2005_$estimate[2]), x = w_5_2005$DURATION, type = "Gamma")

summary(gamma_w5_2005_)

plot(x= fit_dgamma_w505$x, y=fit_dgamma_w505$f)


#Calculating exponential distribution
exp_w5_2005_ <- fitdistrplus::fitdist(data=w_5_2005$DURATION%>% unlist() %>% as.numeric(), "exp", method="mle", optim.method="Nelder-Mead", weights = round(w_5_2005$WGHT_EPI))

summary(exp_w5_2005_)

fit_dexp_w505 <- data.frame(f = dexp(w_5_2005$DURATION, rate = exp_w5_2005_$estimate[1]), 
                       x = w_5_2005$DURATION, type = "exp")

plot(x = fit_dexp_w505$x, y = fit_dexp_w505$f)

```

Now let's compare these models AIC and BIC to see which fits the walk data best:

```{r}
#comparing these models AIC and BIC to see which fits the walk data best:
broom::glance(MASS::fitdistr(w_5_2005$DURATION%>% unlist() %>% as.numeric(),"gamma"))
broom::glance(MASS::fitdistr(w_5_2005$DURATION%>% unlist() %>% as.numeric(),"exponential"))
```

So, gamma has largest logLik and the smallest AIC and BIC. we will pick gamma function for walking trips in 2005!

```{r}
walking_505_gamma <- gamma_w5_2005_
w_5_2005 <- w_5_2005 %>%
 mutate(f_5 = dgamma(DURATION, walking_505_gamma$estimate["shape"], walking_505_gamma$estimate["rate"])) 
summary(w_5_2005$f_5)
```


###Destination :Grocery store, other stores or mall (6 and 7)

using a skew vs. kurtois graph to descriptive statistics of data

```{r creating Cullen and Frey graph for walkig 2005}
# creating a skew vs. kurtois graph for walking 2005

# Filter the data based on the "destination" column
 w_6_2005 <- walking_2005 %>%
  filter(destination %in% c("6", "7"))   
descdist(w_6_2005$DURATION %>% unlist() %>% as.numeric(), discrete=FALSE, boot=500)
```

As shown in the Cullen and Frey graph, we see that gamma,weibull, lognormal and exponential will likely be the best fit according to the graph above. Then we compare these models to find the best model.

```{r}
# Based on the skew vs. kurtois graph the best distribution

#Calculating gamma distribution 
gamma_w6_2005_ <- fitdistrplus::fitdist(data=w_6_2005$DURATION%>% unlist() %>% as.numeric(), "gamma", method="mle", optim.method="Nelder-Mead", weights = round(w_6_2005$WGHT_EPI))

fit_dgamma_w605 <- data.frame(f = dgamma(w_6_2005$DURATION, shape = gamma_w6_2005_$estimate[1], rate = gamma_w6_2005_$estimate[2]), x = w_6_2005$DURATION, type = "Gamma")

summary(gamma_w6_2005_)

plot(x= fit_dgamma_w605$x, y=fit_dgamma_w605$f)

#Calculating weibull distribution
weibull_w6_2005_ <- fitdistrplus::fitdist(data=w_6_2005$DURATION%>% unlist() %>% as.numeric(), "weibull", method="mle", optim.method="Nelder-Mead", weights = round(w_6_2005$WGHT_EPI))

summary(weibull_w6_2005_)

fit_dweibull_w605 <- data.frame(f = dweibull(w_6_2005$DURATION, shape = weibull_w6_2005_$estimate[1], scale = weibull_w6_2005_$estimate[2]), x = w_6_2005$DURATION, type = "weibull")

plot(x= fit_dweibull_w605$x, y=fit_dweibull_w605$f)

#Calculating exponential distribution
exp_w6_2005_ <- fitdistrplus::fitdist(data=w_6_2005$DURATION%>% unlist() %>% as.numeric(), "exp", method="mle", optim.method="Nelder-Mead", weights = round(w_6_2005$WGHT_EPI))

summary(exp_w6_2005_)

fit_dexp_w605 <- data.frame(f = dexp(w_6_2005$DURATION, rate = exp_w6_2005_$estimate[1]), 
                       x = w_6_2005$DURATION, type = "exp")

plot(x = fit_dexp_w605$x, y = fit_dexp_w605$f)

```

Now let's compare these models AIC and BIC to see which fits the walk data best:

```{r}
#comparing these models AIC and BIC to see which fits the walk data best:
broom::glance(MASS::fitdistr(w_6_2005$DURATION%>% unlist() %>% as.numeric(),"gamma"))
broom::glance(MASS::fitdistr(w_6_2005$DURATION%>% unlist() %>% as.numeric(),"weibull"))
broom::glance(MASS::fitdistr(w_6_2005$DURATION%>% unlist() %>% as.numeric(),"exponential"))
```

So, gamma has largest logLik and the smallest AIC and BIC. we will pick gamma function for walking trips in 2005!

```{r}
walking_605_gamma <- gamma_w6_2005_
w_6_2005 <- w_6_2005 %>%
 mutate(f_6 = dgamma(DURATION, walking_605_gamma$estimate["shape"], walking_605_gamma$estimate["rate"])) 
summary(w_6_2005$f_6)
```

###Destination : Outdoors (9)

using a skew vs. kurtois graph to descriptive statistics of data

```{r creating Cullen and Frey graph for walkig 2005}
# creating a skew vs. kurtois graph for walking 2005

# Filter the data based on the "destination" column
 w_9_2005 <- walking_2005 %>%
  filter(destination == "9")   
descdist(w_9_2005$DURATION %>% unlist() %>% as.numeric(), discrete=FALSE, boot=500)
```

As shown in the Cullen and Frey graph, we see that gamma,normal and exponential will likely be the best fit according to the graph above. Then we compare these models to find the best model.

```{r}
# Based on the skew vs. kurtois graph the best distribution

#Calculating gamma distribution 
gamma_w9_2005_ <- fitdistrplus::fitdist(data=w_9_2005$DURATION%>% unlist() %>% as.numeric(), "gamma", method="mle", optim.method="Nelder-Mead", weights = round(w_9_2005$WGHT_EPI))

fit_dgamma_w905 <- data.frame(f = dgamma(w_9_2005$DURATION, shape = gamma_w9_2005_$estimate[1], rate = gamma_w9_2005_$estimate[2]), x = w_9_2005$DURATION, type = "Gamma")

summary(gamma_w9_2005_)

plot(x= fit_dgamma_w905$x, y=fit_dgamma_w905$f)

#Calculating exponential distribution
exp_w9_2005_ <- fitdistrplus::fitdist(data=w_9_2005$DURATION%>% unlist() %>% as.numeric(), "exp", method="mle", optim.method="Nelder-Mead", weights = round(w_9_2005$WGHT_EPI))

summary(exp_w9_2005_)

fit_dexp_w905 <- data.frame(f = dexp(w_9_2005$DURATION, rate = exp_w9_2005_$estimate[1]), 
                       x = w_9_2005$DURATION, type = "exp")

plot(x = fit_dexp_w905$x, y = fit_dexp_w905$f)

#Calculating normal distribution
norm_w9_2005_ <- fitdistrplus::fitdist(data=w_9_2005$DURATION%>% unlist() %>% as.numeric(), "norm", method="mle", optim.method="Nelder-Mead", weights = round(w_9_2005$WGHT_EPI))

summary(norm_w9_2005_)

fit_dnorm_w905 <- data.frame(f = dnorm(w_9_2005$DURATION, mean = norm_w9_2005_$estimate[1], sd = norm_w9_2005_$estimate[2]),  x = w_9_2005$DURATION, type = "norm")

plot(x = fit_dnorm_w905$x, y = fit_dnorm_w905$f)

```

Now let's compare these models AIC and BIC to see which fits the walk data best:

```{r}
#comparing these models AIC and BIC to see which fits the walk data best:
broom::glance(MASS::fitdistr(w_9_2005$DURATION%>% unlist() %>% as.numeric(),"gamma"))
broom::glance(MASS::fitdistr(w_9_2005$DURATION%>% unlist() %>% as.numeric(),"exponential"))
broom::glance(MASS::fitdistr(w_9_2005$DURATION%>% unlist() %>% as.numeric(),"normal"))
```

So, gamma has largest logLik and the smallest AIC and BIC. we will pick gamma function for walking trips in 2005!

```{r}
walking_905_gamma <- gamma_w9_2005_
w_9_2005 <- w_9_2005 %>%
 mutate(f_9 = dgamma(DURATION, walking_905_gamma$estimate["shape"], walking_905_gamma$estimate["rate"])) 
summary(w_9_2005$f_9)
```


###Destination : Outdoors (10)

using a skew vs. kurtois graph to descriptive statistics of data

```{r creating Cullen and Frey graph for walkig 2005}
# creating a skew vs. kurtois graph for walking 2005

# Filter the data based on the "destination" column
 w_10_2005 <- walking_2005 %>%
  filter(destination == "10")   
descdist(w_10_2005$DURATION %>% unlist() %>% as.numeric(), discrete=FALSE, boot=500)
```

As shown in the Cullen and Frey graph, we see that gamma,normal and exponential will likely be the best fit according to the graph above. Then we compare these models to find the best model.

```{r}
# Based on the skew vs. kurtois graph the best distribution

#Calculating gamma distribution 
gamma_w10_2005_ <- fitdistrplus::fitdist(data=w_10_2005$DURATION%>% unlist() %>% as.numeric(), "gamma", method="mle", optim.method="Nelder-Mead", weights = round(w_10_2005$WGHT_EPI))

fit_dgamma_w1005 <- data.frame(f = dgamma(w_10_2005$DURATION, shape = gamma_w10_2005_$estimate[1], rate = gamma_w10_2005_$estimate[2]), x = w_10_2005$DURATION, type = "Gamma")

summary(gamma_w10_2005_)

plot(x= fit_dgamma_w1005$x, y=fit_dgamma_w1005$f)

#Calculating exponential distribution
exp_w10_2005_ <- fitdistrplus::fitdist(data=w_10_2005$DURATION%>% unlist() %>% as.numeric(), "exp", method="mle", optim.method="Nelder-Mead", weights = round(w_10_2005$WGHT_EPI))

summary(exp_w10_2005_)

fit_dexp_w1005 <- data.frame(f = dexp(w_10_2005$DURATION, rate = exp_w10_2005_$estimate[1]), 
                       x = w_10_2005$DURATION, type = "exp")

plot(x = fit_dexp_w1005$x, y = fit_dexp_w1005$f)

#Calculating normal distribution
norm_w10_2005_ <- fitdistrplus::fitdist(data=w_10_2005$DURATION%>% unlist() %>% as.numeric(), "norm", method="mle", optim.method="Nelder-Mead", weights = round(w_10_2005$WGHT_EPI))

summary(norm_w10_2005_)

fit_dnorm_w1005 <- data.frame(f = dnorm(w_10_2005$DURATION, mean = norm_w10_2005_$estimate[1], sd = norm_w10_2005_$estimate[2]),  x = w_10_2005$DURATION, type = "norm")

plot(x = fit_dnorm_w1005$x, y = fit_dnorm_w1005$f)

```

Now let's compare these models AIC and BIC to see which fits the walk data best:

```{r}
#comparing these models AIC and BIC to see which fits the walk data best:
broom::glance(MASS::fitdistr(w_10_2005$DURATION%>% unlist() %>% as.numeric(),"gamma"))
broom::glance(MASS::fitdistr(w_10_2005$DURATION%>% unlist() %>% as.numeric(),"exponential"))
broom::glance(MASS::fitdistr(w_10_2005$DURATION%>% unlist() %>% as.numeric(),"normal"))
```

So, gamma has largest logLik and the smallest AIC and BIC. we will pick gamma function for walking trips in 2005!

```{r}
walking_1005_gamma <- gamma_w10_2005_
w_10_2005 <- w_10_2005 %>%
 mutate(f_10 = dgamma(DURATION, walking_1005_gamma$estimate["shape"], walking_1005_gamma$estimate["rate"])) 
summary(w_10_2005$f_10)
```


### Calculating impedance function for walking in 1998

using a skew vs. kurtois graph to descriptive statistics of data:

```{r creating Cullen and Frey graph for walkig 1998}
# creating a skew vs. kurtois graph for walking 1998

descdist(walking_1998$DURATION %>% unlist() %>% as.numeric(), discrete=FALSE, boot=500)
```

As shown in the Cullen and Frey graph, we see that Weibull, gamma and exponential will likely be the best fit according to the graph above. Then we compare these models to find the best model.

```{r}

# Based on the skew vs. kurtois graph the best distribution

#Calculating gamma distribution

gamma_w_1998_ <- fitdistrplus::fitdist(data=walking_1998$DURATION%>% unlist() %>% as.numeric(), "gamma", method="mle", optim.method="Nelder-Mead", weights = round(walking_1998$WGHT_EPI))

fit_dgamma <- data.frame(f = dgamma(walking_1998$DURATION, shape = gamma_w_1998_$estimate[1], rate = gamma_w_1998_$estimate[2]), x = walking_1998$DURATION, type = "Gamma")

summary(gamma_w_1998_)

plot(x= fit_dgamma$x, y=fit_dgamma$f)

#Calculating weibull distribution
weibull_w_1998_ <- fitdistrplus::fitdist(data=walking_1998$DURATION%>% unlist() %>% as.numeric(), "weibull", method="mle", optim.method="Nelder-Mead", weights = round(walking_1998$WGHT_EPI))

summary(weibull_w_1998_)

fit_dweibull <- data.frame(f = dweibull(walking_1998$DURATION, shape = weibull_w_1998_$estimate[1], scale = weibull_w_1998_$estimate[2]), x = walking_1998$DURATION, type = "weibull")

plot(x= fit_dweibull$x, y=fit_dweibull$f)

#Calculating exponential distribution
exp_w_1998_ <- fitdistrplus::fitdist(data=walking_1998$DURATION%>% unlist() %>% as.numeric(), "exp", method="mle", optim.method="Nelder-Mead", weights = round(walking_1998$WGHT_EPI))

summary(exp_w_2005_)

# Get the estimated rate parameter from the fitted distribution
rate_estimate <- exp_w_1998_$estimate[1]

# Create a data frame for the fitted exponential distribution
fit_dexp <- data.frame(f = dexp(walking_1998$DURATION, rate = rate_estimate), 
                       x = walking_1998$DURATION, type = "exp")

# Plot the fitted exponential distribution
plot(x = fit_dexp$x, y = fit_dexp$f)

```

Now let's compare these models based on AIC and BIC to see which fits the walk data best:

```{r}
#comparing these models AIC and BIC to see which fits the walk data best:
broom::glance(MASS::fitdistr(walking_1998$DURATION%>% unlist() %>% as.numeric(),"gamma"))
broom::glance(MASS::fitdistr(walking_1998$DURATION%>% unlist() %>% as.numeric(),"weibull"))
broom::glance(MASS::fitdistr(walking_1998$DURATION%>% unlist() %>% as.numeric(),"exponential"))
```

So, weibull has largest logLik and the smallest AIC and BIC. we will pick weibull function for walking trips in 1998!

```{r}
walking_1998_weibull <- weibull_w_1998_
walking_1998 <- walking_1998 %>%
 mutate(f = dweibull(DURATION, walking_1998_weibull$estimate["shape"], walking_1998_weibull$estimate["scale"])) 
summary(walking_1998$f)

```

### Destination : Home  (1)- 1998

using a skew vs. kurtois graph to descriptive statistics of data

```{r creating Cullen and Frey graph for walkig 1998}
# creating a skew vs. kurtois graph for walking 1998

# Filter the data based on the "destination" column
 w_1_1998 <- walking_1998 %>%
  filter(destination == "1")   
descdist(w_1_1998$DURATION %>% unlist() %>% as.numeric(), discrete=FALSE, boot=500)
```

As shown in the Cullen and Frey graph, we see that gamma and exponential will likely be the best fit according to the graph above. Then we compare these models to find the best model.

```{r}
# Based on the skew vs. kurtois graph the best distribution

#Calculating gamma distribution 
gamma_w1_1998_ <- fitdistrplus::fitdist(data=w_1_1998$DURATION%>% unlist() %>% as.numeric(), "gamma", method="mle", optim.method="Nelder-Mead", weights = round(w_1_1998$WGHT_EPI))

fit_dgamma_w198 <- data.frame(f = dgamma(w_1_1998$DURATION, shape = gamma_w1_1998_$estimate[1], rate = gamma_w1_1998_$estimate[2]), x = w_1_1998$DURATION, type = "Gamma")

summary(gamma_w1_1998_)

plot(x= fit_dgamma_w198$x, y=fit_dgamma_w198$f)

#Calculating exponential distribution
exp_w1_1998_ <- fitdistrplus::fitdist(data=w_1_1998$DURATION%>% unlist() %>% as.numeric(), "exp", method="mle", optim.method="Nelder-Mead", weights = round(w_1_1998$WGHT_EPI))

summary(exp_w1_1998_)

fit_dexp_w198 <- data.frame(f = dexp(w_1_1998$DURATION, rate = exp_w1_1998_$estimate[1]), 
                       x = w_1_1998$DURATION, type = "exp")

plot(x = fit_dexp_w198$x, y = fit_dexp_w198$f)

```

Now let's compare these models AIC and BIC to see which fits the walk data best:

```{r}
#comparing these models AIC and BIC to see which fits the walk data best:
broom::glance(MASS::fitdistr(w_1_1998$DURATION%>% unlist() %>% as.numeric(),"gamma"))
broom::glance(MASS::fitdistr(w_1_1998$DURATION%>% unlist() %>% as.numeric(),"exponential"))
```

So, gamma has largest logLik and the smallest AIC and BIC. we will pick gamma function for walking trips in 1998!

```{r}
walking_198_gamma <- gamma_w1_1998_
w_1_1998 <- w_1_1998 %>%
 mutate(f_1 = dgamma(DURATION, walking_198_gamma$estimate["shape"], walking_198_gamma$estimate["rate"])) 
summary(w_1_1998$f_1)
```


### Destination : Work place (2)- 1998

using a skew vs. kurtois graph to descriptive statistics of data

```{r creating Cullen and Frey graph for walkig 1998}
# creating a skew vs. kurtois graph for walking 1998

# Filter the data based on the "destination" column
 w_2_1998 <- walking_1998 %>%
  filter(destination == "2")   
descdist(w_2_1998$DURATION %>% unlist() %>% as.numeric(), discrete=FALSE, boot=500)
```

As shown in the Cullen and Frey graph, we see that gamma and exponential will likely be the best fit according to the graph above. Then we compare these models to find the best model.

```{r}
# Based on the skew vs. kurtois graph the best distribution

#Calculating gamma distribution 
gamma_w2_1998_ <- fitdistrplus::fitdist(data=w_2_1998$DURATION%>% unlist() %>% as.numeric(), "gamma", method="mle", optim.method="Nelder-Mead", weights = round(w_2_1998$WGHT_EPI))

fit_dgamma_w298 <- data.frame(f = dgamma(w_2_1998$DURATION, shape = gamma_w2_1998_$estimate[1], rate = gamma_w2_1998_$estimate[2]), x = w_2_1998$DURATION, type = "Gamma")

summary(gamma_w2_1998_)

plot(x= fit_dgamma_w298$x, y=fit_dgamma_w298$f)

#Calculating exponential distribution
exp_w2_1998_ <- fitdistrplus::fitdist(data=w_2_1998$DURATION%>% unlist() %>% as.numeric(), "exp", method="mle", optim.method="Nelder-Mead", weights = round(w_2_1998$WGHT_EPI))

summary(exp_w2_1998_)

fit_dexp_w298 <- data.frame(f = dexp(w_2_1998$DURATION, rate = exp_w2_1998_$estimate[1]), 
                       x = w_2_1998$DURATION, type = "exp")

plot(x = fit_dexp_w298$x, y = fit_dexp_w298$f)

```

Now let's compare these models AIC and BIC to see which fits the walk data best:

```{r}
#comparing these models AIC and BIC to see which fits the walk data best:
broom::glance(MASS::fitdistr(w_2_1998$DURATION%>% unlist() %>% as.numeric(),"gamma"))
broom::glance(MASS::fitdistr(w_2_1998$DURATION%>% unlist() %>% as.numeric(),"exponential"))
```

So, gamma has largest logLik and the smallest AIC and BIC. we will pick gamma function for walking trips in 1998!

```{r}
walking_298_gamma <- gamma_w2_1998_
w_2_1998 <- w_2_1998 %>%
 mutate(f_2 = dgamma(DURATION, walking_298_gamma$estimate["shape"], walking_298_gamma$estimate["rate"])) 
summary(w_2_1998$f_2)
```

### Destination : Other's Home (3)- 1998

using a skew vs. kurtois graph to descriptive statistics of data

```{r creating Cullen and Frey graph for walkig 1998}
# creating a skew vs. kurtois graph for walking 1998

# Filter the data based on the "destination" column
 w_3_1998 <- walking_1998 %>%
  filter(destination == "3")   
descdist(w_3_1998$DURATION %>% unlist() %>% as.numeric(), discrete=FALSE, boot=500)
```

As shown in the Cullen and Frey graph, we see that gamma and exponential will likely be the best fit according to the graph above. Then we compare these models to find the best model.

```{r}
# Based on the skew vs. kurtois graph the best distribution

#Calculating gamma distribution 
gamma_w3_1998_ <- fitdistrplus::fitdist(data=w_3_1998$DURATION%>% unlist() %>% as.numeric(), "gamma", method="mle", optim.method="Nelder-Mead", weights = round(w_3_1998$WGHT_EPI))

fit_dgamma_w398 <- data.frame(f = dgamma(w_3_1998$DURATION, shape = gamma_w3_1998_$estimate[1], rate = gamma_w3_1998_$estimate[2]), x = w_3_1998$DURATION, type = "Gamma")

summary(gamma_w3_1998_)

plot(x= fit_dgamma_w398$x, y=fit_dgamma_w398$f)

#Calculating exponential distribution
exp_w3_1998_ <- fitdistrplus::fitdist(data=w_3_1998$DURATION%>% unlist() %>% as.numeric(), "exp", method="mle", optim.method="Nelder-Mead", weights = round(w_3_1998$WGHT_EPI))

summary(exp_w3_1998_)

fit_dexp_w398 <- data.frame(f = dexp(w_3_1998$DURATION, rate = exp_w3_1998_$estimate[1]), 
                       x = w_3_1998$DURATION, type = "exp")

plot(x = fit_dexp_w398$x, y = fit_dexp_w398$f)

```

Now let's compare these models AIC and BIC to see which fits the walk data best:

```{r}
#comparing these models AIC and BIC to see which fits the walk data best:
broom::glance(MASS::fitdistr(w_3_1998$DURATION%>% unlist() %>% as.numeric(),"gamma"))
broom::glance(MASS::fitdistr(w_3_1998$DURATION%>% unlist() %>% as.numeric(),"exponential"))
```

So, gamma has largest logLik and the smallest AIC and BIC. we will pick gamma function for walking trips in 1998!

```{r}
walking_398_gamma <- gamma_w3_1998_
w_3_1998 <- w_3_1998 %>%
 mutate(f_3 = dgamma(DURATION, walking_398_gamma$estimate["shape"], walking_398_gamma$estimate["rate"])) 
summary(w_3_1998$f_3)
```

### Calculating impedance function for walking in 1992

using a skew vs. kurtois graph to descriptive statistics of data:

```{r creating Cullen and Frey graph for walkig 1992}
# creating a skew vs. kurtois graph for walking 1992

descdist(walking_1992$DURATION %>% unlist() %>% as.numeric(), discrete=FALSE, boot=500)
```

As shown in the Cullen and Frey graph, we see that Weibull, gamma and exponential will likely be the best fit according to the graph above. Then we compare these models to find the best model.

```{r}
summary(walking_1992$WGHT_EPI)

# Finding number of NA values in WGHT_EPI column
na_count <- sum(is.na(walking_1992$WGHT_EPI))
cat("Number of NA values in 'column_name':", na_count)

# There are 3 NA values in this column so I changed them to minimum value that equals to 128.6
walking_1992$WGHT_EPI[is.na(walking_1992$WGHT_EPI)] <- 128.6
```

```{r}

# Based on the skew vs. kurtois graph the best distribution

#Calculating gamma distribution

gamma_w_1992_ <- fitdistrplus::fitdist(data=walking_1992$DURATION%>% unlist() %>% as.numeric(), "gamma", method="mle", optim.method="Nelder-Mead", weights = round(walking_1992$WGHT_EPI))

fit_dgamma <- data.frame(f = dgamma(walking_1992$DURATION, shape = gamma_w_1992_$estimate[1], rate = gamma_w_1992_$estimate[2]), x = walking_1992$DURATION, type = "Gamma")

summary(gamma_w_1992_)

plot(x= fit_dgamma$x, y=fit_dgamma$f)

#Calculating weibull distribution
weibull_w_1992_ <- fitdistrplus::fitdist(data=walking_1992$DURATION%>% unlist() %>% as.numeric(), "weibull", method="mle", optim.method="Nelder-Mead", weights = round(walking_1992$WGHT_EPI))

summary(weibull_w_1992_)

fit_dweibull <- data.frame(f = dweibull(walking_1992$DURATION, shape = weibull_w_1992_$estimate[1], scale = weibull_w_1992_$estimate[2]), x = walking_1992$DURATION, type = "weibull")

plot(x= fit_dweibull$x, y=fit_dweibull$f)



#Calculating exponential distribution
exp_w_1992_ <- fitdistrplus::fitdist(data=walking_1992$DURATION%>% unlist() %>% as.numeric(), "exp", method="mle", optim.method="Nelder-Mead", weights = round(walking_1992$WGHT_EPI))

rate_estimate <- exp_w_1992_$estimate[1]

fit_dexp <- data.frame(f = dexp(walking_1992$DURATION, rate = rate_estimate), 
                       x = walking_1992$DURATION, type = "exp")

plot(x = fit_dexp$x, y = fit_dexp$f)


```

Now let's compare these models based on AIC and BIC to see which fits the walk data best:

```{r}
#comparing these models AIC and BIC to see which fits the walk data best:
broom::glance(MASS::fitdistr(walking_1992$DURATION%>% unlist() %>% as.numeric(),"gamma"))
broom::glance(MASS::fitdistr(walking_1992$DURATION%>% unlist() %>% as.numeric(),"weibull"))
broom::glance(MASS::fitdistr(walking_1992$DURATION%>% unlist() %>% as.numeric(),"exponential"))
```

So, gamma  has largest logLik and the smallest AIC and BIC. we will pick gamma function for walking trips in 1992!

```{r}
walking_1992_gamma <- gamma_w_1992_
walking_1992 <- walking_1992 %>%
 mutate(f = dgamma(DURATION, walking_1992_gamma$estimate["shape"], walking_1992_gamma$estimate["rate"])) 
summary(walking_1992$f)

```

### Destination : Home (1)- 1992

using a skew vs. kurtois graph to descriptive statistics of data

```{r creating Cullen and Frey graph for walkig 1992}
# creating a skew vs. kurtois graph for walking 1992

# Filter the data based on the "destination" column
 w_1_1992 <- walking_1992 %>%
  filter(destination == "1")   
descdist(w_1_1992$DURATION %>% unlist() %>% as.numeric(), discrete=FALSE, boot=500)
```

As shown in the Cullen and Frey graph, we see that gamma, weibull and exponential will likely be the best fit according to the graph above. Then we compare these models to find the best model.

```{r}
# Based on the skew vs. kurtois graph the best distribution

#Calculating gamma distribution 
gamma_w1_1992_ <- fitdistrplus::fitdist(data=w_1_1992$DURATION%>% unlist() %>% as.numeric(), "gamma", method="mle", optim.method="Nelder-Mead", weights = round(w_1_1992$WGHT_EPI))

fit_dgamma_w192 <- data.frame(f = dgamma(w_1_1992$DURATION, shape = gamma_w1_1992_$estimate[1], rate = gamma_w1_1992_$estimate[2]), x = w_1_1992$DURATION, type = "Gamma")

summary(gamma_w1_1992_)

plot(x= fit_dgamma_w192$x, y=fit_dgamma_w192$f)


#Calculating weibull distribution
 
weibull_w1_1992_ <- fitdistrplus::fitdist(data=w_1_1992$DURATION%>% unlist() %>% as.numeric(), "weibull", method="mle", optim.method="Nelder-Mead", weights = round(w_1_1992$WGHT_EPI))

fit_dweibull_w192 <- data.frame(f = dweibull(w_1_1992$DURATION, shape = weibull_w1_1992_$estimate[1], scale = weibull_w1_1992_$estimate[2]), x = w_1_1992$DURATION, type = "weibull")

summary(weibull_w1_1992_)

plot(x= fit_dweibull_w192$x, y=fit_dweibull_w192$f)

#Calculating exponential distribution
exp_w1_1992_ <- fitdistrplus::fitdist(data=w_1_1992$DURATION%>% unlist() %>% as.numeric(), "exp", method="mle", optim.method="Nelder-Mead", weights = round(w_1_1992$WGHT_EPI))

summary(exp_w1_1992_)

fit_dexp_w192 <- data.frame(f = dexp(w_1_1992$DURATION, rate = exp_w1_1992_$estimate[1]), 
                       x = w_1_1992$DURATION, type = "exp")

plot(x = fit_dexp_w192$x, y = fit_dexp_w192$f)

```

Now let's compare these models AIC and BIC to see which fits the walk data best:

```{r}
#comparing these models AIC and BIC to see which fits the walk data best:
broom::glance(MASS::fitdistr(w_1_1992$DURATION%>% unlist() %>% as.numeric(),"gamma"))
broom::glance(MASS::fitdistr(w_1_1992$DURATION%>% unlist() %>% as.numeric(),"weibull"))
broom::glance(MASS::fitdistr(w_1_1992$DURATION%>% unlist() %>% as.numeric(),"exponential"))
```

So, gamma has largest logLik and the smallest AIC and BIC. we will pick gamma function for walking trips in 1992!

```{r}
walking_192_gamma <- gamma_w1_1992_
w_1_1992 <- w_1_1992 %>%
 mutate(f_1 = dgamma(DURATION, walking_192_gamma$estimate["shape"], walking_192_gamma$estimate["rate"])) 
summary(w_1_1992$f_1)
```

### Destination : Workplace (2)- 1992

using a skew vs. kurtois graph to descriptive statistics of data

```{r creating Cullen and Frey graph for walkig 1992}
# creating a skew vs. kurtois graph for walking 1992

# Filter the data based on the "destination" column
 w_2_1992 <- walking_1992 %>%
  filter(destination == "2")   
descdist(w_2_1992$DURATION %>% unlist() %>% as.numeric(), discrete=FALSE, boot=500)
```

As shown in the Cullen and Frey graph, we see that gamma and exponential will likely be the best fit according to the graph above. Then we compare these models to find the best model.

```{r}
# Based on the skew vs. kurtois graph the best distribution

#Calculating gamma distribution 
gamma_w2_1992_ <- fitdistrplus::fitdist(data=w_2_1992$DURATION%>% unlist() %>% as.numeric(), "gamma", method="mle", optim.method="Nelder-Mead", weights = round(w_2_1992$WGHT_EPI))

fit_dgamma_w292 <- data.frame(f = dgamma(w_2_1992$DURATION, shape = gamma_w2_1992_$estimate[1], rate = gamma_w2_1992_$estimate[2]), x = w_2_1992$DURATION, type = "Gamma")

summary(gamma_w2_1992_)

plot(x= fit_dgamma_w292$x, y=fit_dgamma_w292$f)


#Calculating weibull distribution
 
weibull_w2_1992_ <- fitdistrplus::fitdist(data=w_2_1992$DURATION%>% unlist() %>% as.numeric(), "weibull", method="mle", optim.method="Nelder-Mead", weights = round(w_2_1992$WGHT_EPI))

fit_dweibull_w292 <- data.frame(f = dweibull(w_2_1992$DURATION, shape = weibull_w2_1992_$estimate[1], scale = weibull_w2_1992_$estimate[2]), x = w_2_1992$DURATION, type = "weibull")

summary(weibull_w2_1992_)

plot(x= fit_dweibull_w292$x, y=fit_dweibull_w292$f)

#Calculating exponential distribution
exp_w2_1992_ <- fitdistrplus::fitdist(data=w_2_1992$DURATION%>% unlist() %>% as.numeric(), "exp", method="mle", optim.method="Nelder-Mead", weights = round(w_2_1992$WGHT_EPI))

summary(exp_w2_1992_)

fit_dexp_w292 <- data.frame(f = dexp(w_2_1992$DURATION, rate = exp_w2_1992_$estimate[1]), 
                       x = w_2_1992$DURATION, type = "exp")

plot(x = fit_dexp_w292$x, y = fit_dexp_w292$f)

```

Now let's compare these models AIC and BIC to see which fits the walk data best:

```{r}
#comparing these models AIC and BIC to see which fits the walk data best:
broom::glance(MASS::fitdistr(w_2_1992$DURATION%>% unlist() %>% as.numeric(),"gamma"))
broom::glance(MASS::fitdistr(w_2_1992$DURATION%>% unlist() %>% as.numeric(),"weibull"))
broom::glance(MASS::fitdistr(w_2_1992$DURATION%>% unlist() %>% as.numeric(),"exponential"))
```

So, gamma has largest logLik and the smallest AIC and BIC. we will pick gamma function for walking trips in 1992!

```{r}
walking_292_gamma <- gamma_w2_1992_
w_2_1992 <- w_2_1992 %>%
 mutate(f_2 = dgamma(DURATION, walking_292_gamma$estimate["shape"], walking_292_gamma$estimate["rate"])) 
summary(w_2_1992$f_2)
```

### Destination : Other's Home (3)- 1992

using a skew vs. kurtois graph to descriptive statistics of data

```{r creating Cullen and Frey graph for walkig 1992}
# creating a skew vs. kurtois graph for walking 1992

# Filter the data based on the "destination" column
 w_3_1992 <- walking_1992 %>%
  filter(destination == "3")   
descdist(w_3_1992$DURATION %>% unlist() %>% as.numeric(), discrete=FALSE, boot=500)
```

As shown in the Cullen and Frey graph, we see that gamma, weibull and exponential will likely be the best fit according to the graph above. Then we compare these models to find the best model.

```{r}
# Based on the skew vs. kurtois graph the best distribution

#Calculating gamma distribution 
gamma_w3_1992_ <- fitdistrplus::fitdist(data=w_3_1992$DURATION%>% unlist() %>% as.numeric(), "gamma", method="mle", optim.method="Nelder-Mead", weights = round(w_3_1992$WGHT_EPI))

fit_dgamma_w392 <- data.frame(f = dgamma(w_3_1992$DURATION, shape = gamma_w3_1992_$estimate[1], rate = gamma_w3_1992_$estimate[2]), x = w_3_1992$DURATION, type = "Gamma")

summary(gamma_w3_1992_)

plot(x= fit_dgamma_w392$x, y=fit_dgamma_w392$f)


#Calculating weibull distribution
 
weibull_w3_1992_ <- fitdistrplus::fitdist(data=w_3_1992$DURATION%>% unlist() %>% as.numeric(), "weibull", method="mle", optim.method="Nelder-Mead", weights = round(w_3_1992$WGHT_EPI))

fit_dweibull_w392 <- data.frame(f = dweibull(w_3_1992$DURATION, shape = weibull_w3_1992_$estimate[1], scale = weibull_w3_1992_$estimate[2]), x = w_3_1992$DURATION, type = "weibull")

summary(weibull_w3_1992_)

plot(x= fit_dweibull_w392$x, y=fit_dweibull_w392$f)

#Calculating exponential distribution
exp_w3_1992_ <- fitdistrplus::fitdist(data=w_3_1992$DURATION%>% unlist() %>% as.numeric(), "exp", method="mle", optim.method="Nelder-Mead", weights = round(w_3_1992$WGHT_EPI))

summary(exp_w3_1992_)

fit_dexp_w392 <- data.frame(f = dexp(w_3_1992$DURATION, rate = exp_w3_1992_$estimate[1]), 
                       x = w_3_1992$DURATION, type = "exp")

plot(x = fit_dexp_w392$x, y = fit_dexp_w392$f)

```

Now let's compare these models AIC and BIC to see which fits the walk data best:

```{r}
#comparing these models AIC and BIC to see which fits the walk data best:
broom::glance(MASS::fitdistr(w_3_1992$DURATION%>% unlist() %>% as.numeric(),"gamma"))
broom::glance(MASS::fitdistr(w_3_1992$DURATION%>% unlist() %>% as.numeric(),"weibull"))
broom::glance(MASS::fitdistr(w_3_1992$DURATION%>% unlist() %>% as.numeric(),"exponential"))
```

So, gamma has largest logLik and the smallest AIC and BIC. we will pick gamma function for walking trips in 1992!

```{r}
walking_392_gamma <- gamma_w3_1992_
w_3_1992 <- w_3_1992 %>%
 mutate(f_3 = dgamma(DURATION, walking_392_gamma$estimate["shape"], walking_392_gamma$estimate["rate"])) 
summary(w_3_1992$f_3)
```


### Calculating impedance function for walking in 1986

using a skew vs. kurtois graph to descriptive statistics of data:

```{r creating Cullen and Frey graph for walkig 1986}
# creating a skew vs. kurtois graph for walking 1986

descdist(walking_1986$DURATION %>% unlist() %>% as.numeric(), discrete=FALSE, boot=500)
```

As shown in the Cullen and Frey graph, we see that Weibull, gamma and exponential will likely be the best fit according to the graph above. Then we compare these models to find the best model.


```{r}

# Based on the skew vs. kurtois graph the best distribution

#Calculating gamma distribution

gamma_w_1986_ <- fitdistrplus::fitdist(data=walking_1986$DURATION%>% unlist() %>% as.numeric(), "gamma", method="mle", optim.method="Nelder-Mead", weights = round(walking_1986$WGHT_EPI))

fit_dgamma <- data.frame(f = dgamma(walking_1986$DURATION, shape = gamma_w_1986_$estimate[1], rate = gamma_w_1986_$estimate[2]), x = walking_1986$DURATION, type = "Gamma")

summary(gamma_w_1986_)

plot(x= fit_dgamma$x, y=fit_dgamma$f)


#Calculating exponential distribution
exp_w_1986_ <- fitdistrplus::fitdist(data=walking_1986$DURATION%>% unlist() %>% as.numeric(), "exp", method="mle", optim.method="Nelder-Mead", weights = round(walking_1986$WGHT_EPI))


fit_dexp <- data.frame(f = dexp(walking_1986$DURATION, rate = exp_w_1986_$estimate[1]), 
                       x = walking_1986$DURATION, type = "exp")

plot(x = fit_dexp$x, y = fit_dexp$f)

```

Now let's compare these models based on AIC and BIC to see which fits the walk data best:

```{r}
#comparing these models AIC and BIC to see which fits the walk data best:
broom::glance(MASS::fitdistr(walking_1986$DURATION%>% unlist() %>% as.numeric(),"gamma"))
#broom::glance(MASS::fitdistr(walking_1986$DURATION%>% unlist() %>% as.numeric(),"beta"))
broom::glance(MASS::fitdistr(walking_1986$DURATION%>% unlist() %>% as.numeric(),"exponential"))
```

So, gamma has largest logLik and the smallest AIC and BIC. we will pick gamma function for walking trips in 1986!

```{r}
walking_1986_gamma <- gamma_w_1986_
walking_1986 <- walking_1986 %>%
 mutate(f = dgamma(DURATION, walking_1986_gamma$estimate["shape"], walking_1986_gamma$estimate["rate"])) 
summary(walking_1986$f)

```

### Destination : Home (1)- 1986

using a skew vs. kurtois graph to descriptive statistics of data

```{r creating Cullen and Frey graph for walkig 1986}
# creating a skew vs. kurtois graph for walking 1986

# Filter the data based on the "destination" column
 w_1_1986 <- walking_1986 %>%
  filter(destination == "1")   
descdist(w_1_1986$DURATION %>% unlist() %>% as.numeric(), discrete=FALSE, boot=500)
```

As shown in the Cullen and Frey graph, we see that gamma and exponential will likely be the best fit according to the graph above. Then we compare these models to find the best model.

```{r}
# Based on the skew vs. kurtois graph the best distribution

#Calculating gamma distribution 
gamma_w1_1986_ <- fitdistrplus::fitdist(data=w_1_1986$DURATION%>% unlist() %>% as.numeric(), "gamma", method="mle", optim.method="Nelder-Mead", weights = round(w_1_1986$WGHT_EPI))

fit_dgamma_w186 <- data.frame(f = dgamma(w_1_1986$DURATION, shape = gamma_w1_1986_$estimate[1], rate = gamma_w1_1986_$estimate[2]), x = w_1_1986$DURATION, type = "Gamma")

summary(gamma_w1_1986_)

plot(x= fit_dgamma_w186$x, y=fit_dgamma_w186$f)


#Calculating weibull distribution
 
weibull_w1_1986_ <- fitdistrplus::fitdist(data=w_1_1986$DURATION%>% unlist() %>% as.numeric(), "weibull", method="mle", optim.method="Nelder-Mead", weights = round(w_1_1986$WGHT_EPI))

fit_dweibull_w186 <- data.frame(f = dweibull(w_1_1986$DURATION, shape = weibull_w1_1986_$estimate[1], scale = weibull_w1_1986_$estimate[2]), x = w_1_1986$DURATION, type = "weibull")

summary(weibull_w1_1986_)

plot(x= fit_dweibull_w186$x, y=fit_dweibull_w186$f)

#Calculating exponential distribution
exp_w1_1986_ <- fitdistrplus::fitdist(data=w_1_1986$DURATION%>% unlist() %>% as.numeric(), "exp", method="mle", optim.method="Nelder-Mead", weights = round(w_1_1986$WGHT_EPI))

summary(exp_w1_1986_)

fit_dexp_w186 <- data.frame(f = dexp(w_1_1986$DURATION, rate = exp_w1_1986_$estimate[1]), 
                       x = w_1_1986$DURATION, type = "exp")

plot(x = fit_dexp_w186$x, y = fit_dexp_w186$f)

```

Now let's compare these models AIC and BIC to see which fits the walk data best:

```{r}
#comparing these models AIC and BIC to see which fits the walk data best:
broom::glance(MASS::fitdistr(w_1_1986$DURATION%>% unlist() %>% as.numeric(),"gamma"))
broom::glance(MASS::fitdistr(w_1_1986$DURATION%>% unlist() %>% as.numeric(),"weibull"))
broom::glance(MASS::fitdistr(w_1_1986$DURATION%>% unlist() %>% as.numeric(),"exponential"))
```

So, gamma has largest logLik and the smallest AIC and BIC. we will pick gamma function for walking trips in 1986!

```{r}
walking_186_gamma <- gamma_w1_1986_
w_1_1986 <- w_1_1986 %>%
 mutate(f_1 = dgamma(DURATION, walking_186_gamma$estimate["shape"], walking_186_gamma$estimate["rate"])) 
summary(w_1_1986$f_1)
```

### Destination : Workplace (2)- 1986

using a skew vs. kurtois graph to descriptive statistics of data

```{r creating Cullen and Frey graph for walkig 1986}
# creating a skew vs. kurtois graph for walking 1986

# Filter the data based on the "destination" column
 w_2_1986 <- walking_1986 %>%
  filter(destination == "2")   
descdist(w_2_1986$DURATION %>% unlist() %>% as.numeric(), discrete=FALSE, boot=500)
```

As shown in the Cullen and Frey graph, we see that gamma, normal,logistic  and exponential will likely be the best fit according to the graph above. Then we compare these models to find the best model.

```{r}
library(fitdistrplus)
# Based on the skew vs. kurtois graph the best distribution

#Calculating gamma distribution 
gamma_w2_1986_ <- fitdistrplus::fitdist(data=w_2_1986$DURATION%>% unlist() %>% as.numeric(), "gamma", method="mle", optim.method="Nelder-Mead", weights = round(w_2_1986$WGHT_EPI))

fit_dgamma_w286 <- data.frame(f = dgamma(w_2_1986$DURATION, shape = gamma_w2_1986_$estimate[1], rate = gamma_w2_1986_$estimate[2]), x = w_2_1986$DURATION, type = "Gamma")

summary(gamma_w2_1986_)

plot(x= fit_dgamma_w286$x, y=fit_dgamma_w286$f)


#Calculating weibull distribution
 
weibull_w2_1986_ <- fitdistrplus::fitdist(data=w_2_1986$DURATION%>% unlist() %>% as.numeric(), "weibull", method="mle", optim.method="Nelder-Mead", weights = round(w_2_1986$WGHT_EPI))

fit_dweibull_w286 <- data.frame(f = dweibull(w_2_1986$DURATION, shape = weibull_w2_1986_$estimate[1], scale = weibull_w2_1986_$estimate[2]), x = w_2_1986$DURATION, type = "weibull")

summary(weibull_w2_1986_)

plot(x= fit_dweibull_w286$x, y=fit_dweibull_w286$f)


#Calculating normal distribution
 
norm_w2_1986_ <- fitdistrplus::fitdist(data=w_2_1986$DURATION%>% unlist() %>% as.numeric(), "norm", method="mle", optim.method="Nelder-Mead", weights = round(w_2_1986$WGHT_EPI))

summary(norm_w2_1986_)

fit_dnorm_w286 <- data.frame(f = dnorm(w_2_1986$DURATION, mean = norm_w2_1986_$estimate[1], sd = norm_w2_1986_$estimate[2]), x = w_2_1986$DURATION, type = "norm")

plot(x= fit_dnorm_w286$x, y=fit_dnorm_w286$f)

#Calculating logistic distribution
 
logis_w2_1986_ <- fitdistrplus::fitdist(data=w_2_1986$DURATION%>% unlist() %>% as.numeric(), "logis", method="mle", optim.method="Nelder-Mead", weights = round(w_2_1986$WGHT_EPI))

summary(logis_w2_1986_)

fit_dlogis_w286 <- data.frame(f = dlogis(w_2_1986$DURATION, location = logis_w2_1986_$estimate[1], scale = logis_w2_1986_$estimate[2]), x = w_2_1986$DURATION, type = "logis")

plot(x= fit_dlogis_w286$x, y=fit_dlogis_w286$f)

#Calculating exponential distribution
exp_w2_1986_ <- fitdistrplus::fitdist(data=w_2_1986$DURATION%>% unlist() %>% as.numeric(), "exp", method="mle", optim.method="Nelder-Mead", weights = round(w_2_1986$WGHT_EPI))

summary(exp_w2_1986_)

fit_dexp_w286 <- data.frame(f = dexp(w_2_1986$DURATION, rate = exp_w2_1986_$estimate[1]), 
                       x = w_2_1986$DURATION, type = "exp")

plot(x = fit_dexp_w286$x, y = fit_dexp_w286$f)

```

Now let's compare these models AIC and BIC to see which fits the walk data best:

```{r}
#comparing these models AIC and BIC to see which fits the walk data best:
broom::glance(MASS::fitdistr(w_2_1986$DURATION%>% unlist() %>% as.numeric(),"gamma"))
broom::glance(MASS::fitdistr(w_2_1986$DURATION%>% unlist() %>% as.numeric(),"weibull"))
broom::glance(MASS::fitdistr(w_2_1986$DURATION%>% unlist() %>% as.numeric(),"normal"))
broom::glance(MASS::fitdistr(w_2_1986$DURATION%>% unlist() %>% as.numeric(),"logistic"))
broom::glance(MASS::fitdistr(w_2_1986$DURATION%>% unlist() %>% as.numeric(),"exponential"))
```

So, exponential has largest logLik and the smallest AIC and BIC. we will pick exponential function for walking trips in 1986!

```{r}
walking_286_exp <- exp_w2_1986_
w_2_1986 <- w_2_1986 %>%
 mutate(f_2 = dexp(DURATION, walking_286_exp$estimate["rate"])) 
summary(w_2_1986$f_2)
```


### Destination : Other's Home (3)- 1986

using a skew vs. kurtois graph to descriptive statistics of data

```{r creating Cullen and Frey graph for walkig 1986}
# creating a skew vs. kurtois graph for walking 1986

# Filter the data based on the "destination" column
 w_3_1986 <- walking_1986 %>%
  filter(destination == "3")   
descdist(w_3_1986$DURATION %>% unlist() %>% as.numeric(), discrete=FALSE, boot=500)
```

As shown in the Cullen and Frey graph, we see that gamma and exponential will likely be the best fit according to the graph above. Then we compare these models to find the best model.

```{r}
library(fitdistrplus)
# Based on the skew vs. kurtois graph the best distribution

#Calculating gamma distribution 
gamma_w3_1986_ <- fitdistrplus::fitdist(data=w_3_1986$DURATION%>% unlist() %>% as.numeric(), "gamma", method="mle", optim.method="Nelder-Mead", weights = round(w_3_1986$WGHT_EPI))

fit_dgamma_w386 <- data.frame(f = dgamma(w_3_1986$DURATION, shape = gamma_w3_1986_$estimate[1], rate = gamma_w3_1986_$estimate[2]), x = w_3_1986$DURATION, type = "Gamma")

summary(gamma_w3_1986_)

plot(x= fit_dgamma_w386$x, y=fit_dgamma_w386$f)



#Calculating exponential distribution
exp_w3_1986_ <- fitdistrplus::fitdist(data=w_3_1986$DURATION%>% unlist() %>% as.numeric(), "exp", method="mle", optim.method="Nelder-Mead", weights = round(w_3_1986$WGHT_EPI))

summary(exp_w3_1986_)

fit_dexp_w386 <- data.frame(f = dexp(w_3_1986$DURATION, rate = exp_w3_1986_$estimate[1]), 
                       x = w_3_1986$DURATION, type = "exp")

plot(x = fit_dexp_w386$x, y = fit_dexp_w386$f)

```

Now let's compare these models AIC and BIC to see which fits the walk data best:

```{r}
#comparing these models AIC and BIC to see which fits the walk data best:
broom::glance(MASS::fitdistr(w_3_1986$DURATION%>% unlist() %>% as.numeric(),"gamma"))
broom::glance(MASS::fitdistr(w_3_1986$DURATION%>% unlist() %>% as.numeric(),"exponential"))
```

So, gamma has largest logLik and the smallest AIC and BIC. we will pick gamma function for walking trips in 1986!

```{r}
walking_386_gamma <- gamma_w3_1986_
w_3_1986 <- w_3_1986 %>%
 mutate(f_3 = dgamma(DURATION, walking_386_gamma$estimate["shape"], walking_386_gamma$estimate["rate"] )) 
summary(w_3_1986$f_3)
```

##Calculating impedance function for CYCLING

### Calculating impedance function for cycling in 2015

using a skew vs. kurtois graph to descriptive statistics of data:

```{r creating Cullen and Frey graph for cycling 2015}
# creating a skew vs. kurtois graph for cycling 2015

descdist(cycling_2015$DURATION %>% unlist() %>% as.numeric(), discrete=FALSE, boot=500)
```

As shown in the Cullen and Frey graph, we see that gamma and exponential will likely be the best fit according to the graph above. Then we compare these models to find the best model.

```{r}
summary(cycling_2015$DURATION)
```

```{r}

# Based on the skew vs. kurtois graph the best distribution

#Calculating gamma distribution

gamma_c_2015_ <- fitdistrplus::fitdist(data=cycling_2015$DURATION%>% unlist() %>% as.numeric(), "gamma", method="mle", optim.method="Nelder-Mead", weights = round(cycling_2015$WGHT_EPI))


fit_dgamma <- data.frame(f = dgamma(cycling_2015$DURATION, shape = gamma_c_2015_$estimate[1], rate = gamma_c_2015_$estimate[2]), x = cycling_2015$DURATION, type = "gamma")

summary(gamma_c_2015_)

plot(x= fit_dgamma$x, y=fit_dgamma$f)


#Calculating exponential distribution
exp_c_2015_ <- fitdistrplus::fitdist(data=cycling_2015$DURATION%>% unlist() %>% as.numeric(), "exp", method="mle", optim.method="Nelder-Mead", weights = round(cycling_2015$WGHT_EPI))

summary(exp_c_2015_)

fit_dexp <- data.frame(f = dexp(cycling_2015$DURATION, rate = exp_c_2015_$estimate[1]), x = cycling_2015$DURATION, type = "exp")

plot(x= fit_dexp$x, y=fit_dexp$f)


```

Now let's compare these models based on AIC and BIC to see which fits the walk data best:

```{r}
#comparing these models AIC and BIC to see which fits the walk data best:
broom::glance(MASS::fitdistr(cycling_2015$DURATION%>% unlist() %>% as.numeric(),"gamma"))
broom::glance(MASS::fitdistr(cycling_2015$DURATION%>% unlist() %>% as.numeric(),"exponential"))

```

So, gamma has largest logLik and the smallest AIC and BIC. we will pick gamma function for cycling trips in 2015!

```{r}
cycling_2015_gamma <- gamma_c_2015_
cycling_2015 <- cycling_2015 %>%
 mutate(f = dgamma(DURATION, cycling_2015_gamma$estimate["rate"])) 
summary(cycling_2015$f)

```


###Destination : Cycling- Home (300), 2015

using a skew vs. kurtois graph to descriptive statistics of data

```{r creating Cullen and Frey graph for cycling 2015}
# creating a skew vs. kurtois graph for cycling 2015

# Filter the data based on the "destination" column
 c_300_2015 <- cycling_2015 %>%
  filter(destination == "300")   
descdist(c_300_2015$DURATION %>% unlist() %>% as.numeric(), discrete=FALSE, boot=500)
```

As shown in the Cullen and Frey graph, we see that gamma, weibull and exponential will likely be the best fit according to the graph above. Then we compare these models to find the best model.

```{r}
# Based on the skew vs. kurtois graph the best distribution

#Calculating gamma distribution 
gamma_c300_2015_ <- fitdistrplus::fitdist(data=c_300_2015$DURATION%>% unlist() %>% as.numeric(), "gamma", method="mle", optim.method="Nelder-Mead", weights = round(c_300_2015$WGHT_EPI))

fit_dgamma_c30015 <- data.frame(f_300 = dgamma(c_300_2015$DURATION, shape = gamma_c300_2015_$estimate[1], rate = gamma_c300_2015_$estimate[2]), x = c_300_2015$DURATION, type = "Gamma")

summary(gamma_c300_2015_)

plot(x= fit_dgamma_c30015$x, y=fit_dgamma_c30015$f)

#Calculating weibull distribution
weibull_c300_2015_ <- fitdistrplus::fitdist(data=c_300_2015$DURATION%>% unlist() %>% as.numeric(), "weibull", method="mle", optim.method="Nelder-Mead", weights = round(c_300_2015$WGHT_EPI))

summary(weibull_c300_2015_)

fit_dweibull_c30015 <- data.frame(f = dweibull(c_300_2015$DURATION, shape = weibull_c300_2015_$estimate[1], scale = weibull_c300_2015_$estimate[2]), x = c_300_2015$DURATION, type = "weibull")

plot(x= fit_dweibull_c30015$x, y=fit_dweibull_c30015$f)

#Calculating exponential distribution
exp_c300_2015_ <- fitdistrplus::fitdist(data=c_300_2015$DURATION%>% unlist() %>% as.numeric(), "exp", method="mle", optim.method="Nelder-Mead", weights = round(c_300_2015$WGHT_EPI))

summary(exp_c300_2015_)

fit_dexp_c30015 <- data.frame(f = dexp(c_300_2015$DURATION, exp_c300_2015_$estimate[1]), 
                       x = c_300_2015$DURATION, type = "exp")

plot(x = fit_dexp_c30015$x, y = fit_dexp_c30015$f)

```

Now let's compare these models AIC and BIC to see which fits the walk data best:

```{r}
#comparing these models AIC and BIC to see which fits the walk data best:
broom::glance(MASS::fitdistr(c_300_2015$DURATION%>% unlist() %>% as.numeric(),"gamma"))
broom::glance(MASS::fitdistr(c_300_2015$DURATION%>% unlist() %>% as.numeric(),"weibull"))
broom::glance(MASS::fitdistr(c_300_2015$DURATION%>% unlist() %>% as.numeric(),"exponential"))
```

So, gamma has largest logLik and the smallest AIC and BIC. we will pick gamma function for cycling trips in 2015!

```{r}
cycling_30015_gamma <- gamma_c300_2015_
c_300_2015 <- c_300_2015 %>%
 mutate(f_300 = dgamma(DURATION, cycling_30015_gamma$estimate["shape"], cycling_30015_gamma$estimate["rate"])) 
summary(c_300_2015$f_300)
```



###Destination : Cycling - work or school (301), 2015
using a skew vs. kurtois graph to descriptive statistics of data

```{r creating Cullen and Frey graph for cycling 2015}
# creating a skew vs. kurtois graph for cycling 2015

# Filter the data based on the "destination" column
 c_301_2015 <- cycling_2015 %>%
  filter(destination == "301")   
descdist(c_301_2015$DURATION %>% unlist() %>% as.numeric(), discrete=FALSE, boot=500)
```

As shown in the Cullen and Frey graph, we see that gamma, weibull, normal and exponential will likely be the best fit according to the graph above. Then we compare these models to find the best model.

```{r}
# Based on the skew vs. kurtois graph the best distribution

#Calculating gamma distribution 

gamma_c301_2015_ <- fitdistrplus::fitdist(data=c_301_2015$DURATION%>% unlist() %>% as.numeric(), "gamma", method="mle", optim.method="Nelder-Mead", weights = round(c_301_2015$WGHT_EPI))

fit_dgamma_30115 <- data.frame(f = dgamma(c_301_2015$DURATION, shape = gamma_c301_2015_$estimate[1], rate = gamma_c301_2015_$estimate[2]), x = c_301_2015$DURATION, type = "Gamma")

summary(gamma_c301_2015_)

plot(x= fit_dgamma_30115$x, y=fit_dgamma_30115$f)

#Calculating weibull distribution
weibull_c301_2015_ <- fitdistrplus::fitdist(data=c_301_2015$DURATION%>% unlist() %>% as.numeric(), "weibull", method="mle", optim.method="Nelder-Mead", weights = round(c_301_2015$WGHT_EPI))

summary(weibull_c301_2015_)

fit_dweibull_30115 <- data.frame(f = dweibull(c_301_2015$DURATION, shape = weibull_c301_2015_$estimate[1], scale = weibull_c301_2015_$estimate[2]), x = c_301_2015$DURATION, type = "weibull")

plot(x= fit_dweibull_30115$x, y=fit_dweibull_30115$f)

#Calculating exponential distribution
exp_c301_2015_ <- fitdistrplus::fitdist(data=c_301_2015$DURATION%>% unlist() %>% as.numeric(), "exp", method="mle", optim.method="Nelder-Mead", weights = round(c_301_2015$WGHT_EPI))

summary(exp_c301_2015_)

fit_dexp_30115 <- data.frame(f = dexp(w_301_2015$DURATION, rate =exp_w301_2015_$estimate[1]), 
                       x = w_301_2015$DURATION, type = "exp")

plot(x = fit_dexp_30115$x, y = fit_dexp_30115$f)

#Calculating lognormal distribution
norm_c301_2015_ <- fitdistrplus::fitdist(data=c_301_2015$DURATION%>% unlist() %>% as.numeric(), "norm", method="mle", optim.method="Nelder-Mead", weights = round(c_301_2015$WGHT_EPI))

summary(norm_c301_2015_)

fit_dnorm_30115 <- data.frame(f = dnorm(c_301_2015$DURATION, mean = norm_c301_2015_$estimate[1], sd = norm_c301_2015_$estimate[2]), x = c_301_2015$DURATION, type = "norm")

plot(x= fit_dnorm_30115$x, y=fit_dnorm_30115$f)


```

Now let's compare these models AIC and BIC to see which fits the walk data best:

```{r}
#comparing these models AIC and BIC to see which fits the walk data best:
broom::glance(MASS::fitdistr(c_300_2015$DURATION%>% unlist() %>% as.numeric(),"gamma"))
broom::glance(MASS::fitdistr(c_300_2015$DURATION%>% unlist() %>% as.numeric(),"weibull"))
broom::glance(MASS::fitdistr(c_300_2015$DURATION%>% unlist() %>% as.numeric(),"exponential"))
broom::glance(MASS::fitdistr(c_300_2015$DURATION%>% unlist() %>% as.numeric(),"normal"))
```

So, gamma has largest logLik and the smallest AIC and BIC. we will pick gamma function for cycling trips in 2015!(301)

```{r}
cycling_30115_gamma <- gamma_c301_2015_
c_301_2015 <- c_301_2015 %>%
 mutate(f_301 = dgamma(DURATION, cycling_30115_gamma$estimate["shape"], cycling_30115_gamma$estimate["rate"])) 
summary(c_301_2015$f_301)
```


###Destination : Cycling- Business (302), 2015
using a skew vs. kurtois graph to descriptive statistics of data


```{r creating Cullen and Frey graph for cycling 2015_ Business destination}
# creating a skew vs. kurtois graph for cycling 2015 _ Business destination

# Filter the data based on the "destination" column
 c_302_2015 <- cycling_2015 %>%
  filter(destination == "302") 
count <- sum(cycling_2015$destination == "302")
print(count)

```

There is no available data pertaining to cycling directed towards business destinations.

###Destination : Cycling- At someone else's home or property (303), 2015
using a skew vs. kurtois graph to descriptive statistics of data

```{r creating Cullen and Frey graph for cycling 2015}
# creating a skew vs. kurtois graph for cycling 2015

# Filter the data based on the "destination" column
 c_303_2015 <- cycling_2015 %>%
  filter(destination == "303")   
descdist(c_303_2015$DURATION %>% unlist() %>% as.numeric(), discrete=FALSE, boot=500)
```

As shown in the Cullen and Frey graph, we see that gamma, poisson and exponential will likely be the best fit according to the graph above. Then we compare these models to find the best model.

```{r}
# Based on the skew vs. kurtois graph the best distribution

#Calculating gamma distribution 

gamma_c303_2015_ <- fitdistrplus::fitdist(data=c_303_2015$DURATION%>% unlist() %>% as.numeric(), "gamma", method="mle", optim.method="Nelder-Mead", weights = round(c_303_2015$WGHT_EPI))

fit_dgamma_30315 <- data.frame(f = dgamma(c_303_2015$DURATION, shape = gamma_c303_2015_$estimate[1], rate = gamma_c303_2015_$estimate[2]), x = c_303_2015$DURATION, type = "Gamma")

summary(gamma_c303_2015_)

plot(x= fit_dgamma_30315$x, y=fit_dgamma_30315$f)


#Calculating exponential distribution
exp_c303_2015_ <- fitdistrplus::fitdist(data=c_303_2015$DURATION%>% unlist() %>% as.numeric(), "exp", method="mle", optim.method="Nelder-Mead", weights = round(c_303_2015$WGHT_EPI))

summary(exp_c303_2015_)

fit_dexp_30315 <- data.frame(f = dexp(c_303_2015$DURATION, rate = exp_c303_2015_$estimate[1]), 
                       x = c_303_2015$DURATION, type = "exp")

plot(x = fit_dexp_30315$x, y = fit_dexp_30315$f)

#Calculating pois distribution 
pois_c303_2015_ <- fitdistrplus::fitdist(data=c_303_2015$DURATION%>% unlist() %>% as.numeric(), "pois", method="mle", optim.method="Nelder-Mead", weights = round(c_303_2015$WGHT_EPI))

fit_dpois_30315 <- data.frame(f = dpois(c_303_2015$DURATION, lambda = pois_c303_2015_$estimate[1]), x = c_303_2015$DURATION, type = "pois")

summary(pois_c303_2015_)

plot(x= fit_dpois_30315$x, y=fit_dpois_30315$f)

```

Now let's compare these models AIC and BIC to see which fits the walk data best:

```{r}
#comparing these models AIC and BIC to see which fits the walk data best:
broom::glance(MASS::fitdistr(c_303_2015$DURATION%>% unlist() %>% as.numeric(),"gamma"))
broom::glance(MASS::fitdistr(c_303_2015$DURATION%>% unlist() %>% as.numeric(),"poisson"))
broom::glance(MASS::fitdistr(c_303_2015$DURATION%>% unlist() %>% as.numeric(),"exponential"))
```

So, gamma has largest logLik and the smallest AIC and BIC. we will pick gamma function for cycling trips in 2015!(303)

```{r}
cycling_30315_gamma <- gamma_c303_2015_
c_303_2015 <- c_303_2015 %>%
 mutate(f_303 = dgamma(DURATION, cycling_30315_gamma$estimate["shape"], cycling_30315_gamma$estimate["rate"])) 
summary(c_303_2015$f_303)
```



###Destination : Cycling - Outdoors (305), 2015
using a skew vs. kurtois graph to descriptive statistics of data

```{r creating Cullen and Frey graph for cycling 2015}
# creating a skew vs. kurtois graph for cycling 2015

# Filter the data based on the "destination" column
 c_305_2015 <- cycling_2015 %>%
  filter(destination == "305") 

count <- sum(cycling_2015$destination == "305")
print(count)

#descdist(c_305_2015$DURATION %>% unlist() %>% as.numeric(), discrete=FALSE, boot=500)
```


###Destination : Cycling - Grocery store, other stores or mall (306), 2015
using a skew vs. kurtois graph to descriptive statistics of data

```{r creating Cullen and Frey graph for cycling 2015}
# creating a skew vs. kurtois graph for cycling 2015

# Filter the data based on the "destination" column
 c_306_2015 <- cycling_2015 %>%
  filter(destination == "306")   
descdist(c_306_2015$DURATION %>% unlist() %>% as.numeric(), discrete=FALSE, boot=500)
```

As shown in the Cullen and Frey graph, we see that normal and logistic will likely be the best fit according to the graph above. Then we compare these models to find the best model.

```{r}
# Based on the skew vs. kurtois graph the best distribution

#Calculating normal distribution 

norm_c306_2015_ <- fitdistrplus::fitdist(data=c_306_2015$DURATION%>% unlist() %>% as.numeric(), "norm", method="mle", optim.method="Nelder-Mead", weights = round(c_306_2015$WGHT_EPI))

summary(norm_c306_2015_)

fit_dnorm_30615 <- data.frame(f = dnorm(c_306_2015$DURATION, mean = norm_c306_2015_$estimate[1], sd = norm_c306_2015_$estimate[2]), x = c_306_2015$DURATION, type = "norm")

plot(x= fit_dnorm_30615$x, y=fit_dnorm_30615$f)


#Calculating logistic distribution
logis_c306_2015_ <- fitdistrplus::fitdist(data=c_306_2015$DURATION%>% unlist() %>% as.numeric(), "logis", method="mle", optim.method="Nelder-Mead", weights = round(c_306_2015$WGHT_EPI))

summary(logis_c306_2015_)

fit_dlogis_30615 <- data.frame(f = dlogis(c_306_2015$DURATION, location = logis_c306_2015_$estimate[1], scale = logis_c306_2015_$estimate[2]), x = c_306_2015$DURATION, type = "logis")

plot(x= fit_dlogis_30615$x, y=fit_dlogis_30615$f)


```

Now let's compare these models AIC and BIC to see which fits the walk data best:

```{r}
#comparing these models AIC and BIC to see which fits the walk data best:
broom::glance(MASS::fitdistr(w_306_2015$DURATION%>% unlist() %>% as.numeric(),"logistic"))
broom::glance(MASS::fitdistr(w_306_2015$DURATION%>% unlist() %>% as.numeric(),"normal"))
```

So, logistic has largest logLik and the smallest AIC and BIC. we will pick logistic function for walking trips in 2015!(306)

```{r}
cycling_30615_logis <- logis_c306_2015_
c_306_2015 <- c_306_2015 %>%
 mutate(f_306 = dlogis(DURATION, cycling_30615_logis$estimate["location"], cycling_30615_logis$estimate["scale"])) 
summary(c_306_2015$f_306)
```



###Destination : Cycling - Library, museum or theatre (307), 2015
using a skew vs. kurtois graph to descriptive statistics of data

```{r creating Cullen and Frey graph for cycling 2015}
# creating a skew vs. kurtois graph for cycling 2015

# Filter the data based on the "destination" column
 c_307_2015 <- cycling_2015 %>%
  filter(destination == "307")  
count <- sum(cycling_2015$destination == "307")
print(count)

#descdist(c_307_2015$DURATION %>% unlist() %>% as.numeric(), discrete=FALSE, boot=500)
```


###Destination : Cycling - Restaurant, bar or club (309), 2015
using a skew vs. kurtois graph to descriptive statistics of data

```{r creating Cullen and Frey graph for cycling 2015}
# creating a skew vs. kurtois graph for cycling 2015

# Filter the data based on the "destination" column
 c_309_2015 <- cycling_2015 %>%
  filter(destination == "309")   

descdist(c_309_2015$DURATION %>% unlist() %>% as.numeric(), discrete=FALSE, boot=500)
```

As shown in the Cullen and Frey graph, we see that gamma, normal, poisson and exponential will likely be the best fit according to the graph above. Then we compare these models to find the best model.

```{r}
# Based on the skew vs. kurtois graph the best distribution

#Calculating gamma distribution 

gamma_c309_2015_ <- fitdistrplus::fitdist(data=c_309_2015$DURATION%>% unlist() %>% as.numeric(), "gamma", method="mle", optim.method="Nelder-Mead", weights = round(c_309_2015$WGHT_EPI))

fit_dgamma_30915 <- data.frame(f = dgamma(c_309_2015$DURATION, shape = gamma_c309_2015_$estimate[1], rate = gamma_c309_2015_$estimate[2]), x = c_309_2015$DURATION, type = "Gamma")

summary(gamma_c309_2015_)

plot(x= fit_dgamma_30915$x, y=fit_dgamma_30915$f)

#Calculating pois distribution 
pois_c309_2015_ <- fitdistrplus::fitdist(data=c_309_2015$DURATION%>% unlist() %>% as.numeric(), "pois", method="mle", optim.method="Nelder-Mead", weights = round(c_309_2015$WGHT_EPI))

fit_dpois_30915 <- data.frame(f = dpois(c_309_2015$DURATION, lambda = pois_c309_2015_$estimate[1]), x = c_309_2015$DURATION, type = "pois")

summary(pois_c309_2015_)

plot(x= fit_dpois_30915$x, y=fit_dpois_30915$f)


#Calculating normal distribution
norm_c309_2015_ <- fitdistrplus::fitdist(data=c_309_2015$DURATION%>% unlist() %>% as.numeric(), "norm", method="mle", optim.method="Nelder-Mead", weights = round(c_309_2015$WGHT_EPI))

summary(norm_c309_2015_)

fit_dnorm_30915 <- data.frame(f = dnorm(c_309_2015$DURATION, mean = norm_c309_2015_$estimate[1], sd = norm_c309_2015_$estimate[2]), x = c_309_2015$DURATION, type = "norm")

plot(x= fit_dnorm_30915$x, y=fit_dnorm_30915$f)


#Calculating exponential distribution
exp_c309_2015_ <- fitdistrplus::fitdist(data=c_309_2015$DURATION%>% unlist() %>% as.numeric(), "exp", method="mle", optim.method="Nelder-Mead", weights = round(c_309_2015$WGHT_EPI))

summary(exp_c309_2015_)

fit_dexp_30915 <- data.frame(f = dexp(c_309_2015$DURATION, rate = exp_c309_2015_$estimate[1]), 
                       x = c_309_2015$DURATION, type = "exp")

plot(x = fit_dexp_30915$x, y = fit_dexp_30915$f)

```

Now let's compare these models AIC and BIC to see which fits the walk data best:

```{r}
#comparing these models AIC and BIC to see which fits the walk data best:
broom::glance(MASS::fitdistr(w_309_2015$DURATION%>% unlist() %>% as.numeric(),"gamma"))
broom::glance(MASS::fitdistr(w_309_2015$DURATION%>% unlist() %>% as.numeric(),"normal"))
broom::glance(MASS::fitdistr(w_309_2015$DURATION%>% unlist() %>% as.numeric(),"poisson"))
broom::glance(MASS::fitdistr(w_309_2015$DURATION%>% unlist() %>% as.numeric(),"exponential"))
```

So, gamma has largest logLik and the smallest AIC and BIC. we will pick gamma function for walking trips in 2015!(309)

```{r}
cycling_30915_gamma <- gamma_c309_2015_
c_309_2015 <- c_309_2015 %>%
 mutate(f_309 = dgamma(DURATION, cycling_30915_gamma$estimate["shape"], cycling_30915_gamma$estimate["rate"])) 
summary(c_309_2015$f_309)
```

###Destination : Cycling - Place of worship (310), 2015
using a skew vs. kurtois graph to descriptive statistics of data

```{r creating Cullen and Frey graph for cycling 2015}
# creating a skew vs. kurtois graph for cycling 2015

# Filter the data based on the "destination" column
 c_310_2015 <- cycling_2015 %>%
  filter(destination == "310")  
count <- sum(cycling_2015$destination == "310")
print(count)


#descdist(c_310_2015$DURATION %>% unlist() %>% as.numeric(), discrete=FALSE, boot=500)
```


### Calculating impedance function for cycling in 2010

using a skew vs. kurtois graph to descriptive statistics of data:

```{r creating Cullen and Frey graph for cycling 2010}
# creating a skew vs. kurtois graph for cycling 2010

descdist(cycling_2010$DURATION %>% unlist() %>% as.numeric(), discrete=FALSE, boot=500)
```

As shown in the Cullen and Frey graph, we see that gamma and exponential will likely be the best fit according to the graph above. Then we compare these models to find the best model.

```{r}
summary(cycling_2010$DURATION)
```

```{r}

# Based on the skew vs. kurtois graph the best distribution

#Calculating gamma distribution

gamma_c_2010_ <- fitdistrplus::fitdist(data=cycling_2010$DURATION%>% unlist() %>% as.numeric(), "gamma", method="mle", optim.method="Nelder-Mead", weights = round(cycling_2010$WGHT_EPI))


fit_dgamma <- data.frame(f = dgamma(cycling_2010$DURATION, shape = gamma_c_2010_$estimate[1], rate = gamma_c_2010_$estimate[2]), x = cycling_2010$DURATION, type = "gamma")

summary(gamma_c_2010_)

plot(x= fit_dgamma$x, y=fit_dgamma$f)


#Calculating lognormal distribution
exp_c_2010_ <- fitdistrplus::fitdist(data=cycling_2010$DURATION%>% unlist() %>% as.numeric(), "exp", method="mle", optim.method="Nelder-Mead", weights = round(cycling_2010$WGHT_EPI))

summary(exp_c_2010_)

fit_dexp <- data.frame(f = dexp(cycling_2010$DURATION, rate = exp_c_2010_$estimate[1]), x = cycling_2010$DURATION, type = "exp")

plot(x= fit_dexp$x, y=fit_dexp$f)


```

Now let's compare these models based on AIC and BIC to see which fits the walk data best:

```{r}
#comparing these models AIC and BIC to see which fits the walk data best:
broom::glance(MASS::fitdistr(cycling_2010$DURATION%>% unlist() %>% as.numeric(),"gamma"))
broom::glance(MASS::fitdistr(cycling_2010$DURATION%>% unlist() %>% as.numeric(),"exponential"))

```

So, gamma has largest logLik and the smallest AIC and BIC. we will pick gamma function for cycling trips in 2010!

```{r}
cycling_2010_gamma <- gamma_c_2010_
cycling_2010 <- cycling_2010 %>%
 mutate(f = dgamma(DURATION, cycling_2010_gamma$estimate["rate"])) 
summary(cycling_2010$f)

```



### Calculating impedance function for walking in 2010 based on different purposes

###Destination : Cycling - Home (1), 2010

using a skew vs. kurtois graph to descriptive statistics of data

```{r creating Cullen and Frey graph for cycling 2010}
# creating a skew vs. kurtois graph for cycling 2010

# Filter the data based on the "destination" column
 c_1_2010 <- cycling_2010 %>%
  filter(destination == "1")   
descdist(c_1_2010$DURATION %>% unlist() %>% as.numeric(), discrete=FALSE, boot=500)
```

As shown in the Cullen and Frey graph, we see that gamma and exponential will likely be the best fit according to the graph above. Then we compare these models to find the best model.

```{r}
# Based on the skew vs. kurtois graph the best distribution

#Calculating gamma distribution 
gamma_c1_2010_ <- fitdistrplus::fitdist(data=c_1_2010$DURATION%>% unlist() %>% as.numeric(), "gamma", method="mle", optim.method="Nelder-Mead", weights = round(c_1_2010$WGHT_EPI))

fit_dgamma_c110 <- data.frame(f = dgamma( c_1_2010$DURATION, shape = gamma_c1_2010_$estimate[1], rate = gamma_c1_2010_$estimate[2]), x = c_1_2010$DURATION, type = "Gamma")

summary(gamma_c1_2010_)

plot(x= fit_dgamma_c110$x, y=fit_dgamma_c110$f)



#Calculating exponential distribution
exp_c1_2010_ <- fitdistrplus::fitdist(data=c_1_2010$DURATION%>% unlist() %>% as.numeric(), "exp", method="mle", optim.method="Nelder-Mead", weights = round(c_1_2010$WGHT_EPI))

summary(exp_c1_2010_)

fit_dexp_c110 <- data.frame(f = dexp(c_1_2010$DURATION, rate = exp_c1_2010_$estimate[1]), 
                       x = c_1_2010$DURATION, type = "exp")

plot(x = fit_dexp_c110$x, y = fit_dexp_c110$f)

```

Now let's compare these models AIC and BIC to see which fits the walk data best:

```{r}
#comparing these models AIC and BIC to see which fits the walk data best:
broom::glance(MASS::fitdistr(c_1_2010$DURATION%>% unlist() %>% as.numeric(),"gamma"))
broom::glance(MASS::fitdistr(c_1_2010$DURATION%>% unlist() %>% as.numeric(),"exponential"))
```

So, gamma has largest logLik and the smallest AIC and BIC. we will pick gamma function for cycling trips in 2010!

```{r}
cycling_110_gamma <- gamma_c1_2010_
c_1_2010 <- c_1_2010 %>%
 mutate(f_1 = dgamma(DURATION, cycling_110_gamma$estimate["shape"], cycling_110_gamma$estimate["rate"])) 
summary(c_1_2010$f_1)
```


###Destination : Cycling - work or school (2 and 8), 2010

using a skew vs. kurtois graph to descriptive statistics of data

```{r creating Cullen and Frey graph for cycling 2010}
# creating a skew vs. kurtois graph for cycling 2010

# Filter the data based on the "destination" column
 c_2_2010 <- cycling_2010 %>%
  filter(destination %in% c("2", "8"))   
descdist(c_2_2010$DURATION %>% unlist() %>% as.numeric(), discrete=FALSE, boot=500)
```

As shown in the Cullen and Frey graph, we see that gamma, weibull, lognormal and exponential will likely be the best fit according to the graph above. Then we compare these models to find the best model.

```{r}
# Based on the skew vs. kurtois graph the best distribution

#Calculating gamma distribution 
gamma_c2_2010_ <- fitdistrplus::fitdist(data=c_2_2010$DURATION%>% unlist() %>% as.numeric(), "gamma", method="mle", optim.method="Nelder-Mead", weights = round(c_2_2010$WGHT_EPI))

fit_dgamma_c210 <- data.frame(f = dgamma(c_2_2010$DURATION, shape = gamma_c2_2010_$estimate[1], rate = gamma_c2_2010_$estimate[2]), x = c_2_2010$DURATION, type = "Gamma")

summary(gamma_c2_2010_)

plot(x= fit_dgamma_c210$x, y=fit_dgamma_c210$f)

#Calculating weibull distribution
weibull_c2_2010_ <- fitdistrplus::fitdist(data=c_2_2010$DURATION%>% unlist() %>% as.numeric(), "weibull", method="mle", optim.method="Nelder-Mead", weights = round(c_2_2010$WGHT_EPI))

summary(weibull_c2_2010_)

fit_dweibull_c210 <- data.frame(f = dweibull(c_2_2010$DURATION, shape = weibull_c2_2010_$estimate[1], scale = weibull_c2_2010_$estimate[2]), x = c_2_2010$DURATION, type = "weibull")

plot(x= fit_dweibull_c210$x, y=fit_dweibull_c210$f)

#Calculating exponential distribution
exp_c2_2010_ <- fitdistrplus::fitdist(data=c_2_2010$DURATION%>% unlist() %>% as.numeric(), "exp", method="mle", optim.method="Nelder-Mead", weights = round(c_2_2010$WGHT_EPI))

summary(exp_c2_2010_)

fit_dexp_c210 <- data.frame(f = dexp(c_2_2010$DURATION, rate = exp_c2_2010_$estimate[1]), 
                       x = c_2_2010$DURATION, type = "exp")

plot(x = fit_dexp_c210$x, y = fit_dexp_c210$f)


#Calculating lognormal distribution
lnorm_c2_2010_ <- fitdistrplus::fitdist(data=c_2_2010$DURATION%>% unlist() %>% as.numeric(), "lnorm", method="mle", optim.method="Nelder-Mead", weights = round(c_2_2010$WGHT_EPI))

summary(lnorm_c2_2010_)

fit_dlnorm_210 <- data.frame(f = dlnorm(c_2_2010$DURATION, meanlog = lnorm_c2_2010_$estimate[1], sdlog = lnorm_c2_2010_$estimate[2]), x = c_2_2010$DURATION, type = "lnorm")

plot(x= fit_dlnorm_210$x, y=fit_dlnorm_210$f)

```

Now let's compare these models AIC and BIC to see which fits the walk data best:

```{r}
#comparing these models AIC and BIC to see which fits the walk data best:
broom::glance(MASS::fitdistr(c_2_2010$DURATION%>% unlist() %>% as.numeric(),"gamma"))
broom::glance(MASS::fitdistr(c_2_2010$DURATION%>% unlist() %>% as.numeric(),"weibull"))
broom::glance(MASS::fitdistr(c_2_2010$DURATION%>% unlist() %>% as.numeric(),"exponential"))
broom::glance(MASS::fitdistr(c_2_2010$DURATION%>% unlist() %>% as.numeric(),"lognormal"))
```

So, gamma has largest logLik and the smallest AIC and BIC. we will pick gamma function for cycling trips in 2010!

```{r}
cycling_2010_gamma <- gamma_c2_2010_
c_2_2010 <- c_2_2010 %>%
 mutate(f_2 = dgamma(DURATION, cycling_2010_gamma$estimate["shape"], cycling_2010_gamma$estimate["rate"])) 
summary(c_2_2010$f_2)
```

###Destination : Cycling - other's home (3), 2010

using a skew vs. kurtois graph to descriptive statistics of data

```{r creating Cullen and Frey graph for cycling 2010}
# creating a skew vs. kurtois graph for cycling 2010

# Filter the data based on the "destination" column
 c_3_2010 <- cycling_2010 %>%
  filter(destination == "3")   
descdist(c_3_2010$DURATION %>% unlist() %>% as.numeric(), discrete=FALSE, boot=500)
```

As shown in the Cullen and Frey graph, we see that gamma, poisson and exponential will likely be the best fit according to the graph above. Then we compare these models to find the best model.

```{r}
# Based on the skew vs. kurtois graph the best distribution

#Calculating gamma distribution 
gamma_c3_2010_ <- fitdistrplus::fitdist(data=c_3_2010$DURATION%>% unlist() %>% as.numeric(), "gamma", method="mle", optim.method="Nelder-Mead", weights = round(c_3_2010$WGHT_EPI))

fit_dgamma_c310 <- data.frame(f = dgamma(c_3_2010$DURATION, shape = gamma_c3_2010_$estimate[1], rate = gamma_c3_2010_$estimate[2]), x = c_3_2010$DURATION, type = "Gamma")

summary(gamma_c3_2010_)

plot(x= fit_dgamma_c310$x, y=fit_dgamma_c310$f)

#Calculating weibull distribution
weibull_c3_2010_ <- fitdistrplus::fitdist(data=c_3_2010$DURATION%>% unlist() %>% as.numeric(), "weibull", method="mle", optim.method="Nelder-Mead", weights = round(c_3_2010$WGHT_EPI))

summary(weibull_c3_2010_)

fit_dweibull_c310 <- data.frame(f = dweibull(c_3_2010$DURATION, shape = weibull_c3_2010_$estimate[1], scale = weibull_c3_2010_$estimate[2]), x = c_3_2010$DURATION, type = "weibull")

plot(x= fit_dweibull_c310$x, y=fit_dweibull_c310$f)

#Calculating exponential distribution
exp_c3_2010_ <- fitdistrplus::fitdist(data=c_3_2010$DURATION%>% unlist() %>% as.numeric(), "exp", method="mle", optim.method="Nelder-Mead", weights = round(c_3_2010$WGHT_EPI))

summary(exp_c3_2010_)

fit_dexp_c310 <- data.frame(f = dexp(c_3_2010$DURATION, rate = exp_c3_2010_$estimate[1]), 
                       x = c_3_2010$DURATION, type = "exp")

plot(x = fit_dexp_c310$x, y = fit_dexp_c310$f)

```

Now let's compare these models AIC and BIC to see which fits the walk data best:

```{r}
#comparing these models AIC and BIC to see which fits the walk data best:
broom::glance(MASS::fitdistr(c_3_2010$DURATION%>% unlist() %>% as.numeric(),"gamma"))
broom::glance(MASS::fitdistr(c_3_2010$DURATION%>% unlist() %>% as.numeric(),"weibull"))
broom::glance(MASS::fitdistr(c_3_2010$DURATION%>% unlist() %>% as.numeric(),"exponential"))
```

So, gamma has largest logLik and the smallest AIC and BIC. we will pick gamma function for cycling trips in 2010!

```{r}
cycling_310_exp <- exp_c3_2010_
c_3_2010 <- c_3_2010 %>%
 mutate(f_3 = dexp(DURATION, cycling_310_exp$estimate["rate"])) 
summary(c_3_2010$f_3)
```


###Destination : Cycling - Restaurant/bar (4), 2010

using a skew vs. kurtois graph to descriptive statistics of data

```{r creating Cullen and Frey graph for cycling 2010}
# creating a skew vs. kurtois graph for cycling 2010

# Filter the data based on the "destination" column
 c_4_2010 <- cycling_2010 %>%
  filter(destination == "4")  
count <- sum(cycling_2010$destination == "4")
print(count)

#descdist(c_4_2010$DURATION %>% unlist() %>% as.numeric(), discrete=FALSE, boot=500)
```


###Destination : Cycling - Place of worship (5), 2010

using a skew vs. kurtois graph to descriptive statistics of data

```{r creating Cullen and Frey graph for cycling 2010}
# creating a skew vs. kurtois graph for cycling 2010

# Filter the data based on the "destination" column
 c_5_2010 <- cycling_2010 %>%
  filter(destination == "5")   
count <- sum(cycling_2010$destination == "5")
print(count)
#descdist(c_5_2010$DURATION %>% unlist() %>% as.numeric(), discrete=FALSE, boot=500)
```

###Destination : Cycling - Grocery store, other stores or mall (6 ad 7), 2010

using a skew vs. kurtois graph to descriptive statistics of data

```{r creating Cullen and Frey graph for cycling 2010}
# creating a skew vs. kurtois graph for cycling 2010

# Filter the data based on the "destination" column
 c_6_2010 <- cycling_2010 %>%
  filter(destination %in% c("6", "7"))   
descdist(c_6_2010$DURATION %>% unlist() %>% as.numeric(), discrete=FALSE, boot=500)
```

As shown in the Cullen and Frey graph, we see that gamma, normal and exponential will likely be the best fit according to the graph above. Then we compare these models to find the best model.

```{r}
# Based on the skew vs. kurtois graph the best distribution

#Calculating gamma distribution 
gamma_c6_2010_ <- fitdistrplus::fitdist(data=c_6_2010$DURATION%>% unlist() %>% as.numeric(), "gamma", method="mle", optim.method="Nelder-Mead", weights = round(c_6_2010$WGHT_EPI))

fit_dgamma_c610 <- data.frame(f = dgamma(c_6_2010$DURATION, shape = gamma_c6_2010_$estimate[1], rate = gamma_c6_2010_$estimate[2]), x = c_6_2010$DURATION, type = "Gamma")

summary(gamma_c6_2010_)

plot(x= fit_dgamma_c610$x, y=fit_dgamma_c610$f)

#Calculating normal distribution
norm_c6_2010_ <- fitdistrplus::fitdist(data=c_6_2010$DURATION%>% unlist() %>% as.numeric(), "norm", method="mle", optim.method="Nelder-Mead", weights = round(c_6_2010$WGHT_EPI))

summary(norm_c6_2010_)

fit_dnorm_c610 <- data.frame(f = dnorm(c_6_2010$DURATION, mean = norm_c6_2010_$estimate[1], sd = norm_c6_2010_$estimate[2]), x = c_6_2010$DURATION, type = "norm")

plot(x= fit_dnorm_c610$x, y=fit_dnorm_c610$f)

#Calculating exponential distribution
exp_c6_2010_ <- fitdistrplus::fitdist(data=c_6_2010$DURATION%>% unlist() %>% as.numeric(), "exp", method="mle", optim.method="Nelder-Mead", weights = round(c_6_2010$WGHT_EPI))

summary(exp_c6_2010_)

fit_dexp_c610 <- data.frame(f = dexp(c_6_2010$DURATION, rate = exp_c6_2010_$estimate[1]), 
                       x = c_6_2010$DURATION, type = "exp")

plot(x = fit_dexp_c610$x, y = fit_dexp_c610$f)

```

Now let's compare these models AIC and BIC to see which fits the walk data best:

```{r}
#comparing these models AIC and BIC to see which fits the walk data best:
broom::glance(MASS::fitdistr(c_6_2010$DURATION%>% unlist() %>% as.numeric(),"gamma"))
broom::glance(MASS::fitdistr(c_6_2010$DURATION%>% unlist() %>% as.numeric(),"normal"))
broom::glance(MASS::fitdistr(c_6_2010$DURATION%>% unlist() %>% as.numeric(),"exponential"))
```

So, gamma has largest logLik and the smallest AIC and BIC. we will pick gamma function for cycling trips in 2010!

```{r}
cycling_610_gamma <- gamma_c6_2010_
c_6_2010 <- c_6_2010 %>%
 mutate(f_6 = dgamma(DURATION, cycling_610_gamma$estimate["shape"],cycling_610_gamma$estimate["rate"] )) 
summary(c_6_2010$f_6)
```

###Destination :Outdoors (9)

using a skew vs. kurtois graph to descriptive statistics of data

```{r creating Cullen and Frey graph for cycling 2010}
# creating a skew vs. kurtois graph for cycling 2010

# Filter the data based on the "destination" column
 c_9_2010 <- cycling_2010 %>%
  filter(destination == "9")
count <- sum (cycling_2010$destination == "9")
print(count)
descdist(c_9_2010$DURATION %>% unlist() %>% as.numeric(), discrete=FALSE, boot=500)
```
As shown in the Cullen and Frey graph, we see that gamma, normal, poisson and exponential will likely be the best fit according to the graph above. Then we compare these models to find the best model.

```{r}
# Based on the skew vs. kurtois graph the best distribution

#Calculating gamma distribution 
gamma_c9_2010_ <- fitdistrplus::fitdist(data=c_9_2010$DURATION%>% unlist() %>% as.numeric(), "gamma", method="mle", optim.method="Nelder-Mead", weights = round(c_9_2010$WGHT_EPI))

fit_dgamma_c910 <- data.frame(f = dgamma(c_9_2010$DURATION, shape = gamma_c9_2010_$estimate[1], rate = gamma_c9_2010_$estimate[2]), x = c_9_2010$DURATION, type = "Gamma")

summary(gamma_c9_2010_)

plot(x= fit_dgamma_c910$x, y=fit_dgamma_c910$f)

#Calculating normal distribution
norm_c9_2010_ <- fitdistrplus::fitdist(data=c_9_2010$DURATION%>% unlist() %>% as.numeric(), "norm", method="mle", optim.method="Nelder-Mead", weights = round(c_9_2010$WGHT_EPI))

summary(norm_c9_2010_)

fit_dnorm_c910 <- data.frame(f = dnorm(c_9_2010$DURATION, mean = norm_c9_2010_$estimate[1], sd = norm_c9_2010_$estimate[2]), x = c_9_2010$DURATION, type = "norm")

plot(x= fit_dnorm_c910$x, y=fit_dnorm_c910$f)

#Calculating poisson distribution
pois_c9_2010_ <- fitdistrplus::fitdist(data=c_9_2010$DURATION%>% unlist() %>% as.numeric(), "pois", method="mle", optim.method="Nelder-Mead", weights = round(c_9_2010$WGHT_EPI))

summary(pois_c9_2010_)

fit_dpois_c910 <- data.frame(f = dpois(c_9_2010$DURATION, lambda = pois_c9_2010_$estimate[1]), x = c_9_2010$DURATION, type = "pois")

plot(x= fit_dpois_c910$x, y=fit_dpois_c910$f)

#Calculating exponential distribution
exp_c9_2010_ <- fitdistrplus::fitdist(data=c_9_2010$DURATION%>% unlist() %>% as.numeric(), "exp", method="mle", optim.method="Nelder-Mead", weights = round(c_9_2010$WGHT_EPI))

summary(exp_c9_2010_)

fit_dexp_c910 <- data.frame(f = dexp(c_9_2010$DURATION, rate = exp_c9_2010_$estimate[1]), 
                       x = c_9_2010$DURATION, type = "exp")

plot(x = fit_dexp_c910$x, y = fit_dexp_c910$f)

```

Now let's compare these models AIC and BIC to see which fits the walk data best:

```{r}
#comparing these models AIC and BIC to see which fits the walk data best:
broom::glance(MASS::fitdistr(c_9_2010$DURATION%>% unlist() %>% as.numeric(),"gamma"))
broom::glance(MASS::fitdistr(c_9_2010$DURATION%>% unlist() %>% as.numeric(),"normal"))
broom::glance(MASS::fitdistr(c_9_2010$DURATION%>% unlist() %>% as.numeric(),"poisson"))
broom::glance(MASS::fitdistr(c_9_2010$DURATION%>% unlist() %>% as.numeric(),"exponential"))
```

So, exponential has largest logLik and the smallest AIC and BIC. we will pick exponential function for cycling trips in 2010!

```{r}
cycling_910_exp <- exp_c9_2010_
c_9_2010 <- c_9_2010 %>%
 mutate(f_9 = dexp(DURATION, cycling_910_exp$estimate["rate"] )) 
summary(c_9_2010$f_9)
```

###Destination :Library (10)

using a skew vs. kurtois graph to descriptive statistics of data

```{r creating Cullen and Frey graph for cycling 2010}
# creating a skew vs. kurtois graph for cycling 2010

# Filter the data based on the "destination" column
 c_10_2010 <- cycling_2010 %>%
  filter(destination == "10") 
count <- sum(cycling_2010$destination == "10")
print(count)
#descdist(c_10_2010$DURATION %>% unlist() %>% as.numeric(), discrete=FALSE, boot=500)
```



### Calculating impedance function for cycling in 2005

using a skew vs. kurtois graph to descriptive statistics of data:

```{r creating Cullen and Frey graph for cycling 2005}
# creating a skew vs. kurtois graph for cycling 2005

descdist(cycling_2005$DURATION %>% unlist() %>% as.numeric(), discrete=FALSE, boot=500)
```

As shown in the Cullen and Frey graph, we see that gamma,weibull,lognorm and exponential will likely be the best fit according to the graph above. Then we compare these models to find the best model.

```{r}
summary(cycling_2005$DURATION)
```

```{r}

# Based on the skew vs. kurtois graph the best distribution

#Calculating gamma distribution

gamma_c_2005_ <- fitdistrplus::fitdist(data=cycling_2005$DURATION%>% unlist() %>% as.numeric(), "gamma", method="mle", optim.method="Nelder-Mead", weights = round(cycling_2005$WGHT_EPI))


fit_dgamma <- data.frame(f = dgamma(cycling_2005$DURATION, shape = gamma_c_2005_$estimate[1], rate = gamma_c_2005_$estimate[2]), x = cycling_2005$DURATION, type = "gamma")

summary(gamma_c_2005_)

plot(x= fit_dgamma$x, y=fit_dgamma$f)


#Calculating exponential distribution
exp_c_2005_ <- fitdistrplus::fitdist(data=cycling_2005$DURATION%>% unlist() %>% as.numeric(), "exp", method="mle", optim.method="Nelder-Mead", weights = round(cycling_2005$WGHT_EPI))

summary(exp_c_2005_)

fit_dexp <- data.frame(f = dexp(cycling_2005$DURATION, rate = exp_c_2005_$estimate[1]), x = cycling_2005$DURATION, type = "exp")

plot(x= fit_dexp$x, y=fit_dexp$f)

#Calculating lognormal distribution
lnorm_c_2005_ <- fitdistrplus::fitdist(data=cycling_2005$DURATION%>% unlist() %>% as.numeric(), "lnorm", method="mle", optim.method="Nelder-Mead", weights = round(cycling_2005$WGHT_EPI))

summary(lnorm_c_2005_)

fit_dlnorm <- data.frame(f = dlnorm(cycling_2005$DURATION, meanlog = lnorm_c_2005_$estimate[1] , sdlog = lnorm_c_2005_$estimate[2]), x = cycling_2005$DURATION, type = "lnorm")

plot(x= fit_dlnorm$x, y=fit_dlnorm$f)


#Calculating weibull distribution
weibull_c_2005_ <- fitdistrplus::fitdist(data=cycling_2005$DURATION%>% unlist() %>% as.numeric(), "weibull", method="mle", optim.method="Nelder-Mead", weights = round(cycling_2005$WGHT_EPI))

summary(weibull_c_2005_)

fit_dweibull <- data.frame(f = dweibull(cycling_2005$DURATION, shape = weibull_c_2005_$estimate[1], scale = weibull_c_2005_$estimate[2]), x = cycling_2005$DURATION, type = "weibull")

plot(x= fit_dweibull$x, y=fit_dweibull$f)

```

Now let's compare these models based on AIC and BIC to see which fits the walk data best:

```{r}
#comparing these models AIC and BIC to see which fits the walk data best:
broom::glance(MASS::fitdistr(cycling_2005$DURATION%>% unlist() %>% as.numeric(),"gamma"))
broom::glance(MASS::fitdistr(cycling_2005$DURATION%>% unlist() %>% as.numeric(),"exponential"))
broom::glance(MASS::fitdistr(cycling_2005$DURATION%>% unlist() %>% as.numeric(),"weibull"))
broom::glance(MASS::fitdistr(cycling_2005$DURATION%>% unlist() %>% as.numeric(),"lognormal"))
```

So, gamma has largest logLik and the smallest AIC and BIC. we will pick gamma function for cycling trips in 2005!

```{r}
cycling_2005_gamma <- gamma_c_2005_
cycling_2005 <- cycling_2005 %>%
 mutate(f = dgamma(DURATION, cycling_2005_gamma$estimate[1] , cycling_2005_gamma$estimate[2])) 
summary(cycling_2005$f)

```


###Destination : Cyling - Home (1), 2005

using a skew vs. kurtois graph to descriptive statistics of data

```{r creating Cullen and Frey graph for cycling 2005}
# creating a skew vs. kurtois graph for cycling 2005

# Filter the data based on the "destination" column
 c_1_2005 <- cycling_2005 %>%
  filter(destination == "1")   
descdist(c_1_2005$DURATION %>% unlist() %>% as.numeric(), discrete=FALSE, boot=500)
```

As shown in the Cullen and Frey graph, we see that gamma,weibull and exponential will likely be the best fit according to the graph above. Then we compare these models to find the best model.

```{r}
# Based on the skew vs. kurtois graph the best distribution

#Calculating gamma distribution 
gamma_c1_2005_ <- fitdistrplus::fitdist(data=c_1_2005$DURATION%>% unlist() %>% as.numeric(), "gamma", method="mle", optim.method="Nelder-Mead", weights = round(c_1_2005$WGHT_EPI))

fit_dgamma_c105 <- data.frame(f = dgamma(c_1_2005$DURATION, shape = gamma_c1_2005_$estimate[1], rate = gamma_c1_2005_$estimate[2]), x = c_1_2005$DURATION, type = "Gamma")

summary(gamma_c1_2005_)

plot(x= fit_dgamma_c105$x, y=fit_dgamma_c105$f)

#Calculating weibull distribution
weibull_c1_2005_ <- fitdistrplus::fitdist(data=c_1_2005$DURATION%>% unlist() %>% as.numeric(), "weibull", method="mle", optim.method="Nelder-Mead", weights = round(c_1_2005$WGHT_EPI))

summary(weibull_c1_2005_)

fit_dweibull_c105 <- data.frame(f = dweibull(c_1_2005$DURATION, shape = weibull_c1_2005_$estimate[1], scale = weibull_c1_2005_$estimate[2]), x = c_1_2005$DURATION, type = "weibull")

plot(x= fit_dweibull_c105$x, y=fit_dweibull_c105$f)

#Calculating exponential distribution
exp_c1_2005_ <- fitdistrplus::fitdist(data=c_1_2005$DURATION%>% unlist() %>% as.numeric(), "exp", method="mle", optim.method="Nelder-Mead", weights = round(c_1_2005$WGHT_EPI))

summary(exp_c1_2005_)

fit_dexp_c105 <- data.frame(f = dexp(c_1_2005$DURATION, rate = exp_c1_2005_$estimate[1]), 
                       x = c_1_2005$DURATION, type = "exp")

plot(x = fit_dexp_c105$x, y = fit_dexp_c105$f)

```

Now let's compare these models AIC and BIC to see which fits the walk data best:

```{r}
#comparing these models AIC and BIC to see which fits the walk data best:
broom::glance(MASS::fitdistr(c_1_2005$DURATION%>% unlist() %>% as.numeric(),"gamma"))
broom::glance(MASS::fitdistr(c_1_2005$DURATION%>% unlist() %>% as.numeric(),"weibull"))
broom::glance(MASS::fitdistr(c_1_2005$DURATION%>% unlist() %>% as.numeric(),"exponential"))
```

So, gamma has largest logLik and the smallest AIC and BIC. we will pick gamma function for cycling trips in 2005!

```{r}
cycling_105_gamma <- gamma_c1_2005_
c_1_2005 <- c_1_2005 %>%
 mutate(f_1 = dgamma(DURATION, cycling_105_gamma$estimate["shape"], cycling_105_gamma$estimate["rate"])) 
summary(c_1_2005$f_1)
```


###Destination : Cycling - Work or school (2 and 8), 2005

using a skew vs. kurtois graph to descriptive statistics of data

```{r creating Cullen and Frey graph for cycling 2005}
# creating a skew vs. kurtois graph for cycling 2005

# Filter the data based on the "destination" column
 c_2_2005 <- cycling_2005 %>%
  filter(destination %in% c("2", "8"))   
descdist(c_2_2005$DURATION %>% unlist() %>% as.numeric(), discrete=FALSE, boot=500)
```

As shown in the Cullen and Frey graph, we see that gamma and exponential will likely be the best fit according to the graph above. Then we compare these models to find the best model.

```{r}
# Based on the skew vs. kurtois graph the best distribution

#Calculating gamma distribution 
gamma_c2_2005_ <- fitdistrplus::fitdist(data=c_2_2005$DURATION%>% unlist() %>% as.numeric(), "gamma", method="mle", optim.method="Nelder-Mead", weights = round(c_2_2005$WGHT_EPI))

fit_dgamma_c205 <- data.frame(f = dgamma(c_2_2005$DURATION, shape = gamma_c2_2005_$estimate[1], rate = gamma_c2_2005_$estimate[2]), x = c_2_2005$DURATION, type = "Gamma")

summary(gamma_c2_2005_)

plot(x= fit_dgamma_c205$x, y=fit_dgamma_c205$f)


#Calculating exponential distribution
exp_c2_2005_ <- fitdistrplus::fitdist(data=c_2_2005$DURATION%>% unlist() %>% as.numeric(), "exp", method="mle", optim.method="Nelder-Mead", weights = round(c_2_2005$WGHT_EPI))

summary(exp_c2_2005_)

fit_dexp_c205 <- data.frame(f = dexp(c_2_2005$DURATION, rate = exp_c2_2005_$estimate[1]), 
                       x = c_2_2005$DURATION, type = "exp")

plot(x = fit_dexp_c205$x, y = fit_dexp_c205$f)


```

Now let's compare these models AIC and BIC to see which fits the walk data best:

```{r}
#comparing these models AIC and BIC to see which fits the walk data best:
broom::glance(MASS::fitdistr(c_2_2005$DURATION%>% unlist() %>% as.numeric(),"gamma"))
broom::glance(MASS::fitdistr(c_2_2005$DURATION%>% unlist() %>% as.numeric(),"exponential"))
```

So, gamma has largest logLik and the smallest AIC and BIC. we will pick gamma function for cycling trips in 2005!

```{r}
cycling_205_gamma <- gamma_c2_2005_
c_2_2005 <- c_2_2005 %>%
 mutate(f_2 = dgamma(DURATION, cycling_205_gamma$estimate["shape"], cycling_205_gamma$estimate["rate"])) 
summary(c_2_2005$f_2)
```


###Destination : cycling - other's home (3), 2005

using a skew vs. kurtois graph to descriptive statistics of data

```{r creating Cullen and Frey graph for cycling 2005}
# creating a skew vs. kurtois graph for cycling 2005

# Filter the data based on the "destination" column
 c_3_2005 <- cycling_2005 %>%
  filter(destination == "3")   
descdist(c_3_2005$DURATION %>% unlist() %>% as.numeric(), discrete=FALSE, boot=500)
```

As shown in the Cullen and Frey graph, we see that poisson and normal will likely be the best fit according to the graph above. Then we compare these models to find the best model.

```{r}
# Based on the skew vs. kurtois graph the best distribution

#Calculating normal distribution 
norm_c3_2005_ <- fitdistrplus::fitdist(data=c_3_2005$DURATION%>% unlist() %>% as.numeric(), "norm", method="mle", optim.method="Nelder-Mead", weights = round(c_3_2005$WGHT_EPI))

fit_dnorm_c305 <- data.frame(f = dnorm(c_3_2005$DURATION, mean = norm_c3_2005_$estimate[1], sd = norm_c3_2005_$estimate[2]), x = c_3_2005$DURATION, type = "norm")

summary(norm_c3_2005_)

plot(x= fit_dnorm_c305$x, y=fit_dnorm_c305$f)

#Calculating poisson distribution
pois_c3_2005_ <- fitdistrplus::fitdist(data=c_3_2005$DURATION%>% unlist() %>% as.numeric(), "pois", method="mle", optim.method="Nelder-Mead", weights = round(c_3_2005$WGHT_EPI))

summary(pois_c3_2005_)

fit_dpois_c305 <- data.frame(f = dpois(c_3_2005$DURATION, lambda = pois_c3_2005_$estimate[1]), 
                       x = c_3_2005$DURATION, type = "pois")

plot(x = fit_dpois_c305$x, y = fit_dpois_c305$f)

```

Now let's compare these models AIC and BIC to see which fits the walk data best:

```{r}
#comparing these models AIC and BIC to see which fits the walk data best:
broom::glance(MASS::fitdistr(c_3_2005$DURATION%>% unlist() %>% as.numeric(),"poisson"))
broom::glance(MASS::fitdistr(c_3_2005$DURATION%>% unlist() %>% as.numeric(),"normal"))
```

So, normal has largest logLik and the smallest AIC and BIC. we will pick normal function for cycling trips in 2005!

```{r}
cycling_305_norm <- norm_c3_2005_
c_3_2005 <- c_3_2005 %>%
 mutate(f_3 = dnorm(DURATION, cycling_305_norm$estimate["mean"], cycling_305_norm$estimate["sd"])) 
summary(c_3_2005$f_3)
```

###Destination : cycling - Restaurant/bar (4), 2005

using a skew vs. kurtois graph to descriptive statistics of data

```{r creating Cullen and Frey graph for cycling 2005}
# creating a skew vs. kurtois graph for cycling 2005

# Filter the data based on the "destination" column
 c_4_2005 <- cycling_2005 %>%
  filter(destination == "4")   
descdist(c_4_2005$DURATION %>% unlist() %>% as.numeric(), discrete=FALSE, boot=500)
```

As shown in the Cullen and Frey graph, we see that normal, poisson and exponential will likely be the best fit according to the graph above. Then we compare these models to find the best model.

```{r}
# Based on the skew vs. kurtois graph the best distribution

#Calculating normal distribution 
norm_c4_2005_ <- fitdistrplus::fitdist(data=c_4_2005$DURATION%>% unlist() %>% as.numeric(), "norm", method="mle", optim.method="Nelder-Mead", weights = round(c_4_2005$WGHT_EPI))

fit_dnorm_c405 <- data.frame(f = dnorm(c_4_2005$DURATION, mean = norm_c4_2005_$estimate[1], sd = norm_c4_2005_$estimate[2]), x = c_4_2005$DURATION, type = "norm")

summary(norm_c4_2005_)

plot(x= fit_dnorm_c405$x, y=fit_dnorm_c405$f)

#Calculating poisson distribution
pois_c4_2005_ <- fitdistrplus::fitdist(data=c_4_2005$DURATION%>% unlist() %>% as.numeric(), "pois", method="mle", optim.method="Nelder-Mead", weights = round(c_4_2005$WGHT_EPI))

summary(pois_c4_2005_)

fit_dpois_c405 <- data.frame(f = dpois(c_4_2005$DURATION, lambda = pois_c4_2005_$estimate[1]), x = c_4_2005$DURATION, type = "pois")

plot(x= fit_dpois_c405$x, y=fit_dpois_c405$f)

#Calculating exponential distribution
exp_c4_2005_ <- fitdistrplus::fitdist(data=c_4_2005$DURATION%>% unlist() %>% as.numeric(), "exp", method="mle", optim.method="Nelder-Mead", weights = round(c_4_2005$WGHT_EPI))

summary(exp_c4_2005_)

fit_dexp_c405 <- data.frame(f = dexp(c_4_2005$DURATION, rate = exp_c4_2005_$estimate[1]), 
                       x = c_4_2005$DURATION, type = "exp")

plot(x = fit_dexp_c405$x, y = fit_dexp_c405$f)

```

Now let's compare these models AIC and BIC to see which fits the walk data best:

```{r}
#comparing these models AIC and BIC to see which fits the walk data best:
broom::glance(MASS::fitdistr(c_4_2005$DURATION%>% unlist() %>% as.numeric(),"normal"))
broom::glance(MASS::fitdistr(c_4_2005$DURATION%>% unlist() %>% as.numeric(),"poisson"))
broom::glance(MASS::fitdistr(c_4_2005$DURATION%>% unlist() %>% as.numeric(),"exponential"))
```

So, normal has largest logLik and the smallest AIC and BIC. we will pick normal function for cycling trips in 2005!

```{r}
cycling_405_norm <- norm_c4_2005_
c_4_2005 <- c_4_2005 %>%
 mutate(f_4 = dnorm(DURATION, cycling_405_norm$estimate["mean"], cycling_405_norm$estimate["sd"])) 
summary(c_4_2005$f_4)
```

###Destination : Cycling -  Place of worship (5), 2005

using a skew vs. kurtois graph to descriptive statistics of data

```{r creating Cullen and Frey graph for cycling 2005}
# creating a skew vs. kurtois graph for cycling 2005

# Filter the data based on the "destination" column
 c_5_2005 <- cycling_2005 %>%
  filter(destination == "5") 
count <- sum(cycling_2005$destination == "5")
print(count)
#descdist(c_5_2005$DURATION %>% unlist() %>% as.numeric(), discrete=FALSE, boot=500)
```


###Destination :Grocery store, other stores or mall (6 and 7)

using a skew vs. kurtois graph to descriptive statistics of data

```{r creating Cullen and Frey graph for cycling 2005}
# creating a skew vs. kurtois graph for cycling 2005

# Filter the data based on the "destination" column
 c_6_2005 <- cycling_2005 %>%
  filter(destination %in% c("6", "7"))   
descdist(c_6_2005$DURATION %>% unlist() %>% as.numeric(), discrete=FALSE, boot=500)
```

As shown in the Cullen and Frey graph, we see that gamma,poisson and exponential will likely be the best fit according to the graph above. Then we compare these models to find the best model.

```{r}
# Based on the skew vs. kurtois graph the best distribution

#Calculating gamma distribution 
gamma_c6_2005_ <- fitdistrplus::fitdist(data=c_6_2005$DURATION%>% unlist() %>% as.numeric(), "gamma", method="mle", optim.method="Nelder-Mead", weights = round(c_6_2005$WGHT_EPI))

fit_dgamma_c605 <- data.frame(f = dgamma(c_6_2005$DURATION, shape = gamma_c6_2005_$estimate[1], rate = gamma_c6_2005_$estimate[2]), x = c_6_2005$DURATION, type = "Gamma")

summary(gamma_c6_2005_)

plot(x= fit_dgamma_c605$x, y=fit_dgamma_c605$f)

#Calculating poisson distribution
pois_c6_2005_ <- fitdistrplus::fitdist(data=c_6_2005$DURATION%>% unlist() %>% as.numeric(), "pois", method="mle", optim.method="Nelder-Mead", weights = round(c_6_2005$WGHT_EPI))

summary(pois_c6_2005_)

fit_dpois_c605 <- data.frame(f = dpois(c_6_2005$DURATION, lambda = pois_c6_2005_$estimate[1]), x = c_6_2005$DURATION, type = "pois")

plot(x= fit_dpois_c605$x, y=fit_dpois_c605$f)

#Calculating exponential distribution
exp_c6_2005_ <- fitdistrplus::fitdist(data=c_6_2005$DURATION%>% unlist() %>% as.numeric(), "exp", method="mle", optim.method="Nelder-Mead", weights = round(c_6_2005$WGHT_EPI))

summary(exp_c6_2005_)

fit_dexp_c605 <- data.frame(f = dexp(c_6_2005$DURATION, rate = exp_c6_2005_$estimate[1]), 
                       x = c_6_2005$DURATION, type = "exp")

plot(x = fit_dexp_c605$x, y = fit_dexp_c605$f)

```

Now let's compare these models AIC and BIC to see which fits the walk data best:

```{r}
#comparing these models AIC and BIC to see which fits the walk data best:
broom::glance(MASS::fitdistr(c_6_2005$DURATION%>% unlist() %>% as.numeric(),"gamma"))
broom::glance(MASS::fitdistr(c_6_2005$DURATION%>% unlist() %>% as.numeric(),"poisson"))
broom::glance(MASS::fitdistr(c_6_2005$DURATION%>% unlist() %>% as.numeric(),"exponential"))
```

So, gamma has largest logLik and the smallest AIC and BIC. we will pick gamma function for cycling trips in 2005!

```{r}
cycling_605_gamma <- gamma_c6_2005_
c_6_2005 <- c_6_2005 %>%
 mutate(f_6 = dgamma(DURATION, cycling_605_gamma$estimate["shape"], cycling_605_gamma$estimate["rate"])) 
summary(c_6_2005$f_6)
```

###Destination : Cycling - Outdoors (9), 2005

using a skew vs. kurtois graph to descriptive statistics of data

```{r creating Cullen and Frey graph for cycling 2005}
# creating a skew vs. kurtois graph for cycling 2005

# Filter the data based on the "destination" column
 c_9_2005 <- cycling_2005 %>%
  filter(destination == "9")   
descdist(c_9_2005$DURATION %>% unlist() %>% as.numeric(), discrete=FALSE, boot=500)
```

As shown in the Cullen and Frey graph, we see that gamma,normal, weibull, lognormal and exponential will likely be the best fit according to the graph above. Then we compare these models to find the best model.

```{r}
# Based on the skew vs. kurtois graph the best distribution

#Calculating gamma distribution 
gamma_c9_2005_ <- fitdistrplus::fitdist(data=c_9_2005$DURATION%>% unlist() %>% as.numeric(), "gamma", method="mle", optim.method="Nelder-Mead", weights = round(c_9_2005$WGHT_EPI))

fit_dgamma_c905 <- data.frame(f = dgamma(c_9_2005$DURATION, shape = gamma_c9_2005_$estimate[1], rate = gamma_c9_2005_$estimate[2]), x = c_9_2005$DURATION, type = "Gamma")

summary(gamma_c9_2005_)

plot(x= fit_dgamma_c905$x, y=fit_dgamma_c905$f)

#Calculating exponential distribution
exp_c9_2005_ <- fitdistrplus::fitdist(data=c_9_2005$DURATION%>% unlist() %>% as.numeric(), "exp", method="mle", optim.method="Nelder-Mead", weights = round(c_9_2005$WGHT_EPI))

summary(exp_c9_2005_)

fit_dexp_c905 <- data.frame(f = dexp(c_9_2005$DURATION, rate = exp_c9_2005_$estimate[1]), 
                       x = c_9_2005$DURATION, type = "exp")

plot(x = fit_dexp_c905$x, y = fit_dexp_c905$f)

#Calculating normal distribution
norm_c9_2005_ <- fitdistrplus::fitdist(data=c_9_2005$DURATION%>% unlist() %>% as.numeric(), "norm", method="mle", optim.method="Nelder-Mead", weights = round(c_9_2005$WGHT_EPI))

summary(norm_c9_2005_)

fit_dnorm_c905 <- data.frame(f = dnorm(c_9_2005$DURATION, mean = norm_c9_2005_$estimate[1], sd = norm_c9_2005_$estimate[2]),  x = c_9_2005$DURATION, type = "norm")

plot(x = fit_dnorm_c905$x, y = fit_dnorm_c905$f)


#Calculating weibull distribution
weibull_c9_2005_ <- fitdistrplus::fitdist(data=c_9_2005$DURATION%>% unlist() %>% as.numeric(), "weibull", method="mle", optim.method="Nelder-Mead", weights = round(c_9_2005$WGHT_EPI))

summary(weibull_c9_2005_)

fit_dweibull_c905 <- data.frame(f = dweibull(c_9_2005$DURATION, shape = weibull_c9_2005_$estimate[1], scale = weibull_c9_2005_$estimate[2]),  x = c_9_2005$DURATION, type = "weibull")

plot(x = fit_dweibull_c905$x, y = fit_dweibull_c905$f)

#Calculating lognormal distribution
lnorm_c9_2005_ <- fitdistrplus::fitdist(data=c_9_2005$DURATION%>% unlist() %>% as.numeric(), "lnorm", method="mle", optim.method="Nelder-Mead", weights = round(c_9_2005$WGHT_EPI))

summary(lnorm_c9_2005_)

fit_dlnorm_c905 <- data.frame(f = dlnorm(c_9_2005$DURATION, meanlog = lnorm_c9_2005_$estimate[1], sdlog = lnorm_c9_2005_$estimate[2]),  x = c_9_2005$DURATION, type = "lnorm")

plot(x = fit_dlnorm_c905$x, y = fit_dlnorm_c905$f)


```

Now let's compare these models AIC and BIC to see which fits the walk data best:

```{r}
#comparing these models AIC and BIC to see which fits the walk data best:
broom::glance(MASS::fitdistr(c_9_2005$DURATION%>% unlist() %>% as.numeric(),"gamma"))
broom::glance(MASS::fitdistr(c_9_2005$DURATION%>% unlist() %>% as.numeric(),"weibull"))
broom::glance(MASS::fitdistr(c_9_2005$DURATION%>% unlist() %>% as.numeric(),"lognormal"))
broom::glance(MASS::fitdistr(c_9_2005$DURATION%>% unlist() %>% as.numeric(),"exponential"))
broom::glance(MASS::fitdistr(c_9_2005$DURATION%>% unlist() %>% as.numeric(),"normal"))
```

So, gamma has largest logLik and the smallest AIC and BIC. we will pick gamma function for cycling trips in 2005!

```{r}
cycling_905_gamma <- gamma_c9_2005_
c_9_2005 <- c_9_2005 %>%
 mutate(f_9 = dgamma(DURATION, cycling_905_gamma$estimate["shape"], cycling_905_gamma$estimate["rate"])) 
summary(c_9_2005$f_9)
```


###Destination : Cycling -Outdoors (10), 2005

using a skew vs. kurtois graph to descriptive statistics of data

```{r creating Cullen and Frey graph for cycling 2005}
# creating a skew vs. kurtois graph for cycling 2005

# Filter the data based on the "destination" column
c_10_2005 <- cycling_2005 %>%
  filter(destination == "10")   
count <- sum (cycling_2005$destination == "10")
print (count)

#descdist(c_10_2005$DURATION %>% unlist() %>% as.numeric(), discrete=FALSE, boot=500)
```


### Calculating impedance function for cycling in 1998

using a skew vs. kurtois graph to descriptive statistics of data:

```{r creating Cullen and Frey graph for cycling 1998}
# creating a skew vs. kurtois graph for cycling 1998

descdist(cycling_1998$DURATION %>% unlist() %>% as.numeric(), discrete=FALSE, boot=500)
```

As shown in the Cullen and Frey graph, we see that gamma and exponential will likely be the best fit according to the graph above. Then we compare these models to find the best model.

```{r}
summary(cycling_1998$DURATION)
```

```{r}

# Based on the skew vs. kurtois graph the best distribution

#Calculating gamma distribution

gamma_c_1998_ <- fitdistrplus::fitdist(data=cycling_1998$DURATION%>% unlist() %>% as.numeric(), "gamma", method="mle", optim.method="Nelder-Mead", weights = round(cycling_1998$WGHT_EPI))


fit_dgamma <- data.frame(f = dgamma(cycling_1998$DURATION, shape = gamma_c_1998_$estimate[1], rate = gamma_c_1998_$estimate[2]), x = cycling_1998$DURATION, type = "gamma")

summary(gamma_c_1998_)

plot(x= fit_dgamma$x, y=fit_dgamma$f)


#Calculating exponential distribution
exp_c_1998_ <- fitdistrplus::fitdist(data=cycling_1998$DURATION%>% unlist() %>% as.numeric(), "exp", method="mle", optim.method="Nelder-Mead", weights = round(cycling_1998$WGHT_EPI))

summary(exp_c_1998_)

fit_dexp <- data.frame(f = dexp(cycling_1998$DURATION, rate = exp_c_1998_$estimate[1]), x = cycling_1998$DURATION, type = "exp")

plot(x= fit_dexp$x, y=fit_dexp$f)


```

Now let's compare these models based on AIC and BIC to see which fits the walk data best:

```{r}
#comparing these models AIC and BIC to see which fits the walk data best:
broom::glance(MASS::fitdistr(cycling_1998$DURATION%>% unlist() %>% as.numeric(),"gamma"))
broom::glance(MASS::fitdistr(cycling_1998$DURATION%>% unlist() %>% as.numeric(),"exponential"))
```

So, gamma has largest logLik and the smallest AIC and BIC. we will pick gamma function for cycling trips in 1998!

```{r}
cycling_1998_gamma <- gamma_c_1998_
cycling_1998 <- cycling_1998 %>%
 mutate(f = dgamma(DURATION, cycling_1998_gamma$estimate[1] , cycling_1998_gamma$estimate[2])) 
summary(cycling_1998$f)

```


### Destination : Cycling - Home  (1), 1998

using a skew vs. kurtois graph to descriptive statistics of data

```{r creating Cullen and Frey graph for cycling 1998}
# creating a skew vs. kurtois graph for cycling 1998

# Filter the data based on the "destination" column
 c_1_1998 <- cycling_1998 %>%
  filter(destination == "1")   
descdist(c_1_1998$DURATION %>% unlist() %>% as.numeric(), discrete=FALSE, boot=500)
```

As shown in the Cullen and Frey graph, we see that gamma and exponential will likely be the best fit according to the graph above. Then we compare these models to find the best model.

```{r}
# Based on the skew vs. kurtois graph the best distribution

#Calculating gamma distribution 
gamma_c1_1998_ <- fitdistrplus::fitdist(data=c_1_1998$DURATION%>% unlist() %>% as.numeric(), "gamma", method="mle", optim.method="Nelder-Mead", weights = round(c_1_1998$WGHT_EPI))

fit_dgamma_c198 <- data.frame(f = dgamma(c_1_1998$DURATION, shape = gamma_c1_1998_$estimate[1], rate = gamma_c1_1998_$estimate[2]), x = c_1_1998$DURATION, type = "Gamma")

summary(gamma_c1_1998_)

plot(x= fit_dgamma_c198$x, y=fit_dgamma_c198$f)

#Calculating exponential distribution
exp_c1_1998_ <- fitdistrplus::fitdist(data=c_1_1998$DURATION%>% unlist() %>% as.numeric(), "exp", method="mle", optim.method="Nelder-Mead", weights = round(c_1_1998$WGHT_EPI))

summary(exp_c1_1998_)

fit_dexp_c198 <- data.frame(f = dexp(c_1_1998$DURATION, rate = exp_c1_1998_$estimate[1]), 
                       x = c_1_1998$DURATION, type = "exp")

plot(x = fit_dexp_c198$x, y = fit_dexp_c198$f)

```

Now let's compare these models AIC and BIC to see which fits the walk data best:

```{r}
#comparing these models AIC and BIC to see which fits the walk data best:
broom::glance(MASS::fitdistr(c_1_1998$DURATION%>% unlist() %>% as.numeric(),"gamma"))
broom::glance(MASS::fitdistr(c_1_1998$DURATION%>% unlist() %>% as.numeric(),"exponential"))
```

So, gamma has largest logLik and the smallest AIC and BIC. we will pick gamma function for cycling trips in 1998!

```{r}
cycling_198_gamma <- gamma_c1_1998_
c_1_1998 <- c_1_1998 %>%
 mutate(f_1 = dgamma(DURATION, cycling_198_gamma$estimate["shape"], cycling_198_gamma$estimate["rate"])) 
summary(c_1_1998$f_1)
```


### Destination :cycling- Work place (2), 1998

using a skew vs. kurtois graph to descriptive statistics of data

```{r creating Cullen and Frey graph for cycling 1998}
# creating a skew vs. kurtois graph for cycling 1998

# Filter the data based on the "destination" column
 c_2_1998 <- cycling_1998 %>%
  filter(destination == "2")   
descdist(c_2_1998$DURATION %>% unlist() %>% as.numeric(), discrete=FALSE, boot=500)
```

As shown in the Cullen and Frey graph, we see that gamma , normal and exponential will likely be the best fit according to the graph above. Then we compare these models to find the best model.

```{r}
# Based on the skew vs. kurtois graph the best distribution

#Calculating gamma distribution 
gamma_c2_1998_ <- fitdistrplus::fitdist(data=c_2_1998$DURATION%>% unlist() %>% as.numeric(), "gamma", method="mle", optim.method="Nelder-Mead", weights = round(c_2_1998$WGHT_EPI))

fit_dgamma_c298 <- data.frame(f = dgamma(c_2_1998$DURATION, shape = gamma_c2_1998_$estimate[1], rate = gamma_c2_1998_$estimate[2]), x = c_2_1998$DURATION, type = "Gamma")

summary(gamma_c2_1998_)

plot(x= fit_dgamma_c298$x, y=fit_dgamma_c298$f)

#Calculating normal distribution 
norm_c2_1998_ <- fitdistrplus::fitdist(data=c_2_1998$DURATION%>% unlist() %>% as.numeric(), "norm", method="mle", optim.method="Nelder-Mead", weights = round(c_2_1998$WGHT_EPI))

fit_dnorm_c298 <- data.frame(f = dnorm(c_2_1998$DURATION, mean = norm_c2_1998_$estimate[1], sd = norm_c2_1998_$estimate[2]), x = c_2_1998$DURATION, type = "norm")

summary(norm_c2_1998_)

plot(x= fit_dnorm_c298$x, y=fit_dnorm_c298$f)

#Calculating exponential distribution
exp_c2_1998_ <- fitdistrplus::fitdist(data=c_2_1998$DURATION%>% unlist() %>% as.numeric(), "exp", method="mle", optim.method="Nelder-Mead", weights = round(c_2_1998$WGHT_EPI))

summary(exp_c2_1998_)

fit_dexp_c298 <- data.frame(f = dexp(c_2_1998$DURATION, rate = exp_c2_1998_$estimate[1]), 
                       x = c_2_1998$DURATION, type = "exp")

plot(x = fit_dexp_c298$x, y = fit_dexp_c298$f)

```

Now let's compare these models AIC and BIC to see which fits the walk data best:

```{r}
#comparing these models AIC and BIC to see which fits the walk data best:
broom::glance(MASS::fitdistr(c_2_1998$DURATION%>% unlist() %>% as.numeric(),"gamma"))
broom::glance(MASS::fitdistr(c_2_1998$DURATION%>% unlist() %>% as.numeric(),"normal"))
broom::glance(MASS::fitdistr(c_2_1998$DURATION%>% unlist() %>% as.numeric(),"exponential"))
```

So, gamma has largest logLik and the smallest AIC and BIC. we will pick gamma function for cycling trips in 1998!

```{r}
cycling_298_gamma <- gamma_c2_1998_
c_2_1998 <- c_2_1998 %>%
 mutate(f_2 = dgamma(DURATION, cycling_298_gamma$estimate["shape"], cycling_298_gamma$estimate["rate"])) 
summary(c_2_1998$f_2)
```

### Destination : Cycling - Other's Home (3), 1998

using a skew vs. kurtois graph to descriptive statistics of data

```{r creating Cullen and Frey graph for cycling 1998}
# creating a skew vs. kurtois graph for cycling 1998

# Filter the data based on the "destination" column
c_3_1998 <- cycling_1998 %>%
  filter(destination == "3")   
descdist(c_3_1998$DURATION %>% unlist() %>% as.numeric(), discrete=FALSE, boot=500)
```

As shown in the Cullen and Frey graph, we see that gamma, normal and exponential will likely be the best fit according to the graph above. Then we compare these models to find the best model.

```{r}
# Based on the skew vs. kurtois graph the best distribution

#Calculating gamma distribution 
gamma_c3_1998_ <- fitdistrplus::fitdist(data=c_3_1998$DURATION%>% unlist() %>% as.numeric(), "gamma", method="mle", optim.method="Nelder-Mead", weights = round(c_3_1998$WGHT_EPI))

fit_dgamma_c398 <- data.frame(f = dgamma(c_3_1998$DURATION, shape = gamma_c3_1998_$estimate[1], rate = gamma_c3_1998_$estimate[2]), x = c_3_1998$DURATION, type = "Gamma")

summary(gamma_c3_1998_)

plot(x= fit_dgamma_c398$x, y=fit_dgamma_c398$f)


#Calculating normal distribution 
norm_c3_1998_ <- fitdistrplus::fitdist(data=c_3_1998$DURATION%>% unlist() %>% as.numeric(), "norm", method="mle", optim.method="Nelder-Mead", weights = round(c_3_1998$WGHT_EPI))

fit_dnorm_c398 <- data.frame(f = dnorm(c_3_1998$DURATION, mean = norm_c3_1998_$estimate[1], sd = norm_c3_1998_$estimate[2]), x = c_3_1998$DURATION, type = "norm")

summary(norm_c3_1998_)

plot(x= fit_dnorm_c398$x, y=fit_dnorm_c398$f)

#Calculating exponential distribution
exp_c3_1998_ <- fitdistrplus::fitdist(data=c_3_1998$DURATION%>% unlist() %>% as.numeric(), "exp", method="mle", optim.method="Nelder-Mead", weights = round(c_3_1998$WGHT_EPI))

summary(exp_c3_1998_)

fit_dexp_c398 <- data.frame(f = dexp(c_3_1998$DURATION, rate = exp_c3_1998_$estimate[1]), 
                       x = c_3_1998$DURATION, type = "exp")

plot(x = fit_dexp_c398$x, y = fit_dexp_c398$f)

```

Now let's compare these models AIC and BIC to see which fits the walk data best:

```{r}
#comparing these models AIC and BIC to see which fits the walk data best:
broom::glance(MASS::fitdistr(c_3_1998$DURATION%>% unlist() %>% as.numeric(),"gamma"))
broom::glance(MASS::fitdistr(c_3_1998$DURATION%>% unlist() %>% as.numeric(),"normal"))
broom::glance(MASS::fitdistr(c_3_1998$DURATION%>% unlist() %>% as.numeric(),"exponential"))
```

So, gamma has largest logLik and the smallest AIC and BIC. we will pick gamma function for cycling trips in 1998!

```{r}
cycling_398_gamma <- gamma_c3_1998_
c_3_1998 <- c_3_1998 %>%
 mutate(f_3 = dgamma(DURATION, cycling_398_gamma$estimate["shape"], cycling_398_gamma$estimate["rate"])) 
summary(c_3_1998$f_3)
```



### Calculating impedance function for cycling in 1992

using a skew vs. kurtois graph to descriptive statistics of data:

```{r creating Cullen and Frey graph for cycling 1992}
# creating a skew vs. kurtois graph for cycling 1992

descdist(cycling_1992$DURATION %>% unlist() %>% as.numeric(), discrete=FALSE, boot=500)
```

As shown in the Cullen and Frey graph, we see that gamma, beta and exponential will likely be the best fit according to the graph above. Then we compare these models to find the best model.

```{r}
summary(cycling_1992$DURATION)
```

```{r}

# Based on the skew vs. kurtois graph the best distribution

#Calculating gamma distribution

gamma_c_1992_ <- fitdistrplus::fitdist(data=cycling_1992$DURATION%>% unlist() %>% as.numeric(), "gamma", method="mle", optim.method="Nelder-Mead", weights = round(cycling_1992$WGHT_EPI))


fit_dgamma <- data.frame(f = dgamma(cycling_1992$DURATION, shape = gamma_c_1992_$estimate[1], rate = gamma_c_1992_$estimate[2]), x = cycling_1992$DURATION, type = "gamma")

summary(gamma_c_1992_)

plot(x= fit_dgamma$x, y=fit_dgamma$f)


#Calculating exponential distribution
exp_c_1992_ <- fitdistrplus::fitdist(data=cycling_1992$DURATION%>% unlist() %>% as.numeric(), "exp", method="mle", optim.method="Nelder-Mead", weights = round(cycling_1992$WGHT_EPI))

summary(exp_c_1992_)

fit_dexp <- data.frame(f = dexp(cycling_1992$DURATION, rate = exp_c_1992_$estimate[1]), x = cycling_1992$DURATION, type = "exp")

plot(x= fit_dexp$x, y=fit_dexp$f)


```

Now let's compare these models based on AIC and BIC to see which fits the walk data best:

```{r}
#comparing these models AIC and BIC to see which fits the walk data best:
broom::glance(MASS::fitdistr(cycling_1992$DURATION%>% unlist() %>% as.numeric(),"gamma"))
broom::glance(MASS::fitdistr(cycling_1992$DURATION%>% unlist() %>% as.numeric(),"exponential"))
```

So, gamma has largest logLik and the smallest AIC and BIC. we will pick gamma function for cycling trips in 1998!

```{r}
cycling_1992_gamma <- gamma_c_1992_
cycling_1992 <- cycling_1992 %>%
 mutate(f = dgamma(DURATION, cycling_1992_gamma$estimate[1] , cycling_1992_gamma$estimate[2])) 
summary(cycling_1992$f)

```


### Destination : Cycling -Home (1), 1992

using a skew vs. kurtois graph to descriptive statistics of data

```{r creating Cullen and Frey graph for cycling 1992}
# creating a skew vs. kurtois graph for cycling 1992

# Filter the data based on the "destination" column
 c_1_1992 <- cycling_1992 %>%
  filter(destination == "1")   
descdist(c_1_1992$DURATION %>% unlist() %>% as.numeric(), discrete=FALSE, boot=500)
```

As shown in the Cullen and Frey graph, we see that gamma, weibull and exponential will likely be the best fit according to the graph above. Then we compare these models to find the best model.

```{r}
# Based on the skew vs. kurtois graph the best distribution

#Calculating gamma distribution 
gamma_c1_1992_ <- fitdistrplus::fitdist(data=c_1_1992$DURATION%>% unlist() %>% as.numeric(), "gamma", method="mle", optim.method="Nelder-Mead", weights = round(c_1_1992$WGHT_EPI))

fit_dgamma_c192 <- data.frame(f = dgamma(c_1_1992$DURATION, shape = gamma_c1_1992_$estimate[1], rate = gamma_c1_1992_$estimate[2]), x = c_1_1992$DURATION, type = "Gamma")

summary(gamma_c1_1992_)

plot(x= fit_dgamma_c192$x, y=fit_dgamma_c192$f)


#Calculating weibull distribution
 
weibull_c1_1992_ <- fitdistrplus::fitdist(data=c_1_1992$DURATION%>% unlist() %>% as.numeric(), "weibull", method="mle", optim.method="Nelder-Mead", weights = round(c_1_1992$WGHT_EPI))

fit_dweibull_c192 <- data.frame(f = dweibull(c_1_1992$DURATION, shape = weibull_c1_1992_$estimate[1], scale = weibull_c1_1992_$estimate[2]), x = c_1_1992$DURATION, type = "weibull")

summary(weibull_c1_1992_)

plot(x= fit_dweibull_c192$x, y=fit_dweibull_c192$f)

#Calculating exponential distribution
exp_c1_1992_ <- fitdistrplus::fitdist(data=c_1_1992$DURATION%>% unlist() %>% as.numeric(), "exp", method="mle", optim.method="Nelder-Mead", weights = round(c_1_1992$WGHT_EPI))

summary(exp_c1_1992_)

fit_dexp_c192 <- data.frame(f = dexp(c_1_1992$DURATION, rate = exp_c1_1992_$estimate[1]), 
                       x = c_1_1992$DURATION, type = "exp")

plot(x = fit_dexp_c192$x, y = fit_dexp_c192$f)

```

Now let's compare these models AIC and BIC to see which fits the walk data best:

```{r}
#comparing these models AIC and BIC to see which fits the walk data best:
broom::glance(MASS::fitdistr(c_1_1992$DURATION%>% unlist() %>% as.numeric(),"gamma"))
broom::glance(MASS::fitdistr(c_1_1992$DURATION%>% unlist() %>% as.numeric(),"weibull"))
broom::glance(MASS::fitdistr(c_1_1992$DURATION%>% unlist() %>% as.numeric(),"exponential"))
```

So, gamma has largest logLik and the smallest AIC and BIC. we will pick gamma function for cycling trips in 1992!

```{r}
cycling_192_gamma <- gamma_c1_1992_
c_1_1992 <- c_1_1992 %>%
 mutate(f_1 = dgamma(DURATION, cycling_192_gamma$estimate["shape"], cycling_192_gamma$estimate["rate"])) 
summary(c_1_1992$f_1)
```

### Destination : Cycling -Workplace (2), 1992

using a skew vs. kurtois graph to descriptive statistics of data

```{r creating Cullen and Frey graph for cycling 1992}
# creating a skew vs. kurtois graph for cycling 1992

# Filter the data based on the "destination" column
c_2_1992 <- cycling_1992 %>%
  filter(destination == "2")   
descdist(c_2_1992$DURATION %>% unlist() %>% as.numeric(), discrete=FALSE, boot=500)
```

As shown in the Cullen and Frey graph, we see that gamma,normal and exponential will likely be the best fit according to the graph above. Then we compare these models to find the best model.

```{r}
# Based on the skew vs. kurtois graph the best distribution

#Calculating gamma distribution 
gamma_c2_1992_ <- fitdistrplus::fitdist(data=c_2_1992$DURATION%>% unlist() %>% as.numeric(), "gamma", method="mle", optim.method="Nelder-Mead", weights = round(c_2_1992$WGHT_EPI))

fit_dgamma_c292 <- data.frame(f = dgamma(c_2_1992$DURATION, shape = gamma_c2_1992_$estimate[1], rate = gamma_c2_1992_$estimate[2]), x = c_2_1992$DURATION, type = "Gamma")

summary(gamma_c2_1992_)

plot(x= fit_dgamma_c292$x, y=fit_dgamma_c292$f)


#Calculating normal distribution
 
norm_c2_1992_ <- fitdistrplus::fitdist(data=c_2_1992$DURATION%>% unlist() %>% as.numeric(), "norm", method="mle", optim.method="Nelder-Mead", weights = round(c_2_1992$WGHT_EPI))

fit_dnorm_c292 <- data.frame(f = dnorm(c_2_1992$DURATION, mean = norm_c2_1992_$estimate[1], sd = norm_c2_1992_$estimate[2]), x = c_2_1992$DURATION, type = "norm")

summary(norm_c2_1992_)

plot(x= fit_dnorm_c292$x, y=fit_dnorm_c292$f)

#Calculating exponential distribution
exp_c2_1992_ <- fitdistrplus::fitdist(data=c_2_1992$DURATION%>% unlist() %>% as.numeric(), "exp", method="mle", optim.method="Nelder-Mead", weights = round(c_2_1992$WGHT_EPI))

summary(exp_c2_1992_)

fit_dexp_c292 <- data.frame(f = dexp(c_2_1992$DURATION, rate = exp_c2_1992_$estimate[1]), 
                       x = c_2_1992$DURATION, type = "exp")

plot(x = fit_dexp_c292$x, y = fit_dexp_c292$f)

```

Now let's compare these models AIC and BIC to see which fits the walk data best:

```{r}
#comparing these models AIC and BIC to see which fits the walk data best:
broom::glance(MASS::fitdistr(c_2_1992$DURATION%>% unlist() %>% as.numeric(),"gamma"))
broom::glance(MASS::fitdistr(c_2_1992$DURATION%>% unlist() %>% as.numeric(),"normal"))
broom::glance(MASS::fitdistr(c_2_1992$DURATION%>% unlist() %>% as.numeric(),"exponential"))
```

So, gamma has largest logLik and the smallest AIC and BIC. we will pick gamma function for walking trips in 1992!

```{r}
cycling_292_gamma <- gamma_c2_1992_
c_2_1992 <- c_2_1992 %>%
 mutate(f_2 = dgamma(DURATION, cycling_292_gamma$estimate["shape"], cycling_292_gamma$estimate["rate"])) 
summary(c_2_1992$f_2)
```

### Destination : Cycling -Other's Home (3), 1992

using a skew vs. kurtois graph to descriptive statistics of data

```{r creating Cullen and Frey graph for cycling 1992}
# creating a skew vs. kurtois graph for cycling 1992

# Filter the data based on the "destination" column
 c_3_1992 <- cycling_1992 %>%
  filter(destination == "3")   
descdist(c_3_1992$DURATION %>% unlist() %>% as.numeric(), discrete=FALSE, boot=500)
```

As shown in the Cullen and Frey graph, we see that gamma, poisson and exponential will likely be the best fit according to the graph above. Then we compare these models to find the best model.

```{r}
# Based on the skew vs. kurtois graph the best distribution

#Calculating gamma distribution 
gamma_c3_1992_ <- fitdistrplus::fitdist(data=c_3_1992$DURATION%>% unlist() %>% as.numeric(), "gamma", method="mle", optim.method="Nelder-Mead", weights = round(c_3_1992$WGHT_EPI))

fit_dgamma_c392 <- data.frame(f = dgamma(c_3_1992$DURATION, shape = gamma_c3_1992_$estimate[1], rate = gamma_c3_1992_$estimate[2]), x = c_3_1992$DURATION, type = "Gamma")

summary(gamma_c3_1992_)

plot(x= fit_dgamma_c392$x, y=fit_dgamma_c392$f)


#Calculating poisson distribution
 
pois_c3_1992_ <- fitdistrplus::fitdist(data=c_3_1992$DURATION%>% unlist() %>% as.numeric(), "pois", method="mle", optim.method="Nelder-Mead", weights = round(c_3_1992$WGHT_EPI))

fit_dpois_c392 <- data.frame(f = dpois(c_3_1992$DURATION, lambda = pois_c3_1992_$estimate[1]), x = c_3_1992$DURATION, type = "pois")

summary(pois_c3_1992_)

plot(x= fit_dpois_c392$x, y=fit_dpois_c392$f)

#Calculating exponential distribution
exp_c3_1992_ <- fitdistrplus::fitdist(data=c_3_1992$DURATION%>% unlist() %>% as.numeric(), "exp", method="mle", optim.method="Nelder-Mead", weights = round(c_3_1992$WGHT_EPI))

summary(exp_c3_1992_)

fit_dexp_c392 <- data.frame(f = dexp(c_3_1992$DURATION, rate = exp_c3_1992_$estimate[1]), 
                       x = c_3_1992$DURATION, type = "exp")

plot(x = fit_dexp_c392$x, y = fit_dexp_c392$f)

```

Now let's compare these models AIC and BIC to see which fits the walk data best:

```{r}
#comparing these models AIC and BIC to see which fits the walk data best:
broom::glance(MASS::fitdistr(c_3_1992$DURATION%>% unlist() %>% as.numeric(),"gamma"))
broom::glance(MASS::fitdistr(c_3_1992$DURATION%>% unlist() %>% as.numeric(),"poisson"))
broom::glance(MASS::fitdistr(c_3_1992$DURATION%>% unlist() %>% as.numeric(),"exponential"))
```

So, gamma has largest logLik and the smallest AIC and BIC. we will pick gamma function for walking trips in 1992!

```{r}
cycling_392_gamma <- gamma_c3_1992_
c_3_1992 <- c_3_1992 %>%
 mutate(f_3 = dgamma(DURATION, cycling_392_gamma$estimate["shape"], cycling_392_gamma$estimate["rate"])) 
summary(c_3_1992$f_3)
```





# Descriptive analysis

```{r, include=FALSE,  cache=FALSE}
# creating an integrated data frame from 1992 to 2015
trip <- rbind(walking_2015, cycling_2015,walking_2010, cycling_2010, walking_2005, cycling_2005, cycling_1998, walking_1992, cycling_1992, walking_1986)
```

4.1 Walking and cycling duration

Table 1. shows home is the most destination for walking trips.

```{r}
Table_1 <- trip %>% filter(MODE == "walking") %>% 
  group_by(dest, YEAR) %>%
 summarise(across(.cols = c(DURATION),  # columns
                   .fns =  list("mean" = mean, "Maximum" = max, "Median" = median),                               # 
                   na.rm=T))  
  walking_2015 %>%  count(dest) %>%
  mutate(percent = scales::percent(n / sum(n)))
  
   walking_2005 %>%  count(dest) %>%
  mutate(percent = scales::percent(n / sum(n)))
   
   # walking_1998 %>%  count(dest) %>%
  #mutate(percent = scales::percent(n / sum(n)))
     
    walking_1992 %>%  count(dest) %>%
  mutate(percent = scales::percent(n / sum(n)))
  
  kable(Table_1) %>%
  kable_styling(latex_options = c("scale_down")) 
#kbl(caption = "Summary statistics on walking trips in 2015") %>% kable_classic(full_width = F, html_font = "Cambria") %>%  add_header_above(c(" " = 1, "Duration" = 3)) 
```

Table 2. shows home is the most destination for cycling trips.

```{r}
Table_1 <- trip %>% 
  group_by(dest, YEAR) %>%
 summarise(across(.cols = c(DURATION),  # columns
                   .fns =  list("mean" = mean, "Maximum" = max, "Median" = median),                               # 
                   na.rm=T))  
  cycling_2015 %>%  count(dest) %>%
  mutate(percent = scales::percent(n / sum(n)))
  cycling_2005 %>%  count(dest) %>%
  mutate(percent = scales::percent(n / sum(n)))
  cycling_1998 %>%  count(dest) %>%
  mutate(percent = scales::percent(n / sum(n)))
  cycling_1992 %>%  count(dest) %>%
  mutate(percent = scales::percent(n / sum(n)))
  
  kable(Table_1) %>%
  kable_styling(latex_options = c("scale_down")) 
#  kbl(caption = "Summary statistics on walking trips in 2015") %>% kable_classic(full_width = F, html_font = "Cambria") %>%  add_header_above(c(" " = 1, "Duration" = 3)) 
```

```{r}
library(openxlsx)

# Export the data frame to an Excel file
write.xlsx(trip, file = "trip.xlsx", sheetName = "Sheet1")
write.xlsx(trip, file = "D:/Academic-and-Research/PhD-Research/Mobilizing-Justice/Active-Travel-Impedance-Functions/trip.xlsx", sheetName = "Sheet1")
```

percentage of walking trip during 1986- 2015 :

```{r}
crosstab <- xtabs(~ origin + destination, data = walking_2015)
round(100 * prop.table(crosstab, 1), 2)

crosstab <- xtabs(~ origin + destination, data = walking_2010)
round(100 * prop.table(crosstab, 1), 2)

crosstab <- xtabs(~ orig + dest, data = walking_2005)
round(100 * prop.table(crosstab, 1), 2)

crosstab <- xtabs(~ orig + dest, data = walking_1998)
round(100 * prop.table(crosstab, 1), 2)

crosstab <- xtabs(~ orig + dest, data = walking_1992)
round(100 * prop.table(crosstab, 1), 2)

crosstab <- xtabs(~ orig + dest, data = walking_1986)
round(100 * prop.table(crosstab, 1), 2)
```

percentage of cycling trip during 1992- 2015 :

```{r}
crosstab <- xtabs(~ origin + destination, data = cycling_2015)
round(100 * prop.table(crosstab, 1), 2)

crosstab <- xtabs(~ origin + destination, data = cycling_2010)
round(100 * prop.table(crosstab, 1), 2)

crosstab <- xtabs(~ orig + dest, data = cycling_2005)
round(100 * prop.table(crosstab, 1), 2)

crosstab <- xtabs(~ orig + dest, data = cycling_1998)
round(100 * prop.table(crosstab, 1), 2)

crosstab <- xtabs(~ orig + dest, data = cycling_1992)
round(100 * prop.table(crosstab, 1), 2)

```

# IMPEDANCE

```{r}
# plotting histograms
trip_w <- trip %>%  filter(MODE == "walking")
ggplot(trip_w, aes(x = DURATION)) + geom_histogram() + facet_grid(.~YEAR)


# plotting weighted histograms
trip_w <- trip %>%  filter(MODE == "walking")
ggplot(trip_w, aes(x = DURATION, weight = WGHT_EPI)) + geom_histogram() 

#hist(trip$DURATION %>% unlist() %>% as.numeric(), breaks=100) 
# a skew vs. kurtois graph
#descdist(walking_2015$DURATION %>% unlist() %>% as.numeric(), discrete=FALSE, boot=500)
#descdist(walking_2010$DURATION %>% unlist() %>% as.numeric(), discrete=FALSE, boot=500)
#descdist(walking_2005$DURATION %>% unlist() %>% as.numeric(), discrete=FALSE, boot=500)
#descdist(walking_1998$DURATION %>% unlist() %>% as.numeric(), discrete=FALSE, boot=500)
#descdist(walking_1992$DURATION %>% unlist() %>% as.numeric(), discrete=FALSE, boot=500)
#descdist(walking_1986$DURATION %>% unlist() %>% as.numeric(), discrete=FALSE, boot=500)
```

```{r}
# Assuming you have a table named 'your_table' and the column you want to modify is named 'your_column'
walking_2010$DURATION[walking_2010$DURATION == 0] <- 1
walking_2010$WGHT_EPI[walking_2010$WGHT_EPI == 0] <- 1
walking_2005$DURATION[walking_2005$DURATION == 0] <- 1
walking_2005$WGHT_EPI[walking_2005$WGHT_EPI == 0] <- 1
walking_1992$WGHT_EPI[is.na(walking_1992$WGHT_EPI)] <- 1
walking_1992$DURATION[walking_1992$DURATION == 0] <- 1

```


```{r}
library(openxlsx)
writexl::write_xlsx(walking_2015, "D:/Academic-and-Research/PhD-Research/Mobilizing-Justice/Active-Travel-Impedance-Functions/walking_2015.xlsx")

writexl::write_xlsx(walking_2010, "D:/Academic-and-Research/PhD-Research/Mobilizing-Justice/Active-Travel-Impedance-Functions/walking_2010.xlsx")

writexl::write_xlsx(walking_2005, "D:/Academic-and-Research/PhD-Research/Mobilizing-Justice/Active-Travel-Impedance-Functions/walking_2005.xlsx")

writexl::write_xlsx(walking_1998, "D:/Academic-and-Research/PhD-Research/Mobilizing-Justice/Active-Travel-Impedance-Functions/walking_1998.xlsx")

writexl::write_xlsx(walking_1992, "D:/Academic-and-Research/PhD-Research/Mobilizing-Justice/Active-Travel-Impedance-Functions/walking_1992.xlsx")

writexl::write_xlsx(walking_1986, "D:/Academic-and-Research/PhD-Research/Mobilizing-Justice/Active-Travel-Impedance-Functions/walking_1986.xlsx")

```

```{r}
# creating an integrated data frame from 1992 to 2015
trip_w_f <- rbind(walking_2015, walking_2005, walking_1998, walking_1992 , walking_1986)
```

\*\* Impedance function for different destination \*\*

```{r}
ggplot() + geom_line(data = trip_w_f, aes(x = DURATION, y = f), linetype="dashed") + facet_grid(dest~YEAR) 
```



\*\* Impedance function for different destination \*\*

```{r}
trip_c_f <- trip_c_f %>%  filter(MODE == "cycling")
ggplot() + geom_line(data = trip_c_f, aes(x = DURATION, y = f), linetype="dashed") + facet_grid(dest~YEAR) 
```


```{r}
Table_1 <- walking_2015_1  %>% 
 summarise(across(.cols = c(DURATION),  # columns
                   .fns =  list("mean" = mean, "Maximum" = max, "Median" = median),                               # 
                   na.rm=T)) 
Table_2 <- walking_2005  %>% 
 summarise(across(.cols = c(DURATION),  # columns
                   .fns =  list("mean" = mean, "Maximum" = max, "Median" = median),                               # 
                   na.rm=T))
Table_3 <- walking_1998  %>% 
 summarise(across(.cols = c(DURATION),  # columns
                   .fns =  list("mean" = mean, "Maximum" = max, "Median" = median),                               # 
                   na.rm=T))
Table_4 <- walking_1992  %>% 
 summarise(across(.cols = c(DURATION),  # columns
                   .fns =  list("mean" = mean, "Maximum" = max, "Median" = median),                               # 
                   na.rm=T))
Table_5 <- walking_1986  %>% 
 summarise(across(.cols = c(DURATION),  # columns
                   .fns =  list("mean" = mean, "Maximum" = max, "Median" = median),                               # 
                   na.rm=T))
kable(Table_1) %>%
  kable_styling(latex_options = c("scale_down")) 
kable(Table_2) %>%
  kable_styling(latex_options = c("scale_down")) 
kable(Table_3) %>%
  kable_styling(latex_options = c("scale_down")) 
kable(Table_4) %>%
  kable_styling(latex_options = c("scale_down")) 
kable(Table_5) %>%
  kable_styling(latex_options = c("scale_down"))



```

```{r}
Table_1 <- cycling_2015 %>% 
 summarise(across(.cols = c(DURATION),  # columns
                   .fns =  list("mean" = mean, "Maximum" = max, "Median" = median),                               # 
                   na.rm=T)) 
Table_2 <- cycling_2005  %>% 
 summarise(across(.cols = c(DURATION),  # columns
                   .fns =  list("mean" = mean, "Maximum" = max, "Median" = median),                               # 
                   na.rm=T))
Table_3 <- cycling_1998  %>% 
 summarise(across(.cols = c(DURATION),  # columns
                   .fns =  list("mean" = mean, "Maximum" = max, "Median" = median),                               # 
                   na.rm=T))
Table_4 <- cycling_1992  %>% 
 summarise(across(.cols = c(DURATION),  # columns
                   .fns =  list("mean" = mean, "Maximum" = max, "Median" = median),                               # 
                   na.rm=T))

kable(Table_1) %>%
  kable_styling(latex_options = c("scale_down")) 
kable(Table_2) %>%
  kable_styling(latex_options = c("scale_down")) 
kable(Table_3) %>%
  kable_styling(latex_options = c("scale_down")) 
kable(Table_4) %>%
  kable_styling(latex_options = c("scale_down")) 




```




```{r}
F_2015 <- bind_rows(w_300_2015, w_301_2015, w_302_2015, w_303_2015, w_305_2015, w_306_2015, w_307_2015, w_309_2015, w_310_2015)

F_2015 <- F_2015 %>%
  select(A, B, C, D, E, F, G) %>%  # Select the desired columns
  rowwise() %>%
  mutate(New_Column = sum(c_across(everything()), na.rm = TRUE))
```















